<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Calibrate a physical model - Raw Pixels to Products</title><meta property="og:title" content="Calibrate a physical model - Raw Pixels to Products"/><meta name="generator" content="mystmd"/><meta name="keywords" content=""/><meta name="image" content="/landsatproduct-cookbook/build/thumbnail-1c010466148cdb9282b43e9e92cbe804.png"/><meta property="og:image" content="/landsatproduct-cookbook/build/thumbnail-1c010466148cdb9282b43e9e92cbe804.png"/><link rel="stylesheet" href="/landsatproduct-cookbook/build/_assets/app-5WKS5EPQ.css"/><link rel="stylesheet" href="/landsatproduct-cookbook/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-T52X8HNYE8"></script><script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-T52X8HNYE8');</script><link rel="icon" href="/landsatproduct-cookbook/favicon.ico"/><link rel="stylesheet" href="/landsatproduct-cookbook/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="https://projectpythia.org"><div class="p-1 mr-3"><img src="/landsatproduct-cookbook/build/config-item-24692dda-1ab6ef61d2e100b8f4e2bf64d9ca294d.svg" class="h-9 dark:hidden" height="2.25rem"/><img src="/landsatproduct-cookbook/build/config-item-84d6d338-fe46c401a60bf3fdccd52376ddb0b86e.svg" class="hidden h-9 dark:block" height="2.25rem"/></div><span class="text-md sm:text-xl tracking-tight sm:mr-5 sr-only">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"><div class="relative inline-block mx-2 grow-0"><a href="https://projectpythia.org" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75">Home</a></div><div class="relative inline-block mx-2 grow-0"><a href="https://foundations.projectpythia.org" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75">Foundations</a></div><div class="relative inline-block mx-2 grow-0"><a href="https://cookbooks.projectpythia.org/" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75">Cookbooks</a></div><div class="relative inline-block mx-2 grow-0"><a href="https://projectpythia.org/resource-gallery/" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75">Resources</a></div><div class="relative inline-block mx-2 grow-0"><a href="https://projectpythia.org/#join-us" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75">Community</a></div></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R74op:" data-state="closed" class="flex items-center h-10 aspect-square sm:w-64 text-left text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="hidden sm:block grow">Search</span><div aria-hidden="true" class="items-center hidden mx-1 font-mono text-sm text-gray-400 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">âŒ˜</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"><div class="relative" data-headlessui-state=""><div><button class="flex text-sm bg-transparent rounded-full focus:outline-none" id="headlessui-menu-button-:Rr4op:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Open Menu</span><div class="flex items-center text-stone-200 hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="p-1"><path fill-rule="evenodd" d="M10.5 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Zm0 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Zm0 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z" clip-rule="evenodd"></path></svg></div></button></div></div></div><div class="hidden sm:block"><a href="https://projectpythia.org" target="_blank" rel="noopener noreferrer" class="inline-block px-4 py-2 mx-1 mt-0 leading-none border rounded text-md border-stone-700 dark:border-white text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 hover:bg-neutral-100">Project Pythia</a></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"><a href="https://projectpythia.org" target="_blank" rel="noopener noreferrer" class="p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded">Home</a><a href="https://foundations.projectpythia.org" target="_blank" rel="noopener noreferrer" class="p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded">Foundations</a><a href="https://cookbooks.projectpythia.org/" target="_blank" rel="noopener noreferrer" class="p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded">Cookbooks</a><a href="https://projectpythia.org/resource-gallery/" target="_blank" rel="noopener noreferrer" class="p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded">Resources</a><a href="https://projectpythia.org/#join-us" target="_blank" rel="noopener noreferrer" class="p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded">Community</a></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white"><a title="Raw Pixels to Products" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/landsatproduct-cookbook/">Raw Pixels to Products</a><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Preamble" class="block break-words rounded py-2 grow cursor-pointer">Preamble</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rmp8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rmp8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><a title="Calibrate a physical model" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/landsatproduct-cookbook/notebooks/calibration-note">Calibrate a physical model</a><a title="Validation" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/landsatproduct-cookbook/notebooks/validation">Validation</a></div></nav></div><div class="flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><article class="article content article-grid grid-gap"><main class="article-grid subgrid-gap col-screen"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="mb-8 pt-9"><div class="flex items-center h-6 mb-5 text-sm font-light"><div class="flex-grow"></div><a href="https://opensource.org/licenses/Apache-2.0" target="_blank" rel="noopener noreferrer" title="Content License: Apache License 2.0 (Apache-2.0)" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="mx-1 inline-block opacity-60 hover:opacity-100 hover:text-[#599F46]"><path d="M13.2 15.6c1.4-.5 2.1-1.6 2.1-3.3S13.8 8.9 12 8.9c-1.9 0-3.3 1.6-3.3 3.3 0 1.8.8 3 2.2 3.4l-2.3 5.9c-3.1-.8-6.3-4.6-6.3-9.3 0-5.5 4.3-10 9.7-10s9.8 4.5 9.8 10c0 4.7-3.1 8.5-6.3 9.3l-2.3-5.9z"></path></svg></a><a href="https://en.wikipedia.org/wiki/Open_access" target="_blank" rel="noopener noreferrer" title="Open Access" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="mr-1 inline-block opacity-60 hover:opacity-100 hover:text-[#E18435]"><path d="M17.1 12.6h-2V7.5c0-1.7-1.4-3.1-3-3.1-.8 0-1.6.3-2.2.9-.6.5-.9 1.3-.9 2.2v.7H7v-.7c0-1.4.5-2.7 1.5-3.7s2.2-1.5 3.6-1.5 2.6.5 3.6 1.5 1.5 2.3 1.5 3.7v5.1z"></path><path d="M12 21.8c-.8 0-1.6-.2-2.3-.5-.7-.3-1.4-.8-1.9-1.3-.6-.6-1-1.2-1.3-2-.3-.8-.5-1.6-.5-2.4s.2-1.6.5-2.4c.3-.7.7-1.4 1.3-2s1.2-1 1.9-1.3c.7-.3 1.5-.5 2.3-.5.8 0 1.6.2 2.3.5.7.3 1.4.8 1.9 1.3.6.6 1 1.2 1.3 2 .3.8.5 1.6.5 2.4s-.2 1.6-.5 2.4c-.3.7-.7 1.4-1.3 2-.6.6-1.2 1-1.9 1.3-.7.3-1.5.5-2.3.5zm0-10.3c-2.2 0-4 1.8-4 4.1s1.8 4.1 4 4.1 4-1.8 4-4.1-1.8-4.1-4-4.1z"></path><circle cx="12" cy="15.6" r="1.7"></circle></svg></a><a href="https://github.com/projectpythia/landsatproduct-cookbook" title="GitHub Repository: projectpythia/landsatproduct-cookbook" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block"><title>Jupyter Notebook</title><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><a href="https://github.com/projectpythia/landsatproduct-cookbook/blob/main/notebooks/calibration_note.ipynb" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8top:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div><button class="inline-flex size-[24px] hover:text-[#E18435] items-center justify-center" aria-label="Launch in external computing interface" title="Launch in external computing interface" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Re8top:" data-state="closed"><svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.85357 3.85355L7.65355 3.05353C8.2981 2.40901 9.42858 1.96172 10.552 1.80125C11.1056 1.72217 11.6291 1.71725 12.0564 1.78124C12.4987 1.84748 12.7698 1.97696 12.8965 2.10357C13.0231 2.23018 13.1526 2.50125 13.2188 2.94357C13.2828 3.37086 13.2779 3.89439 13.1988 4.44801C13.0383 5.57139 12.591 6.70188 11.9464 7.34645L7.49999 11.7929L6.35354 10.6465C6.15827 10.4512 5.84169 10.4512 5.64643 10.6465C5.45117 10.8417 5.45117 11.1583 5.64643 11.3536L7.14644 12.8536C7.34171 13.0488 7.65829 13.0488 7.85355 12.8536L8.40073 12.3064L9.57124 14.2572C9.65046 14.3893 9.78608 14.4774 9.9389 14.4963C10.0917 14.5151 10.2447 14.4624 10.3535 14.3536L12.3535 12.3536C12.4648 12.2423 12.5172 12.0851 12.495 11.9293L12.0303 8.67679L12.6536 8.05355C13.509 7.19808 14.0117 5.82855 14.1887 4.58943C14.2784 3.9618 14.2891 3.33847 14.2078 2.79546C14.1287 2.26748 13.9519 1.74482 13.6035 1.39645C13.2552 1.04809 12.7325 0.871332 12.2045 0.792264C11.6615 0.710945 11.0382 0.721644 10.4105 0.8113C9.17143 0.988306 7.80189 1.491 6.94644 2.34642L6.32322 2.96968L3.07071 2.50504C2.91492 2.48278 2.75773 2.53517 2.64645 2.64646L0.646451 4.64645C0.537579 4.75533 0.484938 4.90829 0.50375 5.0611C0.522563 5.21391 0.61073 5.34954 0.742757 5.42876L2.69364 6.59928L2.14646 7.14645C2.0527 7.24022 2.00002 7.3674 2.00002 7.50001C2.00002 7.63261 2.0527 7.75979 2.14646 7.85356L3.64647 9.35356C3.84173 9.54883 4.15831 9.54883 4.35357 9.35356C4.54884 9.1583 4.54884 8.84172 4.35357 8.64646L3.20712 7.50001L3.85357 6.85356L6.85357 3.85355ZM10.0993 13.1936L9.12959 11.5775L11.1464 9.56067L11.4697 11.8232L10.0993 13.1936ZM3.42251 5.87041L5.43935 3.85356L3.17678 3.53034L1.80638 4.90074L3.42251 5.87041ZM2.35356 10.3535C2.54882 10.1583 2.54882 9.8417 2.35356 9.64644C2.1583 9.45118 1.84171 9.45118 1.64645 9.64644L0.646451 10.6464C0.451188 10.8417 0.451188 11.1583 0.646451 11.3535C0.841713 11.5488 1.1583 11.5488 1.35356 11.3535L2.35356 10.3535ZM3.85358 11.8536C4.04884 11.6583 4.04885 11.3417 3.85359 11.1465C3.65833 10.9512 3.34175 10.9512 3.14648 11.1465L1.14645 13.1464C0.95119 13.3417 0.951187 13.6583 1.14645 13.8535C1.34171 14.0488 1.65829 14.0488 1.85355 13.8536L3.85358 11.8536ZM5.35356 13.3535C5.54882 13.1583 5.54882 12.8417 5.35356 12.6464C5.1583 12.4512 4.84171 12.4512 4.64645 12.6464L3.64645 13.6464C3.45119 13.8417 3.45119 14.1583 3.64645 14.3535C3.84171 14.5488 4.1583 14.5488 4.35356 14.3535L5.35356 13.3535ZM9.49997 6.74881C10.1897 6.74881 10.7488 6.1897 10.7488 5.5C10.7488 4.8103 10.1897 4.25118 9.49997 4.25118C8.81026 4.25118 8.25115 4.8103 8.25115 5.5C8.25115 6.1897 8.81026 6.74881 9.49997 6.74881Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></button></div><h1 class="mb-0">Calibrate a physical model</h1><header class="mt-4 not-prose"><div class="grid grid-cols-1 sm:grid-cols-2 gap-y-1"><div><span class="font-semibold text-sm"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R2t8top:" data-state="closed">Jianwen Du</button></span></div><div class="text-sm"><div>University of Arizona<!-- --> </div></div></div></header><div class="flex mt-2 text-sm font-light"><time dateTime="2025-08-07" class="">August 7, 2025</time></div></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div class="sticky top-[60px] pb-[14px] flex justify-end w-full z-20 pointer-events-none"><div class="flex p-1 m-1 space-x-1 border rounded-full shadow pointer-events-auto border-stone-300 bg-white/80 dark:bg-stone-900/80 backdrop-blur"><div class="rounded"><button class="flex text-center rounded-full cursor-pointer text-stone-800 dark:text-white hover:opacity-100 opacity-60" aria-label="start compute environment"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="inline-block w-6 h-6 align-top"><title>Launch kernel</title><path stroke-linecap="round" stroke-linejoin="round" d="M5.636 5.636a9 9 0 1 0 12.728 0M12 3v9"></path></svg></button></div></div></div><div id="skip-to-article"></div><div id="fFNDfAq8dQ" class="relative group/block"><h3 id="id-why-calibrate" class="relative group"><span class="heading-text">ğŸ¤” Why Calibrate?</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-why-calibrate" title="Link to this Section" aria-label="Link to this Section">Â¶</a></h3></div><div id="MDpELvM30G" class="relative group/block"><p>Calibration of a physical model is the process of tuning its parameters to ensure its outputs accurately match real-world measurements. Itâ€™s about bridging the gap between theoretical calculations and physical reality.</p><div class="" style="background-color:#E3F2FD;border-left:5px solid #2196F3;padding:15px;font-family:sans-serif"><strong>Key Goal:</strong> The primary goal is to improve predictive accuracy, transforming a model from a theoretical construct into a reliable tool for analysis and design.</div></div><div id="feDmcOFRRD" class="relative group/block"><h3 id="id-what-do-you-need" class="relative group"><span class="heading-text">ğŸ“ What Do You Need?</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-what-do-you-need" title="Link to this Section" aria-label="Link to this Section">Â¶</a></h3></div><div id="n0irz6jvDh" class="relative group/block"><p>To calibrate a model, you need four key components:</p><div class="" style="display:flex;flex-wrap:wrap;gap:10px;font-family:sans-serif"><div class="" style="flex:1;min-width:200px;border:1px solid #ccc;border-radius:5px;padding:10px;background:#fafafa"><strong>1. A Physical Model</strong><br/>A set of mathematical equations or simulation software.</div><div class="" style="flex:1;min-width:200px;border:1px solid #ccc;border-radius:5px;padding:10px;background:#fafafa"><strong>2. Tunable Parameters</strong><br/>The specific &quot;knobs&quot; in your model that you can adjust.</div><div class="" style="flex:1;min-width:200px;border:1px solid #ccc;border-radius:5px;padding:10px;background:#fafafa"><strong>3. Experimental Data</strong><br/>High-quality measurements from the real-world system.</div><div class="" style="flex:1;min-width:200px;border:1px solid #ccc;border-radius:5px;padding:10px;background:#fafafa"><strong>4. An Objective Function</strong><br/>A metric that quantifies the error (e.g., RMSE).</div></div></div><div id="obvhyvEyHv" class="relative group/block"><h3 id="id-how-to-calibrate" class="relative group"><span class="heading-text">âš™ï¸ How to Calibrate?</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-how-to-calibrate" title="Link to this Section" aria-label="Link to this Section">Â¶</a></h3></div><div id="pxf7UjzkTD" class="relative group/block"><p>There are two main approaches to calibration: by hand (trial and error) or by using a smart computer search (optimization algorithms). Optimization is highly recommended for its efficiency and accuracy.</p><details class="myst-dropdown rounded-md my-5 shadow dark:shadow-2xl dark:shadow-neutral-900 overflow-hidden bg-gray-50 dark:bg-stone-800"><summary class="myst-dropdown-header m-0 text-lg font-medium py-1 min-h-[2em] pl-3 cursor-pointer hover:shadow-[inset_0_0_0px_30px_#00000003] dark:hover:shadow-[inset_0_0_0px_30px_#FFFFFF03] bg-gray-100 dark:bg-slate-900"><span class="myst-dropdown-header-title text-neutral-900 dark:text-white"><span class="block float-right text-sm font-thin text-neutral-700 dark:text-neutral-200"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="myst-dropdown-header-icon inline-block pl-2 mr-2 -translate-y-[1px] details-toggle transition-transform"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></span><strong>Click to see details on different optimization methods</strong></span></summary><div class="myst-dropdown-body px-4 py-1 details-body"><div class="" style="background-color:#E8F5E9;border-left:5px solid #4CAF50;margin-top:10px;padding:15px;font-family:sans-serif"><ul><li><p><strong>Gradient-Based Methods:</strong> Use the error gradient for efficient searching (e.g., Levenberg-Marquardt).</p></li><li><p><strong>Gradient-Free Methods:</strong> Do not require gradients, essential for â€œblack-boxâ€ simulations (e.g., Nelder-Mead).</p></li><li><p><strong>Bayesian Calibration:</strong> Treats parameters as probability distributions to quantify uncertainty.</p></li><li><p><strong>Cross-Calibration:</strong> Calibrates one model against a trusted reference model to ensure consistency.</p></li></ul></div></div></details></div><div id="g9tsCGDpcS" class="relative group/block"><h3 id="id-how-do-you-know-its-calibrated" class="relative group"><span class="heading-text">âœ… How Do You Know Itâ€™s Calibrated?</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-how-do-you-know-its-calibrated" title="Link to this Section" aria-label="Link to this Section">Â¶</a></h3></div><div id="hR8kQhfFnK" class="relative group/block"><p>A successful calibration can be verified by analyzing the errors and by validating the model against new data. A common way to visualize the result is by plotting the modelâ€™s output against the experimental data.</p></div><div id="skiPJQnOFb" class="relative group/block"><h4 id="interactive-example-adjusting-model-parameters" class="relative group"><span class="heading-text">Interactive Example: Adjusting Model Parameters</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#interactive-example-adjusting-model-parameters" title="Link to this Section" aria-label="Link to this Section">Â¶</a></h4><p>To make this concept interactive, you can run the code cell below. It will create the same plot but with sliders that let you manually adjust the modelâ€™s parameters (<code>slope</code> and <code>intercept</code>). Try to move the sliders to make the red line fit the blue dots. This gives you a hands-on feel for the â€œBy Handâ€ calibration process.</p></div><div id="LRpVTewlaQ" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># First, let&#x27;s install ipywidgets for the interactive sliders
!pip install -q ipywidgets

# Import necessary libraries
import numpy as np
import matplotlib.pyplot as plt
from ipywidgets import interact, fixed

# 1. Create the sample &quot;Experimental Data&quot;
np.random.seed(0)
x_data = np.linspace(0, 10, 20)
true_slope = 2.5
true_intercept = 1.5
y_data = true_slope * x_data + true_intercept + np.random.normal(0, 2, size=x_data.shape)

# 2. Define a function to plot the data and our adjustable model
def plot_model(x, y, slope, intercept):
    &quot;&quot;&quot;Plots the experimental data against the model line defined by slope and intercept.&quot;&quot;&quot;
    y_model = slope * x + intercept
    
    plt.figure(figsize=(8, 6))
    plt.plot(x, y, &#x27;o&#x27;, label=&#x27;Experimental Data&#x27;, markersize=8, color=&#x27;royalblue&#x27;)
    plt.plot(x, y_model, &#x27;-&#x27;, label=&#x27;Adjustable Model&#x27;, linewidth=3, color=&#x27;red&#x27;)
    
    # Calculate and display the RMSE as our objective function score
    rmse = np.sqrt(np.mean((y - y_model)**2))
    plt.title(f&#x27;Comparison of Model vs. Data (RMSE: {rmse:.2f})&#x27;, fontsize=16)
    
    plt.xlabel(&#x27;Independent Variable&#x27;, fontsize=12)
    plt.ylabel(&#x27;Dependent Variable&#x27;, fontsize=12)
    plt.ylim(min(y_data)-2, max(y_data)+2)
    plt.legend()
    plt.grid(True, linestyle=&#x27;--&#x27;, alpha=0.6)
    plt.show()

# 3. Create the interactive plot!
# The &#x27;interact&#x27; function automatically creates sliders for the numerical arguments.
interact(plot_model, x=fixed(x_data), y=fixed(y_data), slope=(0.0, 5.0, 0.1), intercept=(-5.0, 5.0, 0.1));</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="OUTOvU_pAYw-hbqjrjGRK" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="AHKjYzHMXo" class="relative group/block"><h2 id="example-landsat-calibration-using-modis-sst" class="relative group"><span class="heading-text">Example: Landsat calibration using MODIS SST</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#example-landsat-calibration-using-modis-sst" title="Link to this Section" aria-label="Link to this Section">Â¶</a></h2><p>Create matchups between Landsat and MODIS SST data near Cosgrove, West Antarctica
to produce a calibration for Landsat SSTs</p></div><div id="t33sk2olYL" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import earthaccess
%pip install seaborn
%pip install pykrige
%pip install xarray==2024.05.0</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="MKUxhMU2XH_l1HNzWF3bd" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system"><code><span>Requirement already satisfied: seaborn in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (0.13.2)
Requirement already satisfied: numpy!=1.24.0,&gt;=1.20 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from seaborn) (2.2.6)
Requirement already satisfied: pandas&gt;=1.2 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from seaborn) (2.3.1)
Requirement already satisfied: matplotlib!=3.6.1,&gt;=3.4 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from seaborn) (3.10.5)
Requirement already satisfied: contourpy&gt;=1.0.1 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from matplotlib!=3.6.1,&gt;=3.4-&gt;seaborn) (1.3.3)
Requirement already satisfied: cycler&gt;=0.10 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from matplotlib!=3.6.1,&gt;=3.4-&gt;seaborn) (0.12.1)
Requirement already satisfied: fonttools&gt;=4.22.0 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from matplotlib!=3.6.1,&gt;=3.4-&gt;seaborn) (4.59.0)
Requirement already satisfied: kiwisolver&gt;=1.3.1 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from matplotlib!=3.6.1,&gt;=3.4-&gt;seaborn) (1.4.8)
Requirement already satisfied: packaging&gt;=20.0 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from matplotlib!=3.6.1,&gt;=3.4-&gt;seaborn) (25.0)
Requirement already satisfied: pillow&gt;=8 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from matplotlib!=3.6.1,&gt;=3.4-&gt;seaborn) (11.3.0)
Requirement already satisfied: pyparsing&gt;=2.3.1 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from matplotlib!=3.6.1,&gt;=3.4-&gt;seaborn) (3.2.3)
Requirement already satisfied: python-dateutil&gt;=2.7 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from matplotlib!=3.6.1,&gt;=3.4-&gt;seaborn) (2.9.0.post0)
Requirement already satisfied: pytz&gt;=2020.1 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from pandas&gt;=1.2-&gt;seaborn) (2025.2)
Requirement already satisfied: tzdata&gt;=2022.7 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from pandas&gt;=1.2-&gt;seaborn) (2025.2)
Requirement already satisfied: six&gt;=1.5 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from python-dateutil&gt;=2.7-&gt;matplotlib!=3.6.1,&gt;=3.4-&gt;seaborn) (1.17.0)
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Note: you may need to restart the kernel to use updated packages.
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Collecting pykrige
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  Downloading pykrige-1.7.2.tar.gz (618 kB)
</span><span>     </span><span style="color:rgb(85, 85, 85)">â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”</span><span> </span><span style="color:rgb(0, 187, 0)">618.7/618.7 kB</span><span> </span><span style="color:rgb(187, 0, 0)">27.0 MB/s</span><span>  </span><span style="color:rgb(187, 187, 0)">0:00:00</span><span>
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  Installing build dependencies ... </span><span>-</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>\</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>|</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>/</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>-</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>\</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>|</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>/</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>-</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>\</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>|</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>/</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>-</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>\</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>done
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  Getting requirements to build wheel ... </span><span>-</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>\</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>|</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>done
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  Preparing metadata (pyproject.toml) ... </span><span>-</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>done
</span><span>Requirement already satisfied: numpy&gt;=1.20.0 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from pykrige) (2.2.6)
Requirement already satisfied: scipy&lt;2,&gt;=1.1.0 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from pykrige) (1.16.0)
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Building wheels for collected packages: pykrige
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>  Building wheel for pykrige (pyproject.toml) ... </span><span>-</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>\</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>|</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>/</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>done
</span><span>  Created wheel for pykrige: filename=pykrige-1.7.2-cp313-cp313-linux_x86_64.whl size=239566 sha256=e16db7faa912fcf985b839394ac92c39dde75ea7bd6314eda165ca35cbe3ae2c
  Stored in directory: /home/runner/.cache/pip/wheels/4e/38/d7/78be390d01bdc3f679ae44634bc4c749f6505db1dae2e3b04e
Successfully built pykrige
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Installing collected packages: pykrige
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Successfully installed pykrige-1.7.2
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Note: you may need to restart the kernel to use updated packages.
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Collecting xarray==2024.05.0
  Downloading xarray-2024.5.0-py3-none-any.whl.metadata (11 kB)
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Requirement already satisfied: numpy&gt;=1.23 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from xarray==2024.05.0) (2.2.6)
Requirement already satisfied: packaging&gt;=23.1 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from xarray==2024.05.0) (25.0)
Requirement already satisfied: pandas&gt;=2.0 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from xarray==2024.05.0) (2.3.1)
Requirement already satisfied: python-dateutil&gt;=2.8.2 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from pandas&gt;=2.0-&gt;xarray==2024.05.0) (2.9.0.post0)
Requirement already satisfied: pytz&gt;=2020.1 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from pandas&gt;=2.0-&gt;xarray==2024.05.0) (2025.2)
Requirement already satisfied: tzdata&gt;=2022.7 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from pandas&gt;=2.0-&gt;xarray==2024.05.0) (2025.2)
Requirement already satisfied: six&gt;=1.5 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from python-dateutil&gt;=2.8.2-&gt;pandas&gt;=2.0-&gt;xarray==2024.05.0) (1.17.0)
Downloading xarray-2024.5.0-py3-none-any.whl (1.2 MB)
</span><span>   </span><span style="color:rgb(85, 85, 85)">â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”</span><span> </span><span style="color:rgb(0, 187, 0)">0.0/1.2 MB</span><span> </span><span style="color:rgb(187, 0, 0)">?</span><span> eta </span><span style="color:rgb(0, 187, 187)">-:--:--</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>   </span><span style="color:rgb(85, 85, 85)">â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”</span><span> </span><span style="color:rgb(0, 187, 0)">1.2/1.2 MB</span><span> </span><span style="color:rgb(187, 0, 0)">48.7 MB/s</span><span>  </span><span style="color:rgb(187, 187, 0)">0:00:00</span><span>
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Installing collected packages: xarray
  Attempting uninstall: xarray
    Found existing installation: xarray 2025.7.1
    Uninstalling xarray-2025.7.1:
      Successfully uninstalled xarray-2025.7.1
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span style="color:rgb(187, 0, 0)">ERROR: pip&#x27;s dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.
virtualizarr 1.2.0 requires xarray&gt;=2024.10.0, but you have xarray 2024.5.0 which is incompatible.
rioxarray 0.19.0 requires xarray&gt;=2024.7.0, but you have xarray 2024.5.0 which is incompatible.</span><span style="color:rgb(187, 0, 0)">
</span><span>Successfully installed xarray-2024.5.0
</span></code></pre></div><div><pre class="text-sm font-thin font-system"><code><span>Note: you may need to restart the kernel to use updated packages.
</span></code></pre></div></div></div><div id="iiYpXgFa0U" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Import libraries and modules
%config InlineBackend.figure_format = &#x27;svg&#x27;
%matplotlib widget

%load_ext autoreload
%autoreload 2

import pandas as pd
import xarray as xr
import geopandas as gpd
from datetime import date, timedelta, datetime
import numpy as np
import matplotlib.pylab as plt
from matplotlib import colors
from matplotlib.pylab import rcParams
from matplotlib.patches import Polygon as Pgon
import cartopy.crs as ccrs
import cartopy

import os
from cycler import cycler
import pyproj
from pyproj import Proj, transform
from sklearn.neighbors import BallTree
import pytz
import pygmt
import gc
import copy
import random
import statsmodels.formula.api as sm
import scipy.stats as stats
from sklearn.linear_model import RANSACRegressor
from sklearn.linear_model import LinearRegression
from shapely.geometry import Point, Polygon
from pathlib import Path
import math
from scipy.odr import Model, RealData, ODR
from tqdm.notebook import trange, tqdm
import seaborn as sns

import earthaccess

# For LST file masking
import pystac_client
import intake
from rasterio.session import AWSSession
import boto3

import SSTutils as stu

import warnings
warnings.filterwarnings(&#x27;ignore&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="473s4rsF6jnNx8hQ6Gavq" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system jupyter-error"><code><span style="color:rgb(187, 0, 0)">---------------------------------------------------------------------------</span><span>
</span><span style="color:rgb(187, 0, 0)">ModuleNotFoundError</span><span>                       Traceback (most recent call last)
</span><span style="color:rgb(0, 187, 187)">Cell</span><span style="color:rgb(0, 187, 187)"> </span><span style="color:rgb(0, 187, 0)">In[3]</span><span style="color:rgb(0, 187, 0)">, line 49</span><span>
</span><span style="color:rgb(0, 187, 0)">     46</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">from</span><span style="color:rgb(undefined, undefined, undefined)"> </span><span style="color:rgb(0, 0, 187);font-weight:bold">rasterio</span><span style="color:rgb(0, 0, 187);font-weight:bold">.</span><span style="color:rgb(0, 0, 187);font-weight:bold">session</span><span style="color:rgb(undefined, undefined, undefined)"> </span><span style="color:rgb(0, 135, 0);font-weight:bold">import</span><span> AWSSession
</span><span style="color:rgb(0, 187, 0)">     47</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">import</span><span style="color:rgb(undefined, undefined, undefined)"> </span><span style="color:rgb(0, 0, 187);font-weight:bold">boto3</span><span>
</span><span style="color:rgb(0, 187, 0)">---&gt; </span><span style="color:rgb(0, 187, 0)">49</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">import</span><span style="color:rgb(undefined, undefined, undefined)"> </span><span style="color:rgb(0, 0, 187);font-weight:bold">SSTutils</span><span style="color:rgb(undefined, undefined, undefined)"> </span><span style="color:rgb(0, 135, 0);font-weight:bold">as</span><span style="color:rgb(undefined, undefined, undefined)"> </span><span style="color:rgb(0, 0, 187);font-weight:bold">stu</span><span>
</span><span style="color:rgb(0, 187, 0)">     51</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">import</span><span style="color:rgb(undefined, undefined, undefined)"> </span><span style="color:rgb(0, 0, 187);font-weight:bold">warnings</span><span>
</span><span style="color:rgb(0, 187, 0)">     52</span><span> warnings.filterwarnings(</span><span style="color:rgb(187, 187, 0)">&#x27;</span><span style="color:rgb(187, 187, 0)">ignore</span><span style="color:rgb(187, 187, 0)">&#x27;</span><span>)

</span><span style="color:rgb(187, 0, 0)">ModuleNotFoundError</span><span>: No module named &#x27;SSTutils&#x27;</span></code></pre></div></div></div><div id="hKqldIGpRn" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">#For color cycling in plots that is color blind friendly...make new ones at &quot;I want hue&quot; tools.medialab.sciences-po.fr/iwanthue
color_cycler = cycler(color=[&quot;#6777cf&quot;,&quot;#adba49&quot;,&quot;#c65ca0&quot;,&quot;#5fa042&quot;,&quot;#683287&quot;,&quot;#72ce7b&quot;,&quot;#c44a48&quot;,&quot;#45c7a9&quot;,&quot;#933c1d&quot;,&quot;#d0803f&quot;,&quot;#ac9239&quot;,&quot;#317c39&quot;])
colorline_cycler = (cycler(color=[&quot;#75a141&quot;,&quot;#6c61b9&quot;,&quot;#bc4d45&quot;,&quot;#c1913d&quot;,&quot;#b85298&quot;,&quot;#4aa8e8&quot;]) +
                 cycler(linestyle=[&#x27;-&#x27;,&#x27;--&#x27;,&#x27;:&#x27;,&#x27;-.&#x27;,&#x27;-&#x27;,&#x27;--&#x27;]))
rcParams[&#x27;axes.prop_cycle&#x27;] = cycler(&#x27;color&#x27;, color_cycler)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ccR2rLBusru4obtRkuZIM" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="OUQVxoOB6r" class="relative group/block"><h3 id="build-landsat-modis-sst-matchups" class="relative group"><span class="heading-text">Build Landsat - MODIS SST matchups</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#build-landsat-modis-sst-matchups" title="Link to this Section" aria-label="Link to this Section">Â¶</a></h3></div><div id="OrgD9xnfZB" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Set paths and important variables and Calibration region bounding box

basepath = Path(&#x27;/home/jovyan/landsatproduct-cookbook&#x27;)
spacing = [990,-990] # 990m sampling of MODIS data so that upsampling is easy and because 30m takes far too long
param = &#x27;sea_surface_temperature&#x27;
size_threshold = 30

location = 0             # 0 and 1 are the Cosgrove and Dotson Polynya calibration areas, respectively
surf_temp = &#x27;SST&#x27;        # &#x27;SST&#x27; and &#x27;LST&#x27; are for the Landsat SST and LST algorithms respectively

# Set location bounds
if location==1:
    pathdir = &#x27;DotsonPolynya&#x27;
    latboundsC = [ -73.9 , -73.5 ] # Dotson polynya
    lonboundsC = [ -113 , -111.5 ]
    dfloc = &#x27;Dotson&#x27;
elif location==0:
    pathdir = &#x27;Cosgrove&#x27;
    latboundsC = [ -73.5 , -73.42 ] # near Cosgrove
    lonboundsC = [ -103.0 , -102.0 ]
    dfloc = &#x27;Cosgrove&#x27;
elif location==2:
    pathdir = &#x27;Burke&#x27;
    latboundsC = [ -73.81 , -73.42 ] # south of Burke
    lonboundsC = [ -104.2 , -103.8 ]
    dfloc = &#x27;Burke&#x27;
if location==3:
    pathdir = &#x27;DotsonIntercomp&#x27;
    latboundsC = [ -74.2 , -74.11 ] # Dotson plume for intercomparison
    lonboundsC = [ -113.5 , -113.17 ]
    dfloc = &#x27;DotsonIntercomp&#x27;

# Coefficients for calibration
# SST
sstcalib_m = 0.76 
sstcalib_b = 0.55 

# LST
lstcalib_m = 0.80
lstcalib_b = 1.00

modmin = -1.9
LSTmin = np.around(modmin/lstcalib_m - lstcalib_b,2) 
SSTmin = np.around(modmin/sstcalib_m - sstcalib_b,2) # should be about -2.0

# Uncertainties used in ODR propagation of error
modis_uncertainty = 0.44  # long wave sst ocean color atbd
sst_uncertainty = 0.3 # USGS Landsat stray light notice
lst_uncertainty = 1.0 # gerace 2020
pix_uncertainty = np.sqrt((1000*1000)/(100*100)) # MODIS 1km x 1km and Landsat 100m x 100m


# For calibrated SST runs
if surf_temp==&#x27;SST&#x27;:
    if location==3:
        sstpath = basepath / f&#x27;Data/SST/Validation/{pathdir}/&#x27;
    else:
        sstpath = basepath / f&#x27;Data/SST/MODcalib/{pathdir}/&#x27;
    tif = &#x27;tif&#x27;
    thresh = SSTmin
    calib_m = sstcalib_m
    calib_b = sstcalib_b
    
# If running for LST comparisons
elif surf_temp==&#x27;LST&#x27;:
    if location==3:
        sstpath = basepath / f&#x27;Data/SST/LST/Calibration/DotsonPolynya/&#x27;
    else:
        sstpath = basepath / f&#x27;Data/SST/LST/Calibration/{pathdir}/&#x27;
    tif = &#x27;TIF&#x27;
    thresh = LSTmin
    calib_m = lstcalib_m
    calib_b = lstcalib_b</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="FLdbJoTzurU19gdWp3Shh" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="IJoNBM1v7W" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Authenticate for accessing NASA data (MODIS)
auth = earthaccess.login(strategy=&quot;interactive&quot;)

# If we are not authenticated
if not auth.authenticated:
    # ask for credentials and persist them in a .netrc file
    auth.login(strategy=&quot;interactive&quot;, persist=True)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="CECnZO82CeoA_WC9vC0pk" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="wsRyTI8j0k" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Convert bounding box to south polar stereo for checking if landsat has any data in bounding box
# Speeds up process a lot
source_crs = &#x27;epsg:4326&#x27; 
target_crs = &#x27;epsg:3031&#x27; # Coordinate system of the file

bbox,checkbox = stu.lsat_reproj(source_crs,target_crs,(lonboundsC[0],latboundsC[0],lonboundsC[1],latboundsC[1]))

# Create polygon for later cropping
polygon = Polygon([(bbox[0][0],bbox[0][1]),(bbox[3][0],bbox[3][1]),(bbox[2][0],bbox[2][1]),(bbox[1][0],bbox[1][1])])

# Create min/max boundaries for trimming image before crop_xarray to cut down on processing times
minx, miny, maxx, maxy = polygon.bounds
polarx = [minx, maxx]
polary = [miny, maxy]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="kLQmBXFbzUseD7ZCzy9vv" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="elRk1XSqDi" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Get Landsat file paths in directory
lsatfiles = os.listdir(sstpath)
lsatfiles = [x for x in lsatfiles if x[-3:] == tif]
lsatfiles.sort()
print (len(lsatfiles))
os.chdir(sstpath)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="lQ9qjpJW0uSTKTbPfqWFS" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="ut8PbmcwWP" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">SSTfails = [
 &#x27;LC08_L1GT_006112_20221024_20221107_02_T2_152257_Cel.tif&#x27;,
 &#x27;LC08_L1GT_006112_20221024_20221107_02_T2_152257_Cel.tif&#x27;,
]
LSTfails = [
 &#x27;LC08_L1GT_007112_20211215_20211223_02_T2_SW_LST.TIF&#x27;,
 &#x27;LC08_L1GT_007112_20220201_20220211_02_T2_SW_LST.TIF&#x27;,
 &#x27;LC08_L1GT_007112_20221202_20221212_02_T2_SW_LST.TIF&#x27;,
 &#x27;LC08_L1GT_007112_20230204_20230209_02_T2_SW_LST.TIF&#x27;,
 &#x27;LC08_L1GT_008113_20221022_20221101_02_T2_SW_LST.TIF&#x27;,
 &#x27;LC08_L1GT_010112_20221020_20221101_02_T2_SW_LST.TIF&#x27;,
 &#x27;LC08_L1GT_010113_20221020_20221101_02_T2_SW_LST.TIF&#x27;,
 &#x27;LC08_L1GT_012112_20221018_20221031_02_T2_SW_LST.TIF&#x27;,
 &#x27;LC08_L1GT_008113_20221022_20221101_02_T2_SW_LST.TIF&#x27;,
 &#x27;LC08_L1GT_010112_20221020_20221101_02_T2_SW_LST.TIF&#x27;,
 &#x27;LC08_L1GT_010113_20220105_20220114_02_T2_SW_LST.TIF&#x27;,
 &#x27;LC08_L1GT_010113_20220121_20220128_02_T2_SW_LST.TIF&#x27;,
 &#x27;LC08_L1GT_010113_20221020_20221101_02_T2_SW_LST.TIF&#x27;,
 &#x27;LC08_L1GT_010113_20221105_20221115_02_T2_SW_LST.TIF&#x27;,
 &#x27;LC08_L1GT_010113_20230108_20230124_02_T2_SW_LST.TIF&#x27;,
 &#x27;LC08_L1GT_010113_20230313_20230321_02_T2_SW_LST.TIF&#x27;,
 &#x27;LC08_L1GT_012112_20221018_20221031_02_T2_SW_LST.TIF&#x27;
]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="7_fAdFqktQEdl0rhJROaI" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="VOpRhh7fI7" class="relative group/block"><h3 id="search-for-desired-landsat-scenes" class="relative group"><span class="heading-text">Search for desired Landsat scenes</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#search-for-desired-landsat-scenes" title="Link to this Section" aria-label="Link to this Section">Â¶</a></h3></div><div id="hD3KPQhYNO" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Authenticate for boto S3 access, etc.
os.environ[&quot;AWS_REQUEST_PAYER&quot;] = &quot;requester&quot;
aws_session = AWSSession(boto3.Session(), requester_pays=True)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="G5Pxy6UmbgAUguwPDgAXm" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="CLT0xEOMnm" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Setup and authenticate 
from dask.distributed import Client
import logging
client = Client(processes=True, n_workers=4, 
                threads_per_worker=1,
                silence_logs=logging.ERROR)
client.run(lambda: os.environ[&quot;AWS_REQUEST_PAYER&quot;] == &quot;requester&quot; )
client</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="72mgl53oOn0nOX2ec1Vr7" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="LU9zclDIP8" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Define the landsat STAC catalog location
url = &#x27;https://landsatlook.usgs.gov/stac-server&#x27;
collection = &#x27;landsat-c2l1&#x27; # Landsat Collection 2, Level 1 - includes L8 and L9</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="MUIk5C0RAupsQB7XSZ85c" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="BrBEUlg5Dk" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">i=0 # We will use the first image as an example
ls_scene = xr.open_dataset(lsatfiles[i],chunks=dict(x=512, y=512),engine=&#x27;rasterio&#x27;)[&#x27;band_data&#x27;].sel(band=1)
ls_scene</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="N5_86gW4hsxoZf40lQGPu" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="pGrz4IYVHD" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">%%time
# ~1 min 32 sec per image
# If number of MODIS images per satellite is much more than 25, its because there is a ULY,LRY issue
os.chdir(&#x27;/home/jovyan/landsatproduct-cookbook/Data/SST/MODcalib/Cosgrove/&#x27;)

lsat_mod = []
for i in tqdm(range(len(lsatfiles)), desc=&quot;Processing&quot;):
    # Check for known repeatedly bad files that will kill the code
    if surf_temp == &#x27;SST&#x27;:    
        if lsatfiles[i] in SSTfails:
            continue
    elif surf_temp == &#x27;LST&#x27;:
        if lsatfiles[i] in LSTfails:
            continue
        
    # Concatenate all landsat files into xarray with a time dimension
    ls_scene = xr.open_dataset(lsatfiles[i],chunks=dict(x=512, y=512),engine=&#x27;rasterio&#x27;)[&#x27;band_data&#x27;].sel(band=1)
    ls_scene = ls_scene.rio.write_crs(&quot;epsg:3031&quot;, inplace=True)
    
    if surf_temp == &#x27;SST&#x27;:
        times = pd.to_datetime(lsatfiles[i][17:25]+lsatfiles[i][41:47], format=&#x27;%Y%m%d%H%M%S&#x27;)
        ls_scene = ls_scene.assign_coords(time=times,ID=lsatfiles[i][:-8])
    elif surf_temp == &#x27;LST&#x27;:
        # Need to mask LST because not done previously
        mask = stu.get_lst_mask(lsatfiles[i])
        ls_scene = ls_scene * mask
        
        times = pd.to_datetime(lsatfiles[i][17:25]+&#x27;120000&#x27;, format=&#x27;%Y%m%d%H%M%S&#x27;)
        ls_scene = ls_scene.assign_coords(time=times,ID=lsatfiles[i][:-4])
        ls_scene = ls_scene - 273.15

    # Subset scene and check that it has the correct dimensions because y order changes sometimes
    ls_scene = stu.subset_img(ls_scene,polarx,polary) # subset so easier to work with
    ls_scene = stu.crop_xarray_dataarray_with_polygon(ls_scene, polygon) # crop data to exact bounding box

    lsID = lsatfiles[i]
    
    # Take mean temp, will skip the modis stage if no Landsat data in the calibration region
    try:
        lsat = np.nanmean(ls_scene)
    except Exception as e:
        lsat = np.nan

    if ~np.isfinite(lsat):
        continue

    # Find coincident MODIS SST scene
    mod_scene, mod_file,time_dif = stu.find_MODIS(lonboundsC,latboundsC,ls_scene)

    try:
        # Acquire and align MODIS data to Landsat
        MODsst_xr = stu.get_sst(ls_scene,mod_scene.sea_surface_temperature,spacing,param)
        # Remove SSTs that are unrealistically cool
        MODsst_xr = MODsst_xr.where(MODsst_xr &gt;= -1.9, np.nan)
        # Crop Landsat image to meet the slightly smaller MODIS image
        ls_scene = stu.subset_img(ls_scene,[MODsst_xr.x.min(),MODsst_xr.x.max()],[MODsst_xr.y.min(),MODsst_xr.y.max()])
        # Only use MODIS data where cropped Landsat data is also available
        MODsst_xr_sub = MODsst_xr.where(ls_scene.notnull(),np.nan)
        # Take mean temp
        modis = np.nanmean(MODsst_xr_sub)
        MOD_num = MODsst_xr_sub.notnull().values.sum()
    except Exception as e:
        modis = np.nan
        MOD_num = 0

    # Take mean using Landsat data only where cropped MODIS data is also available (need to do both)
    try:
        ls_scene_sub = ls_scene.where(MODsst_xr_sub.notnull(),np.nan)
        lsat = np.nanmean(ls_scene_sub)
        ls_num = ls_scene_sub.notnull().values.sum()
    except Exception as e:
        lsat = np.nan
        ls_num = 0 # FIX: Initialize ls_num in case of exception

    # Append file names with SST means from the Cosgrove box
    lsat_mod.append([times,mod_file,modis,MOD_num,lsID,lsat,ls_num,time_dif])
    
    try:
        del ls_scene, mod_scene, MODsst_xr, MODsst_xr_sub
    except:
        pass

    gc.collect()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="F-X5_qpo4BmyEXC2Q5bmP" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="pRJyMXjzRG" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Put data into DataFrame and save    
headers = [&#x27;DateTime&#x27;,&#x27;MODIS_filename&#x27;,&#x27;MODIS_SST&#x27;,&#x27;MODIS_pix&#x27;,&#x27;L8_filename&#x27;,f&#x27;L8_{surf_temp}&#x27;,&#x27;L8_pix&#x27;,&#x27;time_dif&#x27;]
lsat_mod_df = pd.DataFrame(lsat_mod,columns=headers)
out_df = basepath / f&#x27;Data/MODISvLandsat_{surf_temp}_{dfloc}_20250500.csv&#x27;
lsat_mod_df.to_csv(out_df, index=False)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="1GeZDykgB7Hv7GrItXjUt" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="NDqDnliTO6" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">print (out_df)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="vuHEoDCJI1qBJ_hHTAe2G" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="zz05cftUAW" class="relative group/block"><h3 id="calculate-calibration-bias-and-trend" class="relative group"><span class="heading-text">Calculate calibration bias and trend</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#calculate-calibration-bias-and-trend" title="Link to this Section" aria-label="Link to this Section">Â¶</a></h3></div><div id="HKlIMKwHzF" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Read in paired MODIS/Landsat data created above
surf_temp = &#x27;SST&#x27;

if surf_temp==&#x27;LST&#x27;:
    thresh = -3.5 # -3.4 is ok too
    pix_thresh = 1300
elif surf_temp==&#x27;SST&#x27;:
    thresh = -3.1
    pix_thresh = 1300
mod_sst_thresh = -1.9

# For Cosgrove region
if surf_temp==&#x27;LST&#x27;:
    out_df_C = &#x27;/home/jovyan/landsatproduct-cookbook/Data/MODISvLandsat_LST_Cosgrove.csv&#x27;
else:   
    out_df_C = &#x27;/home/jovyan/landsatproduct-cookbook/Data/MODISvLandsat_SST_Cosgrove_lin_scale.csv&#x27; 
lsat_mod_df_C = pd.read_csv(out_df_C)
lsat_mod_df_C[&#x27;Region&#x27;] = &#x27;Cosgrove&#x27;

# For Dotson polynya region
if surf_temp==&#x27;LST&#x27;:
    out_df_D = &#x27;/home/jovyan/landsatproduct-cookbook/Data/MODISvLandsat_LST_Dotson.csv&#x27;
else:
    out_df_D = &#x27;/home/jovyan/landsatproduct-cookbook/Data/MODISvLandsat_SST_Dotson_lin_scale.csv&#x27;  
lsat_mod_df_D = pd.read_csv(out_df_D)
lsat_mod_df_D[&#x27;Region&#x27;] = &#x27;Dotson&#x27;

# For Burke region
if surf_temp==&#x27;LST&#x27;:
    out_df_B = &#x27;/home/jovyan/landsatproduct-cookbook/Data/MODISvLandsat_LST_Burke.csv&#x27;
else:
    out_df_B = &#x27;/home/jovyan/landsatproduct-cookbook/Data/MODISvLandsat_SST_Burke_lin_scale.csv&#x27;
lsat_mod_df_B = pd.read_csv(out_df_B)
lsat_mod_df_B[&#x27;Region&#x27;] = &#x27;Burke&#x27;

# Concatenate data from all regions
lsat_mod_df_n = pd.concat([lsat_mod_df_B,lsat_mod_df_C,lsat_mod_df_D])
print(f&#x27;Original # matchups at Cosgrove: {lsat_mod_df_C.shape[0]}, at Dotson: {lsat_mod_df_D.shape[0]}, at Burke: {lsat_mod_df_B.shape[0]}&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="wslAP81-_fRyr4oT1K2a7" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="xOH2DVO7Dv" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># sum_n = lsat_mod_df_n[lsat_mod_df_n.DateTime.dt.month.isin([9,10,11,12,1,3])]
# shld_n = lsat_mod_df_n[lsat_mod_df_n.DateTime.dt.month.isin([2])]
# sum_c = lsat_mod_df_C[lsat_mod_df_C.DateTime.dt.month.isin([9,10,11,12,1,3])]
# sum_bc = lsat_mod_df_bc[lsat_mod_df_bc.DateTime.dt.month.isin([9,10,11,12,1,3])]
# shld_bc = lsat_mod_df_bc[lsat_mod_df_bc.DateTime.dt.month.isin([2])]
# sum_bd = lsat_mod_df_bd[lsat_mod_df_bd.DateTime.dt.month.isin([9,10,11,12,1,3])]
# shld_bd = lsat_mod_df_bd[lsat_mod_df_bd.DateTime.dt.month.isin([2])]
# sum_cd = lsat_mod_df_cd[lsat_mod_df_cd.DateTime.dt.month.isin([9,10,11,12,1,3])]
# shld_cd = lsat_mod_df_cd[lsat_mod_df_cd.DateTime.dt.month.isin([2])]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="dv3OU7RyL72RHMxSwW10T" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="F0uAzb1Kob" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># # ***check all the february images to see if we need to add a threshold of 2.0C or cut images or if the issue is clouds???
# # shld
# look = lsat_mod_df_n.sort_values(&#x27;L8_filename&#x27;)
# look.head(20)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="L58GfNiGU1mq4Vuu27hGu" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="vi8uaLWaNk" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Orthoganal Regression 
if surf_temp==&#x27;LST&#x27;:
    data0 = lsat_mod_df_n
    landsat_uncertainty = lst_uncertainty
else:
    data0 = lsat_mod_df_n
    landsat_uncertainty = sst_uncertainty

# Original data
x_original = np.array(data0[f&#x27;L8_{surf_temp}&#x27;])
y_original = np.array(data0[&#x27;MODIS_SST&#x27;])

# Assume these are your uncertainty estimates per observation
sy = np.full_like(y_original, modis_uncertainty * pix_uncertainty)  # Adjusted for resolution mismatch
sx = np.full_like(x_original, landsat_uncertainty)

# Define a linear function for the model
def linear_model(p, x):
    return p[0] * x + p[1]

# Create a Model
linear = Model(linear_model)

# Create a RealData object using your DataFrame
data = RealData(x_original, y_original,sx=sx, sy=sy)

# Set up ODR with the model and data
odr = ODR(data, linear, beta0=[1., 0.])

# Run the regression
out = odr.run()

# Use the output
beta = out.beta
beta_err = out.sd_beta

# Print the summary
out.pprint()

# Predicting values using the ODR model
y_pred = linear_model(beta, x_original)

# Get R2
# Calculate Total Sum of Squares (SST)
y_mean = np.mean(y_original)
SST = np.sum((y_original - y_mean)**2)

# Calculate Residual Sum of Squares (SSR)
SSR = np.sum((y_original - y_pred)**2)

# Compute RMSE
rmse = np.sqrt(((y_original - y_pred) ** 2).mean())

# Calculate R^2
R2 = 1 - (SSR / SST)
print(&quot;R^2:&quot;, np.around(R2,2))
print(f&quot;RMSE: {np.around(rmse,2)}&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="xhkmoFNXL0DEZrqzl9Xmx" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="Y64ixGZf8N" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">if surf_temp==&#x27;LST&#x27;:
    # Plot regression
    beta_mdn = [beta[0]-beta_err[0]*1.96,beta[1]-beta_err[1]*1.96]
    beta_mup = [beta[0]+beta_err[0]*1.96,beta[1]-beta_err[1]*1.96]
    beta_bdn = [beta[0]-beta_err[0]*1.96,beta[1]+beta_err[1]*1.96]
    beta_bup = [beta[0]+beta_err[0]*1.96,beta[1]+beta_err[1]*1.96]
    print(f&#x27;At 95% confidence interval: {np.around(beta[0],2)}+/-{np.around(beta_err[0]*1.96,2)}, {np.around(beta[1],2)}+/-{np.around(beta_err[1]*1.96,2)}, n={y_pred.shape[0]}&#x27;)
    xfill = np.array([-4.5,1.5])
    
    fig, ax = plt.subplots(figsize=(8, 3.5))
    ax.tick_params(labelsize=14)
    
    # LST data and regression
    plt.scatter(x_original, y_original, s=12,color=&#x27;mediumslateblue&#x27;)
    plt.plot(x_original, y_pred, color=&#x27;mediumslateblue&#x27;, label=&#x27;LST ODR&#x27;)
    plt.fill_between(xfill, linear_model(beta_bdn, xfill), linear_model(beta_mup, xfill),alpha=0.3, facecolor=&#x27;0.3&#x27;)
    
    # Comparison regressions
    xi = np.arange(-7.0,5.0,1.0)
    plt.plot(xi,xi * sstcalib_m + sstcalib_b,color=&#x27;k&#x27;,linewidth=2,label=&#x27;SST ODR&#x27;)
    plt.plot(xi,xi,color=&#x27;lightcoral&#x27;,linewidth=2, label=&#x27;MODIS 1:1&#x27;)
        
    plt.legend(loc=&#x27;lower right&#x27;,fontsize=14)
    plt.text(-2.7,-0.15,rf&#x27;$\mathbf{{y={np.around(beta[0],2)}x+{np.around(beta[1],2)}\quad r^2={np.around(R2,2)}}}$&#x27;,color=&#x27;mediumslateblue&#x27;, fontweight=&#x27;bold&#x27;,fontsize=14)
    plt.xlim([-3.5,-1.2])
    plt.ylim([-3.05,0.8])
    # else: 
    #     plt.plot(x_original, y_pred, color=&#x27;k&#x27;, label=&#x27;NLSST Orthogonal Distance Regression&#x27;)
    #     plt.legend(loc=&#x27;lower right&#x27;,fontsize=12)
    #     plt.text(-2.6,-0.2,f&#x27;y={np.around(beta[0],2)}x+{np.around(beta[1],2)}   $r^2$={np.around(R2,2)}&#x27;,fontsize=14)
    #     plt.xlim([-3.2,-0.15])
    #     plt.ylim([-2.4,0.9]) 
    plt.xlabel(&#x27;Landsat ST [Â°C]&#x27;,fontsize=16)
    plt.ylabel(&#x27;MODIS SST [Â°C]&#x27;,fontsize=16)
    plt.tight_layout()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="x7TaJL2bfYpZpbZPwpFSw" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="uJBaradNWA" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Orthoganal Regression for SST only
dataframes = [
    (&#x27;Combined&#x27;, lsat_mod_df_n),
    (&#x27;Burke&#x27;, lsat_mod_df_B),
    (&#x27;Cosgrove&#x27;, lsat_mod_df_C),
    (&#x27;Dotson&#x27;, lsat_mod_df_D),
]

if surf_temp==&#x27;LST&#x27;:
    landsat_uncertainty = lst_uncertainty
else:
    landsat_uncertainty = sst_uncertainty

# Dictionary to store the results from each DataFrame
odr_results = {}

# Define a linear function for the model
def linear_model(p, x):
    return p[0] * x + p[1]

# Create a Model object
linear = Model(linear_model)

# Loop over each DataFrame
for df_name, data0 in dataframes:
    print(f&quot;\n=== Processing {df_name} ===&quot;)
    
    # Original data
    x_original = np.array(data0[f&#x27;L8_{surf_temp}&#x27;])
    y_original = np.array(data0[&#x27;MODIS_SST&#x27;])

    # Assume these are your uncertainty estimates per observation
    sy = np.full_like(y_original, modis_uncertainty * pix_uncertainty)  # Adjusted for resolution mismatch
    sx = np.full_like(x_original, landsat_uncertainty)
    
    # Create a RealData object using your DataFrame
    data = RealData(x_original, y_original,sx=sx, sy=sy)
    
    # Set up ODR with the model and data, providing an initial guess
    odr = ODR(data, linear, beta0=[1., 0.])
    
    # Run the regression
    out = odr.run()
    
    # Retrieve best-fit parameters and their std. dev.
    beta = out.beta
    beta_err = out.sd_beta
    
    # Print the summary
    out.pprint()
    
    # Predicting values using the ODR model
    y_pred = linear_model(beta, x_original)
    
    # Get R2
    # Calculate Total Sum of Squares (SST)
    y_mean = np.mean(y_original)
    SST = np.sum((y_original - y_mean)**2)
    
    # Calculate Residual Sum of Squares (SSR)
    SSR = np.sum((y_original - y_pred)**2)
    
    # Calculate R^2
    R2 = 1 - (SSR / SST)

    # Compute RMSE
    rmse = np.sqrt(((y_original - y_pred) ** 2).mean())
    
    # Print R^2
    print(f&quot;{df_name} R^2:&quot;, np.around(R2, 2))
    print(f&quot;RMSE: {np.around(rmse,2)}&quot;)
    
    # Store results in a dictionary for later use (plotting, etc.)
    odr_results[df_name] = {
        &#x27;beta&#x27;: beta,
        &#x27;beta_err&#x27;: beta_err,
        &#x27;R2&#x27;: R2,
        &#x27;x_original&#x27;: x_original,
        &#x27;y_original&#x27;: y_original,
        &#x27;y_pred&#x27;: y_pred
    }</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="AZenFNZs8a9j-pWVMomX3" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="o2zLmqm0uM" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">if surf_temp==&#x27;SST&#x27;:
    # Plot with all points and by region (Burke=r, Cosgrove=b, Dotson=g) - show with lsat_mod_df_n calculations for the line
    beta_mdn = [odr_results[&#x27;Combined&#x27;][&#x27;beta&#x27;][0]-odr_results[&#x27;Combined&#x27;][&#x27;beta_err&#x27;][0]*1.96,odr_results[&#x27;Combined&#x27;][&#x27;beta&#x27;][1]-odr_results[&#x27;Combined&#x27;][&#x27;beta_err&#x27;][1]*1.96]
    beta_mup = [odr_results[&#x27;Combined&#x27;][&#x27;beta&#x27;][0]+odr_results[&#x27;Combined&#x27;][&#x27;beta_err&#x27;][0]*1.96,odr_results[&#x27;Combined&#x27;][&#x27;beta&#x27;][1]-odr_results[&#x27;Combined&#x27;][&#x27;beta_err&#x27;][1]*1.96]
    beta_bdn = [odr_results[&#x27;Combined&#x27;][&#x27;beta&#x27;][0]-odr_results[&#x27;Combined&#x27;][&#x27;beta_err&#x27;][0]*1.96,odr_results[&#x27;Combined&#x27;][&#x27;beta&#x27;][1]+odr_results[&#x27;Combined&#x27;][&#x27;beta_err&#x27;][1]*1.96]
    beta_bup = [odr_results[&#x27;Combined&#x27;][&#x27;beta&#x27;][0]+odr_results[&#x27;Combined&#x27;][&#x27;beta_err&#x27;][0]*1.96,odr_results[&#x27;Combined&#x27;][&#x27;beta&#x27;][1]+odr_results[&#x27;Combined&#x27;][&#x27;beta_err&#x27;][1]*1.96]
    a1 = np.around(odr_results[&#x27;Combined&#x27;][&#x27;beta&#x27;][0],2)
    a1e = np.around(odr_results[&#x27;Combined&#x27;][&#x27;beta_err&#x27;][0]*1.96,2)
    a2 = np.around(odr_results[&#x27;Combined&#x27;][&#x27;beta&#x27;][1],2)
    a2e = np.around(odr_results[&#x27;Combined&#x27;][&#x27;beta_err&#x27;][1]*1.96,2)
    nn = odr_results[&#x27;Combined&#x27;][&#x27;y_pred&#x27;].shape[0]
    ar = np.around(odr_results[&#x27;Combined&#x27;][&#x27;R2&#x27;],2)
    b1 = np.around(odr_results[&#x27;Burke&#x27;][&#x27;beta&#x27;][0],2)
    b2 = np.around(odr_results[&#x27;Burke&#x27;][&#x27;beta&#x27;][1],2)
    br = np.around(odr_results[&#x27;Burke&#x27;][&#x27;R2&#x27;],2)
    c1 = np.around(odr_results[&#x27;Cosgrove&#x27;][&#x27;beta&#x27;][0],2)
    c2 = np.around(odr_results[&#x27;Cosgrove&#x27;][&#x27;beta&#x27;][1],2)
    cr = np.around(odr_results[&#x27;Cosgrove&#x27;][&#x27;R2&#x27;],2)
    d1 = np.around(odr_results[&#x27;Dotson&#x27;][&#x27;beta&#x27;][0],2)
    d2 = np.around(odr_results[&#x27;Dotson&#x27;][&#x27;beta&#x27;][1],2)
    dr = np.around(odr_results[&#x27;Dotson&#x27;][&#x27;R2&#x27;],2)
    print(f&#x27;At 95% confidence interval: {a1}+/-{a1e}, {a2}+/-{a2e}, n={nn}&#x27;)
    xfill = np.array([-4.3,0.9])
    
    
    fig, ax = plt.subplots(figsize=(8, 3))
    ax.tick_params(labelsize=14)
    
    plt.scatter(np.array(lsat_mod_df_B[f&#x27;L8_{surf_temp}&#x27;]), np.array(lsat_mod_df_B[&#x27;MODIS_SST&#x27;]), s=12,color=&#x27;#00bf7d&#x27;, label=&#x27;Burke&#x27;)
    plt.scatter(np.array(lsat_mod_df_C[f&#x27;L8_{surf_temp}&#x27;]), np.array(lsat_mod_df_C[&#x27;MODIS_SST&#x27;]), s=12,color=sns.color_palette(&quot;colorblind&quot;)[3], label=&#x27;Cosgrove&#x27;)
    plt.scatter(np.array(lsat_mod_df_D[f&#x27;L8_{surf_temp}&#x27;]), np.array(lsat_mod_df_D[&#x27;MODIS_SST&#x27;]), s=12,color=&#x27;#0073e6&#x27;, label=&#x27;Dotson&#x27;)
    
    plt.plot(odr_results[&#x27;Combined&#x27;][&#x27;x_original&#x27;], odr_results[&#x27;Combined&#x27;][&#x27;y_pred&#x27;], color=&#x27;k&#x27;)
    plt.fill_between(xfill, linear_model(beta_bdn, xfill), linear_model(beta_mup, xfill),alpha=0.3, facecolor=&#x27;0.3&#x27;)
    plt.plot(odr_results[&#x27;Burke&#x27;][&#x27;x_original&#x27;], odr_results[&#x27;Burke&#x27;][&#x27;y_pred&#x27;], ls=&#x27;-&#x27;,linewidth=1,color=&#x27;#00bf7d&#x27;)
    plt.plot(odr_results[&#x27;Cosgrove&#x27;][&#x27;x_original&#x27;], odr_results[&#x27;Cosgrove&#x27;][&#x27;y_pred&#x27;], ls=&#x27;-&#x27;,linewidth=1,color=sns.color_palette(&quot;colorblind&quot;)[3])
    plt.plot(odr_results[&#x27;Dotson&#x27;][&#x27;x_original&#x27;], odr_results[&#x27;Dotson&#x27;][&#x27;y_pred&#x27;], ls=&#x27;-&#x27;,linewidth=1,color=&#x27;#0073e6&#x27;)
    
    if surf_temp==&#x27;LST&#x27;:
        plt.text(-2.25,-0.2,f&#x27;y={a1}x+{a2}   $r^2$={ar}&#x27;,color=&#x27;#00bf7d&#x27;,fontsize=14)
        plt.text(-2.25,-0.2,f&#x27;y={c1}x+{c2}   $r^2$={cr}&#x27;,color=sns.color_palette(&quot;colorblind&quot;)[3],fontsize=12)
        plt.text(-2.25,-0.2,f&#x27;y={d1}x+{d2}   $r^2$={dr}&#x27;,color=&#x27;#0073e6&#x27;,fontsize=12)
        plt.xlim([-2.5,-1.4])
        plt.ylim([-2.05,0.0])
    else: 
        plt.text(-2.9,0.3,f&#x27;y={a1}x+{a2}   $r^2$={ar}&#x27;,color=&#x27;k&#x27;,fontsize=14)
        plt.text(-2.9,0.0,f&#x27;y={b1}x+{b2}   $r^2$={br}&#x27;,color=&#x27;#00bf7d&#x27;,fontsize=12)
        plt.text(-2.9,-0.3,f&#x27;y={c1}x+{c2}   $r^2$={cr}&#x27;,color=sns.color_palette(&quot;colorblind&quot;)[3],fontsize=12)
        plt.text(-2.9,-0.6,f&#x27;y={d1}x+{d2}   $r^2$={dr}&#x27;,color=&#x27;#0073e6&#x27;,fontsize=12)
        plt.xlim([-3.05,-0.15])
        plt.ylim([-2.3,0.9])
    plt.xlabel(&#x27;Landsat SST [Â°C]&#x27;,fontsize=16)
    plt.ylabel(&#x27;MODIS SST [Â°C]&#x27;,fontsize=16)
    plt.legend(loc=&#x27;lower right&#x27;,fontsize=10)
    plt.tight_layout()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="alKoNBrcB-Hg5uwGgcpuw" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="yC4zOXDgeK" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">odr_results[&#x27;Combined&#x27;][&#x27;beta_err&#x27;]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="7goCtiEvouJ6BVxqyvlzu" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="J4qRQgH10A" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">if surf_temp==&#x27;SST&#x27;:
    # Ordinary least squares regression between Landsat and MODIS SST matchups
    resultC = sm.ols(formula=&quot;MODIS_SST ~ L8_SST&quot;, data=data0).fit()
    print (resultC.summary())</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="BrvK-rU9bBL2JWjoSbKnj" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="qW9QIjwJya" class="relative group/block"><h3 id="interactive-analysis-dashboard-using-plotly" class="relative group"><span class="heading-text">Interactive Analysis Dashboard using Plotly</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#interactive-analysis-dashboard-using-plotly" title="Link to this Section" aria-label="Link to this Section">Â¶</a></h3></div><div id="KBvAQTKlOD" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Imports for Interactive Dashboard
import ipywidgets as widgets
from ipywidgets import interact, Layout
import plotly.express as px
import plotly.graph_objects as go</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="bW_wYEbcL9YHw75_JcbDS" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="SQ0TBtCO36" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Interactive Dashboard Function

def linear_model(p, x):
    return p[0] * x + p[1]

def interactive_calibration_dashboard(region, chart_type, pix_thresh, modis_sst_thresh, lsat_sst_thresh):
    # 1. Filter each dataframe individually based on widget values
    df_C_filt = lsat_mod_df_C[(lsat_mod_df_C[&#x27;MODIS_pix&#x27;] &gt;= pix_thresh) &amp;
                              (lsat_mod_df_C[&#x27;MODIS_SST&#x27;] &gt;= modis_sst_thresh) &amp;
                              (lsat_mod_df_C[f&#x27;L8_{surf_temp}&#x27;] &gt;= lsat_sst_thresh)]
    
    df_D_filt = lsat_mod_df_D[(lsat_mod_df_D[&#x27;MODIS_pix&#x27;] &gt;= pix_thresh) &amp;
                              (lsat_mod_df_D[&#x27;MODIS_SST&#x27;] &gt;= modis_sst_thresh) &amp;
                              (lsat_mod_df_D[f&#x27;L8_{surf_temp}&#x27;] &gt;= lsat_sst_thresh)]

    df_B_filt = lsat_mod_df_B[(lsat_mod_df_B[&#x27;MODIS_pix&#x27;] &gt;= pix_thresh) &amp;
                              (lsat_mod_df_B[&#x27;MODIS_SST&#x27;] &gt;= modis_sst_thresh) &amp;
                              (lsat_mod_df_B[f&#x27;L8_{surf_temp}&#x27;] &gt;= lsat_sst_thresh)]

    # 2. Select data based on dropdown menu
    if region == &#x27;All Regions&#x27;:
        df_filtered = pd.concat([df_B_filt, df_C_filt, df_D_filt])
    elif region == &#x27;Cosgrove&#x27;:
        df_filtered = df_C_filt
    elif region == &#x27;Dotson&#x27;:
        df_filtered = df_D_filt
    elif region == &#x27;Burke&#x27;:
        df_filtered = df_B_filt
    
    if len(df_filtered) &lt; 2:
        # Create an empty plot with a message
        fig = go.Figure()
        fig.update_layout(title_text=&quot;Not enough data with the current filter settings.&quot;, 
                          xaxis={&#x27;visible&#x27;: False}, yaxis={&#x27;visible&#x27;: False})
        fig.show()
        return
    
    # 3. Perform Orthogonal Distance Regression (ODR)
    x_data = df_filtered[f&#x27;L8_{surf_temp}&#x27;].values
    y_data = df_filtered[&#x27;MODIS_SST&#x27;].values
    
    sx = np.full_like(x_data, sst_uncertainty)
    sy = np.full_like(y_data, modis_uncertainty * pix_uncertainty)

    model = Model(linear_model)
    data = RealData(x_data, y_data, sx=sx, sy=sy)
    odr = ODR(data, model, beta0=[1., 0.])
    output = odr.run()
    
    slope, intercept = output.beta
    y_pred = linear_model(output.beta, x_data)
    
    # 4. Calculate statistics including bias and trend
    bias = np.mean(y_data - x_data)
    trend = slope
    ss_total = np.sum((y_data - np.mean(y_data))**2)
    ss_resid = np.sum((y_data - y_pred)**2)
    r2 = 1 - (ss_resid / ss_total) if ss_total &gt; 0 else 0
    rmse = np.sqrt(np.mean((y_data - y_pred)**2))
    stats_text = (f&quot;&lt;b&gt;Trend (Slope):&lt;/b&gt; {trend:.2f} | &lt;b&gt;Bias (MODIS - Landsat):&lt;/b&gt; {bias:.2f}Â°C&lt;br&gt;&quot;
                  f&quot;&lt;b&gt;RÂ²:&lt;/b&gt; {r2:.2f} | &lt;b&gt;RMSE:&lt;/b&gt; {rmse:.2f} | &lt;b&gt;N:&lt;/b&gt; {len(df_filtered)}&quot;)

    # 5. Create Plotly figure based on chart_type
    if chart_type == &#x27;Scatter&#x27;:
        fig = px.scatter(df_filtered, x=f&#x27;L8_{surf_temp}&#x27;, y=&#x27;MODIS_SST&#x27;, 
                         color=&#x27;Region&#x27;, hover_data=[&#x27;L8_filename&#x27;, &#x27;DateTime&#x27;])
    elif chart_type == &#x27;Heatmap&#x27;:
        fig = go.Figure(go.Histogram2d(
            x=df_filtered[f&#x27;L8_{surf_temp}&#x27;],
            y=df_filtered[&#x27;MODIS_SST&#x27;],
            colorscale=&#x27;Viridis&#x27;
        ))
    
    # Add regression line to both plot types
    sorted_indices = np.argsort(x_data)
    fig.add_trace(go.Scatter(x=x_data[sorted_indices], y=y_pred[sorted_indices], 
                           mode=&#x27;lines&#x27;, name=&#x27;ODR Fit&#x27;, line=dict(color=&#x27;black&#x27;, width=2)))

    fig.update_layout(
        title_text=stats_text,
        xaxis_title=&quot;Landsat SST [Â°C]&quot;,
        yaxis_title=&quot;MODIS SST [Â°C]&quot;,
        xaxis_range=[-3.05, -0.15],
        yaxis_range=[-2.3, 0.9],
        legend_title=&quot;Region&quot;
    )
    
    fig.show()

# Define Widgets
style = {&#x27;description_width&#x27;: &#x27;initial&#x27;}
w_region = widgets.Dropdown(options=[&#x27;All Regions&#x27;, &#x27;Cosgrove&#x27;, &#x27;Dotson&#x27;, &#x27;Burke&#x27;], value=&#x27;All Regions&#x27;, description=&#x27;Select Region:&#x27;, style=style)
w_chart_type = widgets.ToggleButtons(options=[&#x27;Scatter&#x27;, &#x27;Heatmap&#x27;], description=&#x27;Chart Type:&#x27;, button_style=&#x27;info&#x27;)
w_pix_thresh = widgets.IntSlider(value=1300, min=0, max=5000, step=100, description=&#x27;Min MODIS Pixels:&#x27;, style=style, layout=Layout(width=&#x27;500px&#x27;))
w_modis_sst = widgets.FloatSlider(value=-1.9, min=-2.5, max=0, step=0.1, description=&#x27;Min MODIS SST (Â°C):&#x27;, style=style, layout=Layout(width=&#x27;500px&#x27;))
w_lsat_sst = widgets.FloatSlider(value=-3.1, min=-4.0, max=0, step=0.1, description=&#x27;Min Landsat SST (Â°C):&#x27;, style=style, layout=Layout(width=&#x27;500px&#x27;))

# Launch the Dashboard
interact(interactive_calibration_dashboard, 
         region=w_region, 
         chart_type=w_chart_type,
         pix_thresh=w_pix_thresh, 
         modis_sst_thresh=w_modis_sst, 
         lsat_sst_thresh=w_lsat_sst);</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="QNN69Z7MIOAsu4Hc3nYkR" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div></div><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/landsatproduct-cookbook/notebooks/how-to-cite"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">Preamble</div>How to Cite This Cookbook</div></div></a><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/landsatproduct-cookbook/notebooks/validation"><div class="flex h-full align-middle"><div class="flex-grow"><div class="text-xs text-gray-500 dark:text-gray-400">Preamble</div>Validation</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"></path></svg></div></a></div></main></article><script>((a,d)=>{if(!window.history.state||!window.history.state.key){let h=Math.random().toString(32).slice(2);window.history.replaceState({key:h},"")}try{let f=JSON.parse(sessionStorage.getItem(a)||"{}")[d||window.history.state.key];typeof f=="number"&&window.scrollTo(0,f)}catch(h){console.error(h),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/landsatproduct-cookbook/build/entry.client-UNPC4GT3.js"/><link rel="modulepreload" href="/landsatproduct-cookbook/build/_shared/chunk-OCTKKCIL.js"/><link rel="modulepreload" href="/landsatproduct-cookbook/build/_shared/chunk-UAI5KRM7.js"/><link rel="modulepreload" href="/landsatproduct-cookbook/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/landsatproduct-cookbook/build/_shared/chunk-JSE36H2O.js"/><link rel="modulepreload" href="/landsatproduct-cookbook/build/_shared/chunk-HBJK6BW3.js"/><link rel="modulepreload" href="/landsatproduct-cookbook/build/_shared/chunk-HYMQ7M2K.js"/><link rel="modulepreload" href="/landsatproduct-cookbook/build/_shared/chunk-OHOXABTA.js"/><link rel="modulepreload" href="/landsatproduct-cookbook/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/landsatproduct-cookbook/build/_shared/chunk-C7FW3E47.js"/><link rel="modulepreload" href="/landsatproduct-cookbook/build/_shared/chunk-3CVK3PYF.js"/><link rel="modulepreload" href="/landsatproduct-cookbook/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/landsatproduct-cookbook/build/_shared/chunk-ND43KHSX.js"/><link rel="modulepreload" href="/landsatproduct-cookbook/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/landsatproduct-cookbook/build/root-IB5726YR.js"/><link rel="modulepreload" href="/landsatproduct-cookbook/build/_shared/chunk-NBON2RSI.js"/><link rel="modulepreload" href="/landsatproduct-cookbook/build/routes/$-LXLHKVOR.js"/><script>window.__remixContext = {"url":"/notebooks/calibration-note","state":{"loaderData":{"root":{"config":{"version":2,"myst":"1.6.0","options":{"favicon":"/landsatproduct-cookbook/build/config-item-9b3afca6-baf513cf925a23746e67061cc05d6d35.ico","logo":"/landsatproduct-cookbook/build/config-item-24692dda-1ab6ef61d2e100b8f4e2bf64d9ca294d.svg","logo_dark":"/landsatproduct-cookbook/build/config-item-84d6d338-fe46c401a60bf3fdccd52376ddb0b86e.svg","logo_url":"https://projectpythia.org","analytics_google":"G-T52X8HNYE8","folders":true},"parts":{},"nav":[{"title":"Home","url":"https://projectpythia.org"},{"title":"Foundations","url":"https://foundations.projectpythia.org"},{"title":"Cookbooks","url":"https://cookbooks.projectpythia.org/"},{"title":"Resources","url":"https://projectpythia.org/resource-gallery/"},{"title":"Community","url":"https://projectpythia.org/#join-us"}],"actions":[{"title":"Project Pythia","url":"https://projectpythia.org","internal":false,"static":false}],"projects":[{"open_access":true,"license":{"content":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"title":"Raw Pixels to Products","authors":[{"nameParsed":{"literal":"Tasha Snow","given":"Tasha","family":"Snow"},"name":"Tasha Snow","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Kathryn Moore","given":"Kathryn","family":"Moore"},"name":"Kathryn Moore","id":"contributors-myst-generated-uid-1"},{"nameParsed":{"literal":"Genevieve Clow","given":"Genevieve","family":"Clow"},"name":"Genevieve Clow","id":"contributors-myst-generated-uid-2"},{"nameParsed":{"literal":"Jianwen Du","given":"Jianwen","family":"Du"},"name":"Jianwen Du","id":"contributors-myst-generated-uid-3"},{"nameParsed":{"literal":"Arman Oliazneeh","given":"Arman","family":"Oliazneeh"},"name":"Arman Oliazneeh","id":"contributors-myst-generated-uid-4"}],"contributors":[{"id":"brian-rose","nameParsed":{"literal":"Brian E. J. Rose","given":"Brian E. J.","family":"Rose"},"name":"Brian E. J. Rose","orcid":"0000-0002-9961-3821","email":"brose@albany.edu","affiliations":["UAlbany"],"url":"https://brian-rose.github.io","github":"brian-rose","bluesky":"@brianejrose.bsky.social","linkedin":"https://www.linkedin.com/in/brian-rose-37bb55106/"},{"id":"clyne","nameParsed":{"literal":"John Clyne","given":"John","family":"Clyne"},"name":"John Clyne","orcid":"0000-0003-2788-9017","affiliations":["CISL"],"github":"clyne"},{"id":"jukent","nameParsed":{"literal":"Julia Kent","given":"Julia","family":"Kent"},"name":"Julia Kent","orcid":"0000-0002-5611-8986","affiliations":["CISL"],"github":"jukent"},{"id":"ktyle","nameParsed":{"literal":"Kevin Tyle","given":"Kevin","family":"Tyle"},"name":"Kevin Tyle","orcid":"0000-0001-5249-9665","affiliations":["UAlbany"],"github":"ktyle"},{"id":"andersy005","nameParsed":{"literal":"Anderson Banihirwe","given":"Anderson","family":"Banihirwe"},"name":"Anderson Banihirwe","orcid":"0000-0001-6583-571X","affiliations":["CarbonPlan"],"github":"andersy005"},{"id":"dcamron","nameParsed":{"literal":"Drew Camron","given":"Drew","family":"Camron"},"name":"Drew Camron","orcid":"0000-0001-7246-6502","affiliations":["Unidata"],"github":"dcamron"},{"id":"dopplershift","nameParsed":{"literal":"Ryan May","given":"Ryan","family":"May"},"name":"Ryan May","orcid":"0000-0003-2907-038X","affiliations":["Unidata"],"github":"dopplershift"},{"id":"mgrover1","nameParsed":{"literal":"Maxwell Grover","given":"Maxwell","family":"Grover"},"name":"Maxwell Grover","orcid":"0000-0002-0370-8974","affiliations":["Argonne"],"github":"mgrover1"},{"id":"r-ford","nameParsed":{"literal":"Robert R. Ford","given":"Robert R.","family":"Ford"},"name":"Robert R. Ford","orcid":"0000-0001-5483-4965","affiliations":["UAlbany"],"github":"r-ford"},{"id":"kmpaul","nameParsed":{"literal":"Kevin Paul","given":"Kevin","family":"Paul"},"name":"Kevin Paul","orcid":"0000-0001-8155-8038","affiliations":["NVIDIA"],"github":"kmpaul"},{"id":"jnmorley","nameParsed":{"literal":"James Morley","given":"James","family":"Morley"},"name":"James Morley","orcid":"0009-0005-5193-7981","github":"jnmorley"},{"id":"erogluorhan","nameParsed":{"literal":"Orhan Eroglu","given":"Orhan","family":"Eroglu"},"name":"Orhan Eroglu","orcid":"0000-0003-3099-8775","affiliations":["CISL"],"github":"erogluorhan"},{"id":"lkailynncar","nameParsed":{"literal":"Lily Kailyn","given":"Lily","family":"Kailyn"},"name":"Lily Kailyn","orcid":"0009-0002-0125-5091","affiliations":["CISL"],"github":"lkailynncar"},{"id":"anissa111","nameParsed":{"literal":"Anissa Zacharias","given":"Anissa","family":"Zacharias"},"name":"Anissa Zacharias","orcid":"0000-0002-2666-8493","affiliations":["CISL"],"github":"anissa111"},{"id":"kafitzgerald","nameParsed":{"literal":"Katelyn FitzGerald","given":"Katelyn","family":"FitzGerald"},"name":"Katelyn FitzGerald","orcid":"0000-0003-4184-1917","affiliations":["CISL"],"github":"kafitzgerald"}],"github":"https://github.com/projectpythia/landsatproduct-cookbook","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"copyright":"2025","references":{"foundations":{"url":"https://foundations.projectpythia.org"},"xarray":{"url":"https://docs.xarray.dev/en/stable"},"matplotlib":{"url":"https://matplotlib.org/stable"}},"thebe":{"binder":{"url":"https://mybinder.org/","provider":"github","repo":"projectpythia/cookbook-template","ref":"HEAD"}},"toc":[{"file":"README.md"},{"children":[{"file":"notebooks/how-to-cite.md"}],"title":"Preamble"},{"file":"notebooks/calibration_note.ipynb"},{"file":"notebooks/validation.ipynb"}],"thumbnail":"/landsatproduct-cookbook/build/thumbnail-1c010466148cdb9282b43e9e92cbe804.png","exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"Preamble"},{"slug":"notebooks.how-to-cite","title":"How to Cite This Cookbook","description":"","date":"","thumbnail":"/landsatproduct-cookbook/build/72a08caa5cbe5f9cce5999dbd1a81dfd.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.calibration-note","title":"Calibrate a physical model","description":"","date":"2025-08-07","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"notebooks.validation","title":"Validation","description":"","date":"","thumbnail":"/landsatproduct-cookbook/build/7f5ce2075ca8bde52118602eb0344051.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/landsatproduct-cookbook"},"routes/$":{"config":{"version":2,"myst":"1.6.0","options":{"favicon":"/landsatproduct-cookbook/build/config-item-9b3afca6-baf513cf925a23746e67061cc05d6d35.ico","logo":"/landsatproduct-cookbook/build/config-item-24692dda-1ab6ef61d2e100b8f4e2bf64d9ca294d.svg","logo_dark":"/landsatproduct-cookbook/build/config-item-84d6d338-fe46c401a60bf3fdccd52376ddb0b86e.svg","logo_url":"https://projectpythia.org","analytics_google":"G-T52X8HNYE8","folders":true},"parts":{},"nav":[{"title":"Home","url":"https://projectpythia.org"},{"title":"Foundations","url":"https://foundations.projectpythia.org"},{"title":"Cookbooks","url":"https://cookbooks.projectpythia.org/"},{"title":"Resources","url":"https://projectpythia.org/resource-gallery/"},{"title":"Community","url":"https://projectpythia.org/#join-us"}],"actions":[{"title":"Project Pythia","url":"https://projectpythia.org","internal":false,"static":false}],"projects":[{"open_access":true,"license":{"content":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"title":"Raw Pixels to Products","authors":[{"nameParsed":{"literal":"Tasha Snow","given":"Tasha","family":"Snow"},"name":"Tasha Snow","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Kathryn Moore","given":"Kathryn","family":"Moore"},"name":"Kathryn Moore","id":"contributors-myst-generated-uid-1"},{"nameParsed":{"literal":"Genevieve Clow","given":"Genevieve","family":"Clow"},"name":"Genevieve Clow","id":"contributors-myst-generated-uid-2"},{"nameParsed":{"literal":"Jianwen Du","given":"Jianwen","family":"Du"},"name":"Jianwen Du","id":"contributors-myst-generated-uid-3"},{"nameParsed":{"literal":"Arman Oliazneeh","given":"Arman","family":"Oliazneeh"},"name":"Arman Oliazneeh","id":"contributors-myst-generated-uid-4"}],"contributors":[{"id":"brian-rose","nameParsed":{"literal":"Brian E. J. Rose","given":"Brian E. J.","family":"Rose"},"name":"Brian E. J. Rose","orcid":"0000-0002-9961-3821","email":"brose@albany.edu","affiliations":["UAlbany"],"url":"https://brian-rose.github.io","github":"brian-rose","bluesky":"@brianejrose.bsky.social","linkedin":"https://www.linkedin.com/in/brian-rose-37bb55106/"},{"id":"clyne","nameParsed":{"literal":"John Clyne","given":"John","family":"Clyne"},"name":"John Clyne","orcid":"0000-0003-2788-9017","affiliations":["CISL"],"github":"clyne"},{"id":"jukent","nameParsed":{"literal":"Julia Kent","given":"Julia","family":"Kent"},"name":"Julia Kent","orcid":"0000-0002-5611-8986","affiliations":["CISL"],"github":"jukent"},{"id":"ktyle","nameParsed":{"literal":"Kevin Tyle","given":"Kevin","family":"Tyle"},"name":"Kevin Tyle","orcid":"0000-0001-5249-9665","affiliations":["UAlbany"],"github":"ktyle"},{"id":"andersy005","nameParsed":{"literal":"Anderson Banihirwe","given":"Anderson","family":"Banihirwe"},"name":"Anderson Banihirwe","orcid":"0000-0001-6583-571X","affiliations":["CarbonPlan"],"github":"andersy005"},{"id":"dcamron","nameParsed":{"literal":"Drew Camron","given":"Drew","family":"Camron"},"name":"Drew Camron","orcid":"0000-0001-7246-6502","affiliations":["Unidata"],"github":"dcamron"},{"id":"dopplershift","nameParsed":{"literal":"Ryan May","given":"Ryan","family":"May"},"name":"Ryan May","orcid":"0000-0003-2907-038X","affiliations":["Unidata"],"github":"dopplershift"},{"id":"mgrover1","nameParsed":{"literal":"Maxwell Grover","given":"Maxwell","family":"Grover"},"name":"Maxwell Grover","orcid":"0000-0002-0370-8974","affiliations":["Argonne"],"github":"mgrover1"},{"id":"r-ford","nameParsed":{"literal":"Robert R. Ford","given":"Robert R.","family":"Ford"},"name":"Robert R. Ford","orcid":"0000-0001-5483-4965","affiliations":["UAlbany"],"github":"r-ford"},{"id":"kmpaul","nameParsed":{"literal":"Kevin Paul","given":"Kevin","family":"Paul"},"name":"Kevin Paul","orcid":"0000-0001-8155-8038","affiliations":["NVIDIA"],"github":"kmpaul"},{"id":"jnmorley","nameParsed":{"literal":"James Morley","given":"James","family":"Morley"},"name":"James Morley","orcid":"0009-0005-5193-7981","github":"jnmorley"},{"id":"erogluorhan","nameParsed":{"literal":"Orhan Eroglu","given":"Orhan","family":"Eroglu"},"name":"Orhan Eroglu","orcid":"0000-0003-3099-8775","affiliations":["CISL"],"github":"erogluorhan"},{"id":"lkailynncar","nameParsed":{"literal":"Lily Kailyn","given":"Lily","family":"Kailyn"},"name":"Lily Kailyn","orcid":"0009-0002-0125-5091","affiliations":["CISL"],"github":"lkailynncar"},{"id":"anissa111","nameParsed":{"literal":"Anissa Zacharias","given":"Anissa","family":"Zacharias"},"name":"Anissa Zacharias","orcid":"0000-0002-2666-8493","affiliations":["CISL"],"github":"anissa111"},{"id":"kafitzgerald","nameParsed":{"literal":"Katelyn FitzGerald","given":"Katelyn","family":"FitzGerald"},"name":"Katelyn FitzGerald","orcid":"0000-0003-4184-1917","affiliations":["CISL"],"github":"kafitzgerald"}],"github":"https://github.com/projectpythia/landsatproduct-cookbook","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"copyright":"2025","references":{"foundations":{"url":"https://foundations.projectpythia.org"},"xarray":{"url":"https://docs.xarray.dev/en/stable"},"matplotlib":{"url":"https://matplotlib.org/stable"}},"thebe":{"binder":{"url":"https://mybinder.org/","provider":"github","repo":"projectpythia/cookbook-template","ref":"HEAD"}},"toc":[{"file":"README.md"},{"children":[{"file":"notebooks/how-to-cite.md"}],"title":"Preamble"},{"file":"notebooks/calibration_note.ipynb"},{"file":"notebooks/validation.ipynb"}],"thumbnail":"/landsatproduct-cookbook/build/thumbnail-1c010466148cdb9282b43e9e92cbe804.png","exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"Preamble"},{"slug":"notebooks.how-to-cite","title":"How to Cite This Cookbook","description":"","date":"","thumbnail":"/landsatproduct-cookbook/build/72a08caa5cbe5f9cce5999dbd1a81dfd.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.calibration-note","title":"Calibrate a physical model","description":"","date":"2025-08-07","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"notebooks.validation","title":"Validation","description":"","date":"","thumbnail":"/landsatproduct-cookbook/build/7f5ce2075ca8bde52118602eb0344051.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}]},"page":{"version":2,"kind":"Notebook","sha256":"bfbf3299e5c657595224fe7afa7d885e3a082bdb2ae9e755d9c0c97bf29c661c","slug":"notebooks.calibration-note","location":"/notebooks/calibration_note.ipynb","dependencies":[],"frontmatter":{"title":"Calibrate a physical model","authors":[{"nameParsed":{"literal":"Jianwen Du","given":"Jianwen","family":"Du"},"name":"Jianwen Du","affiliations":["UoA"],"id":"contributors-calibration_note-generated-uid-0"}],"affiliations":[{"id":"UoA","name":"University of Arizona","department":"Hydrology and Atmospheric Sciences"}],"date":"2025-08-07","license":{"content":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"open_access":true,"github":"https://github.com/projectpythia/landsatproduct-cookbook","copyright":"2025","edit_url":"https://github.com/projectpythia/landsatproduct-cookbook/blob/main/notebooks/calibration_note.ipynb","exports":[{"format":"ipynb","filename":"calibration_note.ipynb","url":"/landsatproduct-cookbook/build/calibration_note-06816e2be7918d6489406a5cd1b91108.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"ğŸ¤” Why Calibrate?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"VirwqgaZVr"}],"identifier":"id-why-calibrate","label":"ğŸ¤” Why Calibrate?","html_id":"id-why-calibrate","implicit":true,"key":"DrAu8iz83a"}],"key":"fFNDfAq8dQ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Calibration of a physical model is the process of tuning its parameters to ensure its outputs accurately match real-world measurements. Itâ€™s about bridging the gap between theoretical calculations and physical reality.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"c3QaB8Deg8"}],"key":"szzTNwFVWL"},{"type":"div","style":{"backgroundColor":"#E3F2FD","borderLeft":"5px solid #2196F3","padding":"15px","fontFamily":"sans-serif"},"children":[{"type":"strong","children":[{"type":"text","value":"Key Goal:","key":"bYRL8mvTHk"}],"key":"VeoyNLEUJg"},{"type":"text","value":" The primary goal is to improve predictive accuracy, transforming a model from a theoretical construct into a reliable tool for analysis and design.","key":"KDoGdy697S"}],"key":"T9W3Eds3ac"}],"key":"MDpELvM30G"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"ğŸ“ What Do You Need?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"x4IG3y01Ei"}],"identifier":"id-what-do-you-need","label":"ğŸ“ What Do You Need?","html_id":"id-what-do-you-need","implicit":true,"key":"ORO069B2Ki"}],"key":"feDmcOFRRD"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"To calibrate a model, you need four key components:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BhlENsRDIg"}],"key":"jd1lsy6CIA"},{"type":"div","style":{"display":"flex","flexWrap":"wrap","gap":"10px","fontFamily":"sans-serif"},"children":[{"type":"div","style":{"flex":"1","minWidth":"200px","border":"1px solid #ccc","borderRadius":"5px","padding":"10px","background":"#fafafa"},"children":[{"type":"strong","children":[{"type":"text","value":"1. A Physical Model","key":"Lum7Iv70ro"}],"key":"KuBcgGNwMF"},{"type":"break","key":"VMVMvxGlnl"},{"type":"text","value":"A set of mathematical equations or simulation software.","key":"Lq8OCeOifR"}],"key":"uoV7i9Qxrf"},{"type":"div","style":{"flex":"1","minWidth":"200px","border":"1px solid #ccc","borderRadius":"5px","padding":"10px","background":"#fafafa"},"children":[{"type":"strong","children":[{"type":"text","value":"2. Tunable Parameters","key":"SAfFonMz4Y"}],"key":"ZnPUUtfw6N"},{"type":"break","key":"PgTvdk9OEC"},{"type":"text","value":"The specific \"knobs\" in your model that you can adjust.","key":"jMwoejZ6Yc"}],"key":"E8v3HFOstI"},{"type":"div","style":{"flex":"1","minWidth":"200px","border":"1px solid #ccc","borderRadius":"5px","padding":"10px","background":"#fafafa"},"children":[{"type":"strong","children":[{"type":"text","value":"3. Experimental Data","key":"eECQwelfts"}],"key":"pwu41TEGsA"},{"type":"break","key":"uGov47vUfx"},{"type":"text","value":"High-quality measurements from the real-world system.","key":"SwlxmazUwd"}],"key":"P4EU6RdHOK"},{"type":"div","style":{"flex":"1","minWidth":"200px","border":"1px solid #ccc","borderRadius":"5px","padding":"10px","background":"#fafafa"},"children":[{"type":"strong","children":[{"type":"text","value":"4. An Objective Function","key":"EcEykXdspq"}],"key":"b11FAv8gsc"},{"type":"break","key":"rdqqqSCGlo"},{"type":"text","value":"A metric that quantifies the error (e.g., RMSE).","key":"uLvmAfGUfq"}],"key":"g43VE6rHka"}],"key":"KerMVmNAHQ"}],"key":"n0irz6jvDh"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"âš™ï¸ How to Calibrate?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Da8FSFUwLe"}],"identifier":"id-how-to-calibrate","label":"âš™ï¸ How to Calibrate?","html_id":"id-how-to-calibrate","implicit":true,"key":"Rodr3RWUvM"}],"key":"obvhyvEyHv"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"There are two main approaches to calibration: by hand (trial and error) or by using a smart computer search (optimization algorithms). Optimization is highly recommended for its efficiency and accuracy.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XOspcfLgsF"}],"key":"odwqTduwG2"},{"type":"details","children":[{"type":"summary","children":[{"type":"strong","children":[{"type":"text","value":"Click to see details on different optimization methods","key":"qrktih4F4d"}],"key":"UTI7fWtQtn"}],"key":"yA1rImF3b4"},{"type":"div","style":{"backgroundColor":"#E8F5E9","borderLeft":"5px solid #4CAF50","marginTop":"10px","padding":"15px","fontFamily":"sans-serif"},"children":[{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Gradient-Based Methods:","key":"dIPJcJAkxp"}],"key":"kwJUHxXXxm"},{"type":"text","value":" Use the error gradient for efficient searching (e.g., Levenberg-Marquardt).","key":"ZTjkRLBpO8"}],"key":"xny18BCKUj"}],"key":"f9ApueYVGc"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Gradient-Free Methods:","key":"B9j5bQa2xp"}],"key":"AAuFWHayQG"},{"type":"text","value":" Do not require gradients, essential for â€œblack-boxâ€ simulations (e.g., Nelder-Mead).","key":"Lsmt3swDPc"}],"key":"lsyzh6YKY8"}],"key":"w1XrFXn1Vm"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Bayesian Calibration:","key":"g0uoX6jUk9"}],"key":"shauxEr7Q3"},{"type":"text","value":" Treats parameters as probability distributions to quantify uncertainty.","key":"mn54R8duAO"}],"key":"Vdhs8x9y6G"}],"key":"wBkJ3pyjRC"},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"strong","children":[{"type":"text","value":"Cross-Calibration:","key":"zUM8gEOzv7"}],"key":"zGXHL6l0W0"},{"type":"text","value":" Calibrates one model against a trusted reference model to ensure consistency.","key":"rIO3Fp5zKW"}],"key":"x7xEdhBqu2"}],"key":"OmLhIreYDm"}],"key":"spxJm0WNVp"}],"key":"Khc3Eaqs6W"}],"key":"JawOwPsabG"}],"key":"pxf7UjzkTD"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"âœ… How Do You Know Itâ€™s Calibrated?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YZcF9X27H1"}],"identifier":"id-how-do-you-know-its-calibrated","label":"âœ… How Do You Know Itâ€™s Calibrated?","html_id":"id-how-do-you-know-its-calibrated","implicit":true,"key":"LZkndeNIjG"}],"key":"g9tsCGDpcS"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"A successful calibration can be verified by analyzing the errors and by validating the model against new data. A common way to visualize the result is by plotting the modelâ€™s output against the experimental data.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TWuyz3wpGY"}],"key":"BkHvIOtpYr"}],"key":"hR8kQhfFnK"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Interactive Example: Adjusting Model Parameters","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"F2o6fUSFZE"}],"identifier":"interactive-example-adjusting-model-parameters","label":"Interactive Example: Adjusting Model Parameters","html_id":"interactive-example-adjusting-model-parameters","implicit":true,"key":"iTJHHdd6u4"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"To make this concept interactive, you can run the code cell below. It will create the same plot but with sliders that let you manually adjust the modelâ€™s parameters (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"qfkzargxKm"},{"type":"inlineCode","value":"slope","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XwoJTnThnm"},{"type":"text","value":" and ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SbEvNpiFdH"},{"type":"inlineCode","value":"intercept","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"h9ZZjAeQnx"},{"type":"text","value":"). Try to move the sliders to make the red line fit the blue dots. This gives you a hands-on feel for the â€œBy Handâ€ calibration process.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wbzyov7l5y"}],"key":"ujiK1XYUyt"}],"key":"skiPJQnOFb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# First, let's install ipywidgets for the interactive sliders\n!pip install -q ipywidgets\n\n# Import necessary libraries\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom ipywidgets import interact, fixed\n\n# 1. Create the sample \"Experimental Data\"\nnp.random.seed(0)\nx_data = np.linspace(0, 10, 20)\ntrue_slope = 2.5\ntrue_intercept = 1.5\ny_data = true_slope * x_data + true_intercept + np.random.normal(0, 2, size=x_data.shape)\n\n# 2. Define a function to plot the data and our adjustable model\ndef plot_model(x, y, slope, intercept):\n    \"\"\"Plots the experimental data against the model line defined by slope and intercept.\"\"\"\n    y_model = slope * x + intercept\n    \n    plt.figure(figsize=(8, 6))\n    plt.plot(x, y, 'o', label='Experimental Data', markersize=8, color='royalblue')\n    plt.plot(x, y_model, '-', label='Adjustable Model', linewidth=3, color='red')\n    \n    # Calculate and display the RMSE as our objective function score\n    rmse = np.sqrt(np.mean((y - y_model)**2))\n    plt.title(f'Comparison of Model vs. Data (RMSE: {rmse:.2f})', fontsize=16)\n    \n    plt.xlabel('Independent Variable', fontsize=12)\n    plt.ylabel('Dependent Variable', fontsize=12)\n    plt.ylim(min(y_data)-2, max(y_data)+2)\n    plt.legend()\n    plt.grid(True, linestyle='--', alpha=0.6)\n    plt.show()\n\n# 3. Create the interactive plot!\n# The 'interact' function automatically creates sliders for the numerical arguments.\ninteract(plot_model, x=fixed(x_data), y=fixed(y_data), slope=(0.0, 5.0, 0.1), intercept=(-5.0, 5.0, 0.1));","key":"rCpsKwQHUu"},{"type":"output","id":"OUTOvU_pAYw-hbqjrjGRK","data":[{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"\u003cFigure size 800x600 with 1 Axes\u003e","content_type":"text/plain"},"image/png":{"content_type":"image/png","hash":"57418c7653ca5257893f031d6dab27b1","path":"/landsatproduct-cookbook/build/57418c7653ca5257893f031d6dab27b1.png"}}},{"output_type":"display_data","metadata":{},"data":{"text/plain":{"content":"interactive(children=(FloatSlider(value=2.5, description='slope', max=5.0), FloatSlider(value=0.0, descriptionâ€¦","content_type":"text/plain"},"application/vnd.jupyter.widget-view+json":{"content":"{\"version_major\":2,\"version_minor\":0,\"model_id\":\"07fe841d91ca4b73a2ccc6372926c4ce\"}","content_type":"application/vnd.jupyter.widget-view+json"}}}],"key":"DhWi2zVuzQ"}],"key":"LRpVTewlaQ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example: Landsat calibration using MODIS SST","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zgVmS3yncf"}],"identifier":"example-landsat-calibration-using-modis-sst","label":"Example: Landsat calibration using MODIS SST","html_id":"example-landsat-calibration-using-modis-sst","implicit":true,"key":"kfZtcWcciQ"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Create matchups between Landsat and MODIS SST data near Cosgrove, West Antarctica\nto produce a calibration for Landsat SSTs","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"TuZelc98P1"}],"key":"bo49kBl0J5"}],"key":"AHKjYzHMXo"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import earthaccess\n%pip install seaborn\n%pip install pykrige\n%pip install xarray==2024.05.0","key":"X9Us4d7KNW"},{"type":"output","id":"MKUxhMU2XH_l1HNzWF3bd","data":[{"output_type":"stream","name":"stdout","text":"Requirement already satisfied: seaborn in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (0.13.2)\r\nRequirement already satisfied: numpy!=1.24.0,\u003e=1.20 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from seaborn) (2.2.6)\r\nRequirement already satisfied: pandas\u003e=1.2 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from seaborn) (2.3.1)\r\nRequirement already satisfied: matplotlib!=3.6.1,\u003e=3.4 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from seaborn) (3.10.5)\r\nRequirement already satisfied: contourpy\u003e=1.0.1 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from matplotlib!=3.6.1,\u003e=3.4-\u003eseaborn) (1.3.3)\r\nRequirement already satisfied: cycler\u003e=0.10 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from matplotlib!=3.6.1,\u003e=3.4-\u003eseaborn) (0.12.1)\r\nRequirement already satisfied: fonttools\u003e=4.22.0 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from matplotlib!=3.6.1,\u003e=3.4-\u003eseaborn) (4.59.0)\r\nRequirement already satisfied: kiwisolver\u003e=1.3.1 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from matplotlib!=3.6.1,\u003e=3.4-\u003eseaborn) (1.4.8)\r\nRequirement already satisfied: packaging\u003e=20.0 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from matplotlib!=3.6.1,\u003e=3.4-\u003eseaborn) (25.0)\r\nRequirement already satisfied: pillow\u003e=8 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from matplotlib!=3.6.1,\u003e=3.4-\u003eseaborn) (11.3.0)\r\nRequirement already satisfied: pyparsing\u003e=2.3.1 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from matplotlib!=3.6.1,\u003e=3.4-\u003eseaborn) (3.2.3)\r\nRequirement already satisfied: python-dateutil\u003e=2.7 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from matplotlib!=3.6.1,\u003e=3.4-\u003eseaborn) (2.9.0.post0)\r\nRequirement already satisfied: pytz\u003e=2020.1 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from pandas\u003e=1.2-\u003eseaborn) (2025.2)\r\nRequirement already satisfied: tzdata\u003e=2022.7 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from pandas\u003e=1.2-\u003eseaborn) (2025.2)\r\nRequirement already satisfied: six\u003e=1.5 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from python-dateutil\u003e=2.7-\u003ematplotlib!=3.6.1,\u003e=3.4-\u003eseaborn) (1.17.0)\r\n"},{"output_type":"stream","name":"stdout","text":"Note: you may need to restart the kernel to use updated packages.\n"},{"output_type":"stream","name":"stdout","text":"Collecting pykrige\r\n"},{"output_type":"stream","name":"stdout","text":"  Downloading pykrige-1.7.2.tar.gz (618 kB)\r\n\u001b[?25l     \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m0.0/618.7 kB\u001b[0m \u001b[31m?\u001b[0m eta \u001b[36m-:--:--\u001b[0m\r\u001b[2K     \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m618.7/618.7 kB\u001b[0m \u001b[31m27.0 MB/s\u001b[0m  \u001b[33m0:00:00\u001b[0m\r\n\u001b[?25h"},{"output_type":"stream","name":"stdout","text":"  Installing build dependencies ... \u001b[?25l-"},{"output_type":"stream","name":"stdout","text":"\b \b\\"},{"output_type":"stream","name":"stdout","text":"\b \b|"},{"output_type":"stream","name":"stdout","text":"\b \b/"},{"output_type":"stream","name":"stdout","text":"\b \b-"},{"output_type":"stream","name":"stdout","text":"\b \b\\"},{"output_type":"stream","name":"stdout","text":"\b \b|"},{"output_type":"stream","name":"stdout","text":"\b \b/"},{"output_type":"stream","name":"stdout","text":"\b \b-"},{"output_type":"stream","name":"stdout","text":"\b \b\\"},{"output_type":"stream","name":"stdout","text":"\b \b|"},{"output_type":"stream","name":"stdout","text":"\b \b/"},{"output_type":"stream","name":"stdout","text":"\b \b-"},{"output_type":"stream","name":"stdout","text":"\b \b\\"},{"output_type":"stream","name":"stdout","text":"\b \bdone\r\n"},{"output_type":"stream","name":"stdout","text":"\u001b[?25h  Getting requirements to build wheel ... \u001b[?25l-"},{"output_type":"stream","name":"stdout","text":"\b \b\\"},{"output_type":"stream","name":"stdout","text":"\b \b|"},{"output_type":"stream","name":"stdout","text":"\b \bdone\r\n"},{"output_type":"stream","name":"stdout","text":"\u001b[?25h  Preparing metadata (pyproject.toml) ... \u001b[?25l-"},{"output_type":"stream","name":"stdout","text":"\b \b\\\b \bdone\r\n\u001b[?25hRequirement already satisfied: numpy\u003e=1.20.0 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from pykrige) (2.2.6)\r\nRequirement already satisfied: scipy\u003c2,\u003e=1.1.0 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from pykrige) (1.16.0)\r\n"},{"output_type":"stream","name":"stdout","text":"Building wheels for collected packages: pykrige\r\n"},{"output_type":"stream","name":"stdout","text":"  Building wheel for pykrige (pyproject.toml) ... \u001b[?25l-"},{"output_type":"stream","name":"stdout","text":"\b \b\\"},{"output_type":"stream","name":"stdout","text":"\b \b|"},{"output_type":"stream","name":"stdout","text":"\b \b/"},{"output_type":"stream","name":"stdout","text":"\b \bdone\r\n\u001b[?25h  Created wheel for pykrige: filename=pykrige-1.7.2-cp313-cp313-linux_x86_64.whl size=239566 sha256=e16db7faa912fcf985b839394ac92c39dde75ea7bd6314eda165ca35cbe3ae2c\r\n  Stored in directory: /home/runner/.cache/pip/wheels/4e/38/d7/78be390d01bdc3f679ae44634bc4c749f6505db1dae2e3b04e\r\nSuccessfully built pykrige\r\n"},{"output_type":"stream","name":"stdout","text":"Installing collected packages: pykrige\r\n"},{"output_type":"stream","name":"stdout","text":"Successfully installed pykrige-1.7.2\r\n"},{"output_type":"stream","name":"stdout","text":"Note: you may need to restart the kernel to use updated packages.\n"},{"output_type":"stream","name":"stdout","text":"Collecting xarray==2024.05.0\r\n  Downloading xarray-2024.5.0-py3-none-any.whl.metadata (11 kB)\r\n"},{"output_type":"stream","name":"stdout","text":"Requirement already satisfied: numpy\u003e=1.23 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from xarray==2024.05.0) (2.2.6)\r\nRequirement already satisfied: packaging\u003e=23.1 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from xarray==2024.05.0) (25.0)\r\nRequirement already satisfied: pandas\u003e=2.0 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from xarray==2024.05.0) (2.3.1)\r\nRequirement already satisfied: python-dateutil\u003e=2.8.2 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from pandas\u003e=2.0-\u003exarray==2024.05.0) (2.9.0.post0)\r\nRequirement already satisfied: pytz\u003e=2020.1 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from pandas\u003e=2.0-\u003exarray==2024.05.0) (2025.2)\r\nRequirement already satisfied: tzdata\u003e=2022.7 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from pandas\u003e=2.0-\u003exarray==2024.05.0) (2025.2)\r\nRequirement already satisfied: six\u003e=1.5 in /home/runner/micromamba/envs/landsat-product-cookbook-dev/lib/python3.13/site-packages (from python-dateutil\u003e=2.8.2-\u003epandas\u003e=2.0-\u003exarray==2024.05.0) (1.17.0)\r\nDownloading xarray-2024.5.0-py3-none-any.whl (1.2 MB)\r\n\u001b[?25l   \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m0.0/1.2 MB\u001b[0m \u001b[31m?\u001b[0m eta \u001b[36m-:--:--\u001b[0m"},{"output_type":"stream","name":"stdout","text":"\r\u001b[2K   \u001b[90mâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\u001b[0m \u001b[32m1.2/1.2 MB\u001b[0m \u001b[31m48.7 MB/s\u001b[0m  \u001b[33m0:00:00\u001b[0m\r\n\u001b[?25h"},{"output_type":"stream","name":"stdout","text":"Installing collected packages: xarray\r\n  Attempting uninstall: xarray\r\n    Found existing installation: xarray 2025.7.1\r\n    Uninstalling xarray-2025.7.1:\r\n      Successfully uninstalled xarray-2025.7.1\r\n"},{"output_type":"stream","name":"stdout","text":"\u001b[31mERROR: pip's dependency resolver does not currently take into account all the packages that are installed. This behaviour is the source of the following dependency conflicts.\r\nvirtualizarr 1.2.0 requires xarray\u003e=2024.10.0, but you have xarray 2024.5.0 which is incompatible.\r\nrioxarray 0.19.0 requires xarray\u003e=2024.7.0, but you have xarray 2024.5.0 which is incompatible.\u001b[0m\u001b[31m\r\n\u001b[0mSuccessfully installed xarray-2024.5.0\r\n"},{"output_type":"stream","name":"stdout","text":"Note: you may need to restart the kernel to use updated packages.\n"}],"key":"xFkdGf0YXp"}],"key":"t33sk2olYL"},{"type":"block","kind":"notebook-code","data":{"editable":true,"slideshow":{"slide_type":""},"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Import libraries and modules\n%config InlineBackend.figure_format = 'svg'\n%matplotlib widget\n\n%load_ext autoreload\n%autoreload 2\n\nimport pandas as pd\nimport xarray as xr\nimport geopandas as gpd\nfrom datetime import date, timedelta, datetime\nimport numpy as np\nimport matplotlib.pylab as plt\nfrom matplotlib import colors\nfrom matplotlib.pylab import rcParams\nfrom matplotlib.patches import Polygon as Pgon\nimport cartopy.crs as ccrs\nimport cartopy\n\nimport os\nfrom cycler import cycler\nimport pyproj\nfrom pyproj import Proj, transform\nfrom sklearn.neighbors import BallTree\nimport pytz\nimport pygmt\nimport gc\nimport copy\nimport random\nimport statsmodels.formula.api as sm\nimport scipy.stats as stats\nfrom sklearn.linear_model import RANSACRegressor\nfrom sklearn.linear_model import LinearRegression\nfrom shapely.geometry import Point, Polygon\nfrom pathlib import Path\nimport math\nfrom scipy.odr import Model, RealData, ODR\nfrom tqdm.notebook import trange, tqdm\nimport seaborn as sns\n\nimport earthaccess\n\n# For LST file masking\nimport pystac_client\nimport intake\nfrom rasterio.session import AWSSession\nimport boto3\n\nimport SSTutils as stu\n\nimport warnings\nwarnings.filterwarnings('ignore')","visibility":"show","key":"Yvb6z43F3q"},{"type":"output","id":"473s4rsF6jnNx8hQ6Gavq","data":[{"output_type":"error","traceback":"\u001b[31m---------------------------------------------------------------------------\u001b[39m\n\u001b[31mModuleNotFoundError\u001b[39m                       Traceback (most recent call last)\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[3]\u001b[39m\u001b[32m, line 49\u001b[39m\n\u001b[32m     46\u001b[39m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mrasterio\u001b[39;00m\u001b[34;01m.\u001b[39;00m\u001b[34;01msession\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m AWSSession\n\u001b[32m     47\u001b[39m \u001b[38;5;28;01mimport\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mboto3\u001b[39;00m\n\u001b[32m---\u003e \u001b[39m\u001b[32m49\u001b[39m \u001b[38;5;28;01mimport\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mSSTutils\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mas\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mstu\u001b[39;00m\n\u001b[32m     51\u001b[39m \u001b[38;5;28;01mimport\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mwarnings\u001b[39;00m\n\u001b[32m     52\u001b[39m warnings.filterwarnings(\u001b[33m'\u001b[39m\u001b[33mignore\u001b[39m\u001b[33m'\u001b[39m)\n\n\u001b[31mModuleNotFoundError\u001b[39m: No module named 'SSTutils'","ename":"ModuleNotFoundError","evalue":"No module named 'SSTutils'"}],"visibility":"show","key":"K2HKBnQW81"}],"visibility":"show","key":"iiYpXgFa0U"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"#For color cycling in plots that is color blind friendly...make new ones at \"I want hue\" tools.medialab.sciences-po.fr/iwanthue\ncolor_cycler = cycler(color=[\"#6777cf\",\"#adba49\",\"#c65ca0\",\"#5fa042\",\"#683287\",\"#72ce7b\",\"#c44a48\",\"#45c7a9\",\"#933c1d\",\"#d0803f\",\"#ac9239\",\"#317c39\"])\ncolorline_cycler = (cycler(color=[\"#75a141\",\"#6c61b9\",\"#bc4d45\",\"#c1913d\",\"#b85298\",\"#4aa8e8\"]) +\n                 cycler(linestyle=['-','--',':','-.','-','--']))\nrcParams['axes.prop_cycle'] = cycler('color', color_cycler)","visibility":"show","key":"G7XAKMclRD"},{"type":"output","id":"ccR2rLBusru4obtRkuZIM","data":[],"visibility":"show","key":"AkotbM5tXF"}],"visibility":"show","key":"hKqldIGpRn"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Build Landsat - MODIS SST matchups","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vcNKb1xUpc"}],"identifier":"build-landsat-modis-sst-matchups","label":"Build Landsat - MODIS SST matchups","html_id":"build-landsat-modis-sst-matchups","implicit":true,"key":"eSxC70RKbV"}],"visibility":"show","key":"OUQVxoOB6r"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Set paths and important variables and Calibration region bounding box\n\nbasepath = Path('/home/jovyan/landsatproduct-cookbook')\nspacing = [990,-990] # 990m sampling of MODIS data so that upsampling is easy and because 30m takes far too long\nparam = 'sea_surface_temperature'\nsize_threshold = 30\n\nlocation = 0             # 0 and 1 are the Cosgrove and Dotson Polynya calibration areas, respectively\nsurf_temp = 'SST'        # 'SST' and 'LST' are for the Landsat SST and LST algorithms respectively\n\n# Set location bounds\nif location==1:\n    pathdir = 'DotsonPolynya'\n    latboundsC = [ -73.9 , -73.5 ] # Dotson polynya\n    lonboundsC = [ -113 , -111.5 ]\n    dfloc = 'Dotson'\nelif location==0:\n    pathdir = 'Cosgrove'\n    latboundsC = [ -73.5 , -73.42 ] # near Cosgrove\n    lonboundsC = [ -103.0 , -102.0 ]\n    dfloc = 'Cosgrove'\nelif location==2:\n    pathdir = 'Burke'\n    latboundsC = [ -73.81 , -73.42 ] # south of Burke\n    lonboundsC = [ -104.2 , -103.8 ]\n    dfloc = 'Burke'\nif location==3:\n    pathdir = 'DotsonIntercomp'\n    latboundsC = [ -74.2 , -74.11 ] # Dotson plume for intercomparison\n    lonboundsC = [ -113.5 , -113.17 ]\n    dfloc = 'DotsonIntercomp'\n\n# Coefficients for calibration\n# SST\nsstcalib_m = 0.76 \nsstcalib_b = 0.55 \n\n# LST\nlstcalib_m = 0.80\nlstcalib_b = 1.00\n\nmodmin = -1.9\nLSTmin = np.around(modmin/lstcalib_m - lstcalib_b,2) \nSSTmin = np.around(modmin/sstcalib_m - sstcalib_b,2) # should be about -2.0\n\n# Uncertainties used in ODR propagation of error\nmodis_uncertainty = 0.44  # long wave sst ocean color atbd\nsst_uncertainty = 0.3 # USGS Landsat stray light notice\nlst_uncertainty = 1.0 # gerace 2020\npix_uncertainty = np.sqrt((1000*1000)/(100*100)) # MODIS 1km x 1km and Landsat 100m x 100m\n\n\n# For calibrated SST runs\nif surf_temp=='SST':\n    if location==3:\n        sstpath = basepath / f'Data/SST/Validation/{pathdir}/'\n    else:\n        sstpath = basepath / f'Data/SST/MODcalib/{pathdir}/'\n    tif = 'tif'\n    thresh = SSTmin\n    calib_m = sstcalib_m\n    calib_b = sstcalib_b\n    \n# If running for LST comparisons\nelif surf_temp=='LST':\n    if location==3:\n        sstpath = basepath / f'Data/SST/LST/Calibration/DotsonPolynya/'\n    else:\n        sstpath = basepath / f'Data/SST/LST/Calibration/{pathdir}/'\n    tif = 'TIF'\n    thresh = LSTmin\n    calib_m = lstcalib_m\n    calib_b = lstcalib_b","visibility":"show","key":"e1c9xULkbj"},{"type":"output","id":"FLdbJoTzurU19gdWp3Shh","data":[],"visibility":"show","key":"upyrF5HvfC"}],"visibility":"show","key":"OrgD9xnfZB"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Authenticate for accessing NASA data (MODIS)\nauth = earthaccess.login(strategy=\"interactive\")\n\n# If we are not authenticated\nif not auth.authenticated:\n    # ask for credentials and persist them in a .netrc file\n    auth.login(strategy=\"interactive\", persist=True)","visibility":"show","key":"iyrYe7ixPR"},{"type":"output","id":"CECnZO82CeoA_WC9vC0pk","data":[],"visibility":"show","key":"BPyoCgsMqU"}],"visibility":"show","key":"IJoNBM1v7W"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Convert bounding box to south polar stereo for checking if landsat has any data in bounding box\n# Speeds up process a lot\nsource_crs = 'epsg:4326' \ntarget_crs = 'epsg:3031' # Coordinate system of the file\n\nbbox,checkbox = stu.lsat_reproj(source_crs,target_crs,(lonboundsC[0],latboundsC[0],lonboundsC[1],latboundsC[1]))\n\n# Create polygon for later cropping\npolygon = Polygon([(bbox[0][0],bbox[0][1]),(bbox[3][0],bbox[3][1]),(bbox[2][0],bbox[2][1]),(bbox[1][0],bbox[1][1])])\n\n# Create min/max boundaries for trimming image before crop_xarray to cut down on processing times\nminx, miny, maxx, maxy = polygon.bounds\npolarx = [minx, maxx]\npolary = [miny, maxy]","visibility":"show","key":"qSgna6xoLi"},{"type":"output","id":"kLQmBXFbzUseD7ZCzy9vv","data":[],"visibility":"show","key":"LvPqwSD3BN"}],"visibility":"show","key":"wsRyTI8j0k"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Get Landsat file paths in directory\nlsatfiles = os.listdir(sstpath)\nlsatfiles = [x for x in lsatfiles if x[-3:] == tif]\nlsatfiles.sort()\nprint (len(lsatfiles))\nos.chdir(sstpath)","visibility":"show","key":"PqVxffNJZJ"},{"type":"output","id":"lQ9qjpJW0uSTKTbPfqWFS","data":[],"visibility":"show","key":"Z7xmdhf2OW"}],"visibility":"show","key":"elRk1XSqDi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"SSTfails = [\n 'LC08_L1GT_006112_20221024_20221107_02_T2_152257_Cel.tif',\n 'LC08_L1GT_006112_20221024_20221107_02_T2_152257_Cel.tif',\n]\nLSTfails = [\n 'LC08_L1GT_007112_20211215_20211223_02_T2_SW_LST.TIF',\n 'LC08_L1GT_007112_20220201_20220211_02_T2_SW_LST.TIF',\n 'LC08_L1GT_007112_20221202_20221212_02_T2_SW_LST.TIF',\n 'LC08_L1GT_007112_20230204_20230209_02_T2_SW_LST.TIF',\n 'LC08_L1GT_008113_20221022_20221101_02_T2_SW_LST.TIF',\n 'LC08_L1GT_010112_20221020_20221101_02_T2_SW_LST.TIF',\n 'LC08_L1GT_010113_20221020_20221101_02_T2_SW_LST.TIF',\n 'LC08_L1GT_012112_20221018_20221031_02_T2_SW_LST.TIF',\n 'LC08_L1GT_008113_20221022_20221101_02_T2_SW_LST.TIF',\n 'LC08_L1GT_010112_20221020_20221101_02_T2_SW_LST.TIF',\n 'LC08_L1GT_010113_20220105_20220114_02_T2_SW_LST.TIF',\n 'LC08_L1GT_010113_20220121_20220128_02_T2_SW_LST.TIF',\n 'LC08_L1GT_010113_20221020_20221101_02_T2_SW_LST.TIF',\n 'LC08_L1GT_010113_20221105_20221115_02_T2_SW_LST.TIF',\n 'LC08_L1GT_010113_20230108_20230124_02_T2_SW_LST.TIF',\n 'LC08_L1GT_010113_20230313_20230321_02_T2_SW_LST.TIF',\n 'LC08_L1GT_012112_20221018_20221031_02_T2_SW_LST.TIF'\n]","key":"w4n2plpjd2"},{"type":"output","id":"7_fAdFqktQEdl0rhJROaI","data":[],"key":"vCC52kzHRb"}],"key":"ut8PbmcwWP"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Search for desired Landsat scenes","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"z2w4IZfMtX"}],"identifier":"search-for-desired-landsat-scenes","label":"Search for desired Landsat scenes","html_id":"search-for-desired-landsat-scenes","implicit":true,"key":"We1rYT7TEY"}],"key":"VOpRhh7fI7"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Authenticate for boto S3 access, etc.\nos.environ[\"AWS_REQUEST_PAYER\"] = \"requester\"\naws_session = AWSSession(boto3.Session(), requester_pays=True)","visibility":"show","key":"HD1jQS7FVt"},{"type":"output","id":"G5Pxy6UmbgAUguwPDgAXm","data":[],"visibility":"show","key":"iTfQZDnxsb"}],"visibility":"show","key":"hD3KPQhYNO"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Setup and authenticate \nfrom dask.distributed import Client\nimport logging\nclient = Client(processes=True, n_workers=4, \n                threads_per_worker=1,\n                silence_logs=logging.ERROR)\nclient.run(lambda: os.environ[\"AWS_REQUEST_PAYER\"] == \"requester\" )\nclient","visibility":"show","key":"wCtnbSxdVF"},{"type":"output","id":"72mgl53oOn0nOX2ec1Vr7","data":[],"visibility":"show","key":"EgHElWhmWF"}],"visibility":"show","key":"CLT0xEOMnm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Define the landsat STAC catalog location\nurl = 'https://landsatlook.usgs.gov/stac-server'\ncollection = 'landsat-c2l1' # Landsat Collection 2, Level 1 - includes L8 and L9","key":"a9ZWgUGPg4"},{"type":"output","id":"MUIk5C0RAupsQB7XSZ85c","data":[],"key":"kodzyS3jNe"}],"key":"LU9zclDIP8"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"i=0 # We will use the first image as an example\nls_scene = xr.open_dataset(lsatfiles[i],chunks=dict(x=512, y=512),engine='rasterio')['band_data'].sel(band=1)\nls_scene","key":"bBk1tx7Oth"},{"type":"output","id":"N5_86gW4hsxoZf40lQGPu","data":[],"key":"rzRKeup3vQ"}],"key":"BrBEUlg5Dk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n# ~1 min 32 sec per image\n# If number of MODIS images per satellite is much more than 25, its because there is a ULY,LRY issue\nos.chdir('/home/jovyan/landsatproduct-cookbook/Data/SST/MODcalib/Cosgrove/')\n\nlsat_mod = []\nfor i in tqdm(range(len(lsatfiles)), desc=\"Processing\"):\n    # Check for known repeatedly bad files that will kill the code\n    if surf_temp == 'SST':    \n        if lsatfiles[i] in SSTfails:\n            continue\n    elif surf_temp == 'LST':\n        if lsatfiles[i] in LSTfails:\n            continue\n        \n    # Concatenate all landsat files into xarray with a time dimension\n    ls_scene = xr.open_dataset(lsatfiles[i],chunks=dict(x=512, y=512),engine='rasterio')['band_data'].sel(band=1)\n    ls_scene = ls_scene.rio.write_crs(\"epsg:3031\", inplace=True)\n    \n    if surf_temp == 'SST':\n        times = pd.to_datetime(lsatfiles[i][17:25]+lsatfiles[i][41:47], format='%Y%m%d%H%M%S')\n        ls_scene = ls_scene.assign_coords(time=times,ID=lsatfiles[i][:-8])\n    elif surf_temp == 'LST':\n        # Need to mask LST because not done previously\n        mask = stu.get_lst_mask(lsatfiles[i])\n        ls_scene = ls_scene * mask\n        \n        times = pd.to_datetime(lsatfiles[i][17:25]+'120000', format='%Y%m%d%H%M%S')\n        ls_scene = ls_scene.assign_coords(time=times,ID=lsatfiles[i][:-4])\n        ls_scene = ls_scene - 273.15\n\n    # Subset scene and check that it has the correct dimensions because y order changes sometimes\n    ls_scene = stu.subset_img(ls_scene,polarx,polary) # subset so easier to work with\n    ls_scene = stu.crop_xarray_dataarray_with_polygon(ls_scene, polygon) # crop data to exact bounding box\n\n    lsID = lsatfiles[i]\n    \n    # Take mean temp, will skip the modis stage if no Landsat data in the calibration region\n    try:\n        lsat = np.nanmean(ls_scene)\n    except Exception as e:\n        lsat = np.nan\n\n    if ~np.isfinite(lsat):\n        continue\n\n    # Find coincident MODIS SST scene\n    mod_scene, mod_file,time_dif = stu.find_MODIS(lonboundsC,latboundsC,ls_scene)\n\n    try:\n        # Acquire and align MODIS data to Landsat\n        MODsst_xr = stu.get_sst(ls_scene,mod_scene.sea_surface_temperature,spacing,param)\n        # Remove SSTs that are unrealistically cool\n        MODsst_xr = MODsst_xr.where(MODsst_xr \u003e= -1.9, np.nan)\n        # Crop Landsat image to meet the slightly smaller MODIS image\n        ls_scene = stu.subset_img(ls_scene,[MODsst_xr.x.min(),MODsst_xr.x.max()],[MODsst_xr.y.min(),MODsst_xr.y.max()])\n        # Only use MODIS data where cropped Landsat data is also available\n        MODsst_xr_sub = MODsst_xr.where(ls_scene.notnull(),np.nan)\n        # Take mean temp\n        modis = np.nanmean(MODsst_xr_sub)\n        MOD_num = MODsst_xr_sub.notnull().values.sum()\n    except Exception as e:\n        modis = np.nan\n        MOD_num = 0\n\n    # Take mean using Landsat data only where cropped MODIS data is also available (need to do both)\n    try:\n        ls_scene_sub = ls_scene.where(MODsst_xr_sub.notnull(),np.nan)\n        lsat = np.nanmean(ls_scene_sub)\n        ls_num = ls_scene_sub.notnull().values.sum()\n    except Exception as e:\n        lsat = np.nan\n        ls_num = 0 # FIX: Initialize ls_num in case of exception\n\n    # Append file names with SST means from the Cosgrove box\n    lsat_mod.append([times,mod_file,modis,MOD_num,lsID,lsat,ls_num,time_dif])\n    \n    try:\n        del ls_scene, mod_scene, MODsst_xr, MODsst_xr_sub\n    except:\n        pass\n\n    gc.collect()","key":"yJb6dx5e2W"},{"type":"output","id":"F-X5_qpo4BmyEXC2Q5bmP","data":[],"key":"AIgMnh9nc0"}],"key":"pGrz4IYVHD"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Put data into DataFrame and save    \nheaders = ['DateTime','MODIS_filename','MODIS_SST','MODIS_pix','L8_filename',f'L8_{surf_temp}','L8_pix','time_dif']\nlsat_mod_df = pd.DataFrame(lsat_mod,columns=headers)\nout_df = basepath / f'Data/MODISvLandsat_{surf_temp}_{dfloc}_20250500.csv'\nlsat_mod_df.to_csv(out_df, index=False)","visibility":"show","key":"mVBQDZ4HFz"},{"type":"output","id":"1GeZDykgB7Hv7GrItXjUt","data":[],"visibility":"show","key":"OfYDEQb0kp"}],"visibility":"show","key":"pRJyMXjzRG"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print (out_df)","key":"QaZjmZqinV"},{"type":"output","id":"vuHEoDCJI1qBJ_hHTAe2G","data":[],"key":"P1LT6tQgrf"}],"key":"NDqDnliTO6"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Calculate calibration bias and trend","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XwBmBX3UuJ"}],"identifier":"calculate-calibration-bias-and-trend","label":"Calculate calibration bias and trend","html_id":"calculate-calibration-bias-and-trend","implicit":true,"key":"zCF5xr2Uba"}],"key":"zz05cftUAW"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"# Read in paired MODIS/Landsat data created above\nsurf_temp = 'SST'\n\nif surf_temp=='LST':\n    thresh = -3.5 # -3.4 is ok too\n    pix_thresh = 1300\nelif surf_temp=='SST':\n    thresh = -3.1\n    pix_thresh = 1300\nmod_sst_thresh = -1.9\n\n# For Cosgrove region\nif surf_temp=='LST':\n    out_df_C = '/home/jovyan/landsatproduct-cookbook/Data/MODISvLandsat_LST_Cosgrove.csv'\nelse:   \n    out_df_C = '/home/jovyan/landsatproduct-cookbook/Data/MODISvLandsat_SST_Cosgrove_lin_scale.csv' \nlsat_mod_df_C = pd.read_csv(out_df_C)\nlsat_mod_df_C['Region'] = 'Cosgrove'\n\n# For Dotson polynya region\nif surf_temp=='LST':\n    out_df_D = '/home/jovyan/landsatproduct-cookbook/Data/MODISvLandsat_LST_Dotson.csv'\nelse:\n    out_df_D = '/home/jovyan/landsatproduct-cookbook/Data/MODISvLandsat_SST_Dotson_lin_scale.csv'  \nlsat_mod_df_D = pd.read_csv(out_df_D)\nlsat_mod_df_D['Region'] = 'Dotson'\n\n# For Burke region\nif surf_temp=='LST':\n    out_df_B = '/home/jovyan/landsatproduct-cookbook/Data/MODISvLandsat_LST_Burke.csv'\nelse:\n    out_df_B = '/home/jovyan/landsatproduct-cookbook/Data/MODISvLandsat_SST_Burke_lin_scale.csv'\nlsat_mod_df_B = pd.read_csv(out_df_B)\nlsat_mod_df_B['Region'] = 'Burke'\n\n# Concatenate data from all regions\nlsat_mod_df_n = pd.concat([lsat_mod_df_B,lsat_mod_df_C,lsat_mod_df_D])\nprint(f'Original # matchups at Cosgrove: {lsat_mod_df_C.shape[0]}, at Dotson: {lsat_mod_df_D.shape[0]}, at Burke: {lsat_mod_df_B.shape[0]}')","visibility":"show","key":"WTjHmePT4A"},{"type":"output","id":"wslAP81-_fRyr4oT1K2a7","data":[],"visibility":"show","key":"AeFItms17g"}],"visibility":"show","key":"HKlIMKwHzF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# sum_n = lsat_mod_df_n[lsat_mod_df_n.DateTime.dt.month.isin([9,10,11,12,1,3])]\n# shld_n = lsat_mod_df_n[lsat_mod_df_n.DateTime.dt.month.isin([2])]\n# sum_c = lsat_mod_df_C[lsat_mod_df_C.DateTime.dt.month.isin([9,10,11,12,1,3])]\n# sum_bc = lsat_mod_df_bc[lsat_mod_df_bc.DateTime.dt.month.isin([9,10,11,12,1,3])]\n# shld_bc = lsat_mod_df_bc[lsat_mod_df_bc.DateTime.dt.month.isin([2])]\n# sum_bd = lsat_mod_df_bd[lsat_mod_df_bd.DateTime.dt.month.isin([9,10,11,12,1,3])]\n# shld_bd = lsat_mod_df_bd[lsat_mod_df_bd.DateTime.dt.month.isin([2])]\n# sum_cd = lsat_mod_df_cd[lsat_mod_df_cd.DateTime.dt.month.isin([9,10,11,12,1,3])]\n# shld_cd = lsat_mod_df_cd[lsat_mod_df_cd.DateTime.dt.month.isin([2])]","key":"BKrkI4E2f7"},{"type":"output","id":"dv3OU7RyL72RHMxSwW10T","data":[],"key":"V6Cu4uviSh"}],"key":"xOH2DVO7Dv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# # ***check all the february images to see if we need to add a threshold of 2.0C or cut images or if the issue is clouds???\n# # shld\n# look = lsat_mod_df_n.sort_values('L8_filename')\n# look.head(20)","key":"hqty68BAOD"},{"type":"output","id":"L58GfNiGU1mq4Vuu27hGu","data":[],"key":"o2kGyDe91k"}],"key":"F0uAzb1Kob"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Orthoganal Regression \nif surf_temp=='LST':\n    data0 = lsat_mod_df_n\n    landsat_uncertainty = lst_uncertainty\nelse:\n    data0 = lsat_mod_df_n\n    landsat_uncertainty = sst_uncertainty\n\n# Original data\nx_original = np.array(data0[f'L8_{surf_temp}'])\ny_original = np.array(data0['MODIS_SST'])\n\n# Assume these are your uncertainty estimates per observation\nsy = np.full_like(y_original, modis_uncertainty * pix_uncertainty)  # Adjusted for resolution mismatch\nsx = np.full_like(x_original, landsat_uncertainty)\n\n# Define a linear function for the model\ndef linear_model(p, x):\n    return p[0] * x + p[1]\n\n# Create a Model\nlinear = Model(linear_model)\n\n# Create a RealData object using your DataFrame\ndata = RealData(x_original, y_original,sx=sx, sy=sy)\n\n# Set up ODR with the model and data\nodr = ODR(data, linear, beta0=[1., 0.])\n\n# Run the regression\nout = odr.run()\n\n# Use the output\nbeta = out.beta\nbeta_err = out.sd_beta\n\n# Print the summary\nout.pprint()\n\n# Predicting values using the ODR model\ny_pred = linear_model(beta, x_original)\n\n# Get R2\n# Calculate Total Sum of Squares (SST)\ny_mean = np.mean(y_original)\nSST = np.sum((y_original - y_mean)**2)\n\n# Calculate Residual Sum of Squares (SSR)\nSSR = np.sum((y_original - y_pred)**2)\n\n# Compute RMSE\nrmse = np.sqrt(((y_original - y_pred) ** 2).mean())\n\n# Calculate R^2\nR2 = 1 - (SSR / SST)\nprint(\"R^2:\", np.around(R2,2))\nprint(f\"RMSE: {np.around(rmse,2)}\")","key":"NN090EJukY"},{"type":"output","id":"xhkmoFNXL0DEZrqzl9Xmx","data":[],"key":"honTtLsuDV"}],"key":"vi8uaLWaNk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"if surf_temp=='LST':\n    # Plot regression\n    beta_mdn = [beta[0]-beta_err[0]*1.96,beta[1]-beta_err[1]*1.96]\n    beta_mup = [beta[0]+beta_err[0]*1.96,beta[1]-beta_err[1]*1.96]\n    beta_bdn = [beta[0]-beta_err[0]*1.96,beta[1]+beta_err[1]*1.96]\n    beta_bup = [beta[0]+beta_err[0]*1.96,beta[1]+beta_err[1]*1.96]\n    print(f'At 95% confidence interval: {np.around(beta[0],2)}+/-{np.around(beta_err[0]*1.96,2)}, {np.around(beta[1],2)}+/-{np.around(beta_err[1]*1.96,2)}, n={y_pred.shape[0]}')\n    xfill = np.array([-4.5,1.5])\n    \n    fig, ax = plt.subplots(figsize=(8, 3.5))\n    ax.tick_params(labelsize=14)\n    \n    # LST data and regression\n    plt.scatter(x_original, y_original, s=12,color='mediumslateblue')\n    plt.plot(x_original, y_pred, color='mediumslateblue', label='LST ODR')\n    plt.fill_between(xfill, linear_model(beta_bdn, xfill), linear_model(beta_mup, xfill),alpha=0.3, facecolor='0.3')\n    \n    # Comparison regressions\n    xi = np.arange(-7.0,5.0,1.0)\n    plt.plot(xi,xi * sstcalib_m + sstcalib_b,color='k',linewidth=2,label='SST ODR')\n    plt.plot(xi,xi,color='lightcoral',linewidth=2, label='MODIS 1:1')\n        \n    plt.legend(loc='lower right',fontsize=14)\n    plt.text(-2.7,-0.15,rf'$\\mathbf{{y={np.around(beta[0],2)}x+{np.around(beta[1],2)}\\quad r^2={np.around(R2,2)}}}$',color='mediumslateblue', fontweight='bold',fontsize=14)\n    plt.xlim([-3.5,-1.2])\n    plt.ylim([-3.05,0.8])\n    # else: \n    #     plt.plot(x_original, y_pred, color='k', label='NLSST Orthogonal Distance Regression')\n    #     plt.legend(loc='lower right',fontsize=12)\n    #     plt.text(-2.6,-0.2,f'y={np.around(beta[0],2)}x+{np.around(beta[1],2)}   $r^2$={np.around(R2,2)}',fontsize=14)\n    #     plt.xlim([-3.2,-0.15])\n    #     plt.ylim([-2.4,0.9]) \n    plt.xlabel('Landsat ST [Â°C]',fontsize=16)\n    plt.ylabel('MODIS SST [Â°C]',fontsize=16)\n    plt.tight_layout()","key":"fXo5FihGGG"},{"type":"output","id":"x7TaJL2bfYpZpbZPwpFSw","data":[],"key":"P7Sl2lZLYf"}],"key":"Y64ixGZf8N"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Orthoganal Regression for SST only\ndataframes = [\n    ('Combined', lsat_mod_df_n),\n    ('Burke', lsat_mod_df_B),\n    ('Cosgrove', lsat_mod_df_C),\n    ('Dotson', lsat_mod_df_D),\n]\n\nif surf_temp=='LST':\n    landsat_uncertainty = lst_uncertainty\nelse:\n    landsat_uncertainty = sst_uncertainty\n\n# Dictionary to store the results from each DataFrame\nodr_results = {}\n\n# Define a linear function for the model\ndef linear_model(p, x):\n    return p[0] * x + p[1]\n\n# Create a Model object\nlinear = Model(linear_model)\n\n# Loop over each DataFrame\nfor df_name, data0 in dataframes:\n    print(f\"\\n=== Processing {df_name} ===\")\n    \n    # Original data\n    x_original = np.array(data0[f'L8_{surf_temp}'])\n    y_original = np.array(data0['MODIS_SST'])\n\n    # Assume these are your uncertainty estimates per observation\n    sy = np.full_like(y_original, modis_uncertainty * pix_uncertainty)  # Adjusted for resolution mismatch\n    sx = np.full_like(x_original, landsat_uncertainty)\n    \n    # Create a RealData object using your DataFrame\n    data = RealData(x_original, y_original,sx=sx, sy=sy)\n    \n    # Set up ODR with the model and data, providing an initial guess\n    odr = ODR(data, linear, beta0=[1., 0.])\n    \n    # Run the regression\n    out = odr.run()\n    \n    # Retrieve best-fit parameters and their std. dev.\n    beta = out.beta\n    beta_err = out.sd_beta\n    \n    # Print the summary\n    out.pprint()\n    \n    # Predicting values using the ODR model\n    y_pred = linear_model(beta, x_original)\n    \n    # Get R2\n    # Calculate Total Sum of Squares (SST)\n    y_mean = np.mean(y_original)\n    SST = np.sum((y_original - y_mean)**2)\n    \n    # Calculate Residual Sum of Squares (SSR)\n    SSR = np.sum((y_original - y_pred)**2)\n    \n    # Calculate R^2\n    R2 = 1 - (SSR / SST)\n\n    # Compute RMSE\n    rmse = np.sqrt(((y_original - y_pred) ** 2).mean())\n    \n    # Print R^2\n    print(f\"{df_name} R^2:\", np.around(R2, 2))\n    print(f\"RMSE: {np.around(rmse,2)}\")\n    \n    # Store results in a dictionary for later use (plotting, etc.)\n    odr_results[df_name] = {\n        'beta': beta,\n        'beta_err': beta_err,\n        'R2': R2,\n        'x_original': x_original,\n        'y_original': y_original,\n        'y_pred': y_pred\n    }","key":"tt5WldCgJ2"},{"type":"output","id":"AZenFNZs8a9j-pWVMomX3","data":[],"key":"V6hkeAlh8P"}],"key":"uJBaradNWA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"if surf_temp=='SST':\n    # Plot with all points and by region (Burke=r, Cosgrove=b, Dotson=g) - show with lsat_mod_df_n calculations for the line\n    beta_mdn = [odr_results['Combined']['beta'][0]-odr_results['Combined']['beta_err'][0]*1.96,odr_results['Combined']['beta'][1]-odr_results['Combined']['beta_err'][1]*1.96]\n    beta_mup = [odr_results['Combined']['beta'][0]+odr_results['Combined']['beta_err'][0]*1.96,odr_results['Combined']['beta'][1]-odr_results['Combined']['beta_err'][1]*1.96]\n    beta_bdn = [odr_results['Combined']['beta'][0]-odr_results['Combined']['beta_err'][0]*1.96,odr_results['Combined']['beta'][1]+odr_results['Combined']['beta_err'][1]*1.96]\n    beta_bup = [odr_results['Combined']['beta'][0]+odr_results['Combined']['beta_err'][0]*1.96,odr_results['Combined']['beta'][1]+odr_results['Combined']['beta_err'][1]*1.96]\n    a1 = np.around(odr_results['Combined']['beta'][0],2)\n    a1e = np.around(odr_results['Combined']['beta_err'][0]*1.96,2)\n    a2 = np.around(odr_results['Combined']['beta'][1],2)\n    a2e = np.around(odr_results['Combined']['beta_err'][1]*1.96,2)\n    nn = odr_results['Combined']['y_pred'].shape[0]\n    ar = np.around(odr_results['Combined']['R2'],2)\n    b1 = np.around(odr_results['Burke']['beta'][0],2)\n    b2 = np.around(odr_results['Burke']['beta'][1],2)\n    br = np.around(odr_results['Burke']['R2'],2)\n    c1 = np.around(odr_results['Cosgrove']['beta'][0],2)\n    c2 = np.around(odr_results['Cosgrove']['beta'][1],2)\n    cr = np.around(odr_results['Cosgrove']['R2'],2)\n    d1 = np.around(odr_results['Dotson']['beta'][0],2)\n    d2 = np.around(odr_results['Dotson']['beta'][1],2)\n    dr = np.around(odr_results['Dotson']['R2'],2)\n    print(f'At 95% confidence interval: {a1}+/-{a1e}, {a2}+/-{a2e}, n={nn}')\n    xfill = np.array([-4.3,0.9])\n    \n    \n    fig, ax = plt.subplots(figsize=(8, 3))\n    ax.tick_params(labelsize=14)\n    \n    plt.scatter(np.array(lsat_mod_df_B[f'L8_{surf_temp}']), np.array(lsat_mod_df_B['MODIS_SST']), s=12,color='#00bf7d', label='Burke')\n    plt.scatter(np.array(lsat_mod_df_C[f'L8_{surf_temp}']), np.array(lsat_mod_df_C['MODIS_SST']), s=12,color=sns.color_palette(\"colorblind\")[3], label='Cosgrove')\n    plt.scatter(np.array(lsat_mod_df_D[f'L8_{surf_temp}']), np.array(lsat_mod_df_D['MODIS_SST']), s=12,color='#0073e6', label='Dotson')\n    \n    plt.plot(odr_results['Combined']['x_original'], odr_results['Combined']['y_pred'], color='k')\n    plt.fill_between(xfill, linear_model(beta_bdn, xfill), linear_model(beta_mup, xfill),alpha=0.3, facecolor='0.3')\n    plt.plot(odr_results['Burke']['x_original'], odr_results['Burke']['y_pred'], ls='-',linewidth=1,color='#00bf7d')\n    plt.plot(odr_results['Cosgrove']['x_original'], odr_results['Cosgrove']['y_pred'], ls='-',linewidth=1,color=sns.color_palette(\"colorblind\")[3])\n    plt.plot(odr_results['Dotson']['x_original'], odr_results['Dotson']['y_pred'], ls='-',linewidth=1,color='#0073e6')\n    \n    if surf_temp=='LST':\n        plt.text(-2.25,-0.2,f'y={a1}x+{a2}   $r^2$={ar}',color='#00bf7d',fontsize=14)\n        plt.text(-2.25,-0.2,f'y={c1}x+{c2}   $r^2$={cr}',color=sns.color_palette(\"colorblind\")[3],fontsize=12)\n        plt.text(-2.25,-0.2,f'y={d1}x+{d2}   $r^2$={dr}',color='#0073e6',fontsize=12)\n        plt.xlim([-2.5,-1.4])\n        plt.ylim([-2.05,0.0])\n    else: \n        plt.text(-2.9,0.3,f'y={a1}x+{a2}   $r^2$={ar}',color='k',fontsize=14)\n        plt.text(-2.9,0.0,f'y={b1}x+{b2}   $r^2$={br}',color='#00bf7d',fontsize=12)\n        plt.text(-2.9,-0.3,f'y={c1}x+{c2}   $r^2$={cr}',color=sns.color_palette(\"colorblind\")[3],fontsize=12)\n        plt.text(-2.9,-0.6,f'y={d1}x+{d2}   $r^2$={dr}',color='#0073e6',fontsize=12)\n        plt.xlim([-3.05,-0.15])\n        plt.ylim([-2.3,0.9])\n    plt.xlabel('Landsat SST [Â°C]',fontsize=16)\n    plt.ylabel('MODIS SST [Â°C]',fontsize=16)\n    plt.legend(loc='lower right',fontsize=10)\n    plt.tight_layout()","key":"Yxt1NpT1SG"},{"type":"output","id":"alKoNBrcB-Hg5uwGgcpuw","data":[],"key":"d3OeCGGxgT"}],"key":"o2zLmqm0uM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"odr_results['Combined']['beta_err']","key":"bN8RgFvy4f"},{"type":"output","id":"7goCtiEvouJ6BVxqyvlzu","data":[],"key":"Kk4KQvnb8M"}],"key":"yC4zOXDgeK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"if surf_temp=='SST':\n    # Ordinary least squares regression between Landsat and MODIS SST matchups\n    resultC = sm.ols(formula=\"MODIS_SST ~ L8_SST\", data=data0).fit()\n    print (resultC.summary())","key":"DJ07e3Fjhb"},{"type":"output","id":"BrvK-rU9bBL2JWjoSbKnj","data":[],"key":"D05Ghdn4P0"}],"key":"J4qRQgH10A"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Interactive Analysis Dashboard using Plotly","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yQTqCt9sWF"}],"identifier":"interactive-analysis-dashboard-using-plotly","label":"Interactive Analysis Dashboard using Plotly","html_id":"interactive-analysis-dashboard-using-plotly","implicit":true,"key":"bcF8LVXMwA"}],"key":"qW9QIjwJya"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Imports for Interactive Dashboard\nimport ipywidgets as widgets\nfrom ipywidgets import interact, Layout\nimport plotly.express as px\nimport plotly.graph_objects as go","key":"U9HzYP6c0F"},{"type":"output","id":"bW_wYEbcL9YHw75_JcbDS","data":[],"key":"N08H3x7TJC"}],"key":"KBvAQTKlOD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Interactive Dashboard Function\n\ndef linear_model(p, x):\n    return p[0] * x + p[1]\n\ndef interactive_calibration_dashboard(region, chart_type, pix_thresh, modis_sst_thresh, lsat_sst_thresh):\n    # 1. Filter each dataframe individually based on widget values\n    df_C_filt = lsat_mod_df_C[(lsat_mod_df_C['MODIS_pix'] \u003e= pix_thresh) \u0026\n                              (lsat_mod_df_C['MODIS_SST'] \u003e= modis_sst_thresh) \u0026\n                              (lsat_mod_df_C[f'L8_{surf_temp}'] \u003e= lsat_sst_thresh)]\n    \n    df_D_filt = lsat_mod_df_D[(lsat_mod_df_D['MODIS_pix'] \u003e= pix_thresh) \u0026\n                              (lsat_mod_df_D['MODIS_SST'] \u003e= modis_sst_thresh) \u0026\n                              (lsat_mod_df_D[f'L8_{surf_temp}'] \u003e= lsat_sst_thresh)]\n\n    df_B_filt = lsat_mod_df_B[(lsat_mod_df_B['MODIS_pix'] \u003e= pix_thresh) \u0026\n                              (lsat_mod_df_B['MODIS_SST'] \u003e= modis_sst_thresh) \u0026\n                              (lsat_mod_df_B[f'L8_{surf_temp}'] \u003e= lsat_sst_thresh)]\n\n    # 2. Select data based on dropdown menu\n    if region == 'All Regions':\n        df_filtered = pd.concat([df_B_filt, df_C_filt, df_D_filt])\n    elif region == 'Cosgrove':\n        df_filtered = df_C_filt\n    elif region == 'Dotson':\n        df_filtered = df_D_filt\n    elif region == 'Burke':\n        df_filtered = df_B_filt\n    \n    if len(df_filtered) \u003c 2:\n        # Create an empty plot with a message\n        fig = go.Figure()\n        fig.update_layout(title_text=\"Not enough data with the current filter settings.\", \n                          xaxis={'visible': False}, yaxis={'visible': False})\n        fig.show()\n        return\n    \n    # 3. Perform Orthogonal Distance Regression (ODR)\n    x_data = df_filtered[f'L8_{surf_temp}'].values\n    y_data = df_filtered['MODIS_SST'].values\n    \n    sx = np.full_like(x_data, sst_uncertainty)\n    sy = np.full_like(y_data, modis_uncertainty * pix_uncertainty)\n\n    model = Model(linear_model)\n    data = RealData(x_data, y_data, sx=sx, sy=sy)\n    odr = ODR(data, model, beta0=[1., 0.])\n    output = odr.run()\n    \n    slope, intercept = output.beta\n    y_pred = linear_model(output.beta, x_data)\n    \n    # 4. Calculate statistics including bias and trend\n    bias = np.mean(y_data - x_data)\n    trend = slope\n    ss_total = np.sum((y_data - np.mean(y_data))**2)\n    ss_resid = np.sum((y_data - y_pred)**2)\n    r2 = 1 - (ss_resid / ss_total) if ss_total \u003e 0 else 0\n    rmse = np.sqrt(np.mean((y_data - y_pred)**2))\n    stats_text = (f\"\u003cb\u003eTrend (Slope):\u003c/b\u003e {trend:.2f} | \u003cb\u003eBias (MODIS - Landsat):\u003c/b\u003e {bias:.2f}Â°C\u003cbr\u003e\"\n                  f\"\u003cb\u003eRÂ²:\u003c/b\u003e {r2:.2f} | \u003cb\u003eRMSE:\u003c/b\u003e {rmse:.2f} | \u003cb\u003eN:\u003c/b\u003e {len(df_filtered)}\")\n\n    # 5. Create Plotly figure based on chart_type\n    if chart_type == 'Scatter':\n        fig = px.scatter(df_filtered, x=f'L8_{surf_temp}', y='MODIS_SST', \n                         color='Region', hover_data=['L8_filename', 'DateTime'])\n    elif chart_type == 'Heatmap':\n        fig = go.Figure(go.Histogram2d(\n            x=df_filtered[f'L8_{surf_temp}'],\n            y=df_filtered['MODIS_SST'],\n            colorscale='Viridis'\n        ))\n    \n    # Add regression line to both plot types\n    sorted_indices = np.argsort(x_data)\n    fig.add_trace(go.Scatter(x=x_data[sorted_indices], y=y_pred[sorted_indices], \n                           mode='lines', name='ODR Fit', line=dict(color='black', width=2)))\n\n    fig.update_layout(\n        title_text=stats_text,\n        xaxis_title=\"Landsat SST [Â°C]\",\n        yaxis_title=\"MODIS SST [Â°C]\",\n        xaxis_range=[-3.05, -0.15],\n        yaxis_range=[-2.3, 0.9],\n        legend_title=\"Region\"\n    )\n    \n    fig.show()\n\n# Define Widgets\nstyle = {'description_width': 'initial'}\nw_region = widgets.Dropdown(options=['All Regions', 'Cosgrove', 'Dotson', 'Burke'], value='All Regions', description='Select Region:', style=style)\nw_chart_type = widgets.ToggleButtons(options=['Scatter', 'Heatmap'], description='Chart Type:', button_style='info')\nw_pix_thresh = widgets.IntSlider(value=1300, min=0, max=5000, step=100, description='Min MODIS Pixels:', style=style, layout=Layout(width='500px'))\nw_modis_sst = widgets.FloatSlider(value=-1.9, min=-2.5, max=0, step=0.1, description='Min MODIS SST (Â°C):', style=style, layout=Layout(width='500px'))\nw_lsat_sst = widgets.FloatSlider(value=-3.1, min=-4.0, max=0, step=0.1, description='Min Landsat SST (Â°C):', style=style, layout=Layout(width='500px'))\n\n# Launch the Dashboard\ninteract(interactive_calibration_dashboard, \n         region=w_region, \n         chart_type=w_chart_type,\n         pix_thresh=w_pix_thresh, \n         modis_sst_thresh=w_modis_sst, \n         lsat_sst_thresh=w_lsat_sst);","key":"gTlqha1Opp"},{"type":"output","id":"QNN69Z7MIOAsu4Hc3nYkR","data":[],"key":"cNSQXz7cEd"}],"key":"SQ0TBtCO36"}],"key":"rNEzM2Rwap"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"How to Cite This Cookbook","url":"/notebooks/how-to-cite","group":"Preamble"},"next":{"title":"Validation","url":"/notebooks/validation","group":"Preamble"}}},"domain":"http://localhost:3000"},"project":{"open_access":true,"license":{"content":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"title":"Raw Pixels to Products","authors":[{"nameParsed":{"literal":"Tasha Snow","given":"Tasha","family":"Snow"},"name":"Tasha Snow","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Kathryn Moore","given":"Kathryn","family":"Moore"},"name":"Kathryn Moore","id":"contributors-myst-generated-uid-1"},{"nameParsed":{"literal":"Genevieve Clow","given":"Genevieve","family":"Clow"},"name":"Genevieve Clow","id":"contributors-myst-generated-uid-2"},{"nameParsed":{"literal":"Jianwen Du","given":"Jianwen","family":"Du"},"name":"Jianwen Du","id":"contributors-myst-generated-uid-3"},{"nameParsed":{"literal":"Arman Oliazneeh","given":"Arman","family":"Oliazneeh"},"name":"Arman Oliazneeh","id":"contributors-myst-generated-uid-4"}],"contributors":[{"id":"brian-rose","nameParsed":{"literal":"Brian E. J. Rose","given":"Brian E. J.","family":"Rose"},"name":"Brian E. J. Rose","orcid":"0000-0002-9961-3821","email":"brose@albany.edu","affiliations":["UAlbany"],"url":"https://brian-rose.github.io","github":"brian-rose","bluesky":"@brianejrose.bsky.social","linkedin":"https://www.linkedin.com/in/brian-rose-37bb55106/"},{"id":"clyne","nameParsed":{"literal":"John Clyne","given":"John","family":"Clyne"},"name":"John Clyne","orcid":"0000-0003-2788-9017","affiliations":["CISL"],"github":"clyne"},{"id":"jukent","nameParsed":{"literal":"Julia Kent","given":"Julia","family":"Kent"},"name":"Julia Kent","orcid":"0000-0002-5611-8986","affiliations":["CISL"],"github":"jukent"},{"id":"ktyle","nameParsed":{"literal":"Kevin Tyle","given":"Kevin","family":"Tyle"},"name":"Kevin Tyle","orcid":"0000-0001-5249-9665","affiliations":["UAlbany"],"github":"ktyle"},{"id":"andersy005","nameParsed":{"literal":"Anderson Banihirwe","given":"Anderson","family":"Banihirwe"},"name":"Anderson Banihirwe","orcid":"0000-0001-6583-571X","affiliations":["CarbonPlan"],"github":"andersy005"},{"id":"dcamron","nameParsed":{"literal":"Drew Camron","given":"Drew","family":"Camron"},"name":"Drew Camron","orcid":"0000-0001-7246-6502","affiliations":["Unidata"],"github":"dcamron"},{"id":"dopplershift","nameParsed":{"literal":"Ryan May","given":"Ryan","family":"May"},"name":"Ryan May","orcid":"0000-0003-2907-038X","affiliations":["Unidata"],"github":"dopplershift"},{"id":"mgrover1","nameParsed":{"literal":"Maxwell Grover","given":"Maxwell","family":"Grover"},"name":"Maxwell Grover","orcid":"0000-0002-0370-8974","affiliations":["Argonne"],"github":"mgrover1"},{"id":"r-ford","nameParsed":{"literal":"Robert R. Ford","given":"Robert R.","family":"Ford"},"name":"Robert R. Ford","orcid":"0000-0001-5483-4965","affiliations":["UAlbany"],"github":"r-ford"},{"id":"kmpaul","nameParsed":{"literal":"Kevin Paul","given":"Kevin","family":"Paul"},"name":"Kevin Paul","orcid":"0000-0001-8155-8038","affiliations":["NVIDIA"],"github":"kmpaul"},{"id":"jnmorley","nameParsed":{"literal":"James Morley","given":"James","family":"Morley"},"name":"James Morley","orcid":"0009-0005-5193-7981","github":"jnmorley"},{"id":"erogluorhan","nameParsed":{"literal":"Orhan Eroglu","given":"Orhan","family":"Eroglu"},"name":"Orhan Eroglu","orcid":"0000-0003-3099-8775","affiliations":["CISL"],"github":"erogluorhan"},{"id":"lkailynncar","nameParsed":{"literal":"Lily Kailyn","given":"Lily","family":"Kailyn"},"name":"Lily Kailyn","orcid":"0009-0002-0125-5091","affiliations":["CISL"],"github":"lkailynncar"},{"id":"anissa111","nameParsed":{"literal":"Anissa Zacharias","given":"Anissa","family":"Zacharias"},"name":"Anissa Zacharias","orcid":"0000-0002-2666-8493","affiliations":["CISL"],"github":"anissa111"},{"id":"kafitzgerald","nameParsed":{"literal":"Katelyn FitzGerald","given":"Katelyn","family":"FitzGerald"},"name":"Katelyn FitzGerald","orcid":"0000-0003-4184-1917","affiliations":["CISL"],"github":"kafitzgerald"}],"github":"https://github.com/projectpythia/landsatproduct-cookbook","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"copyright":"2025","references":{"foundations":{"url":"https://foundations.projectpythia.org"},"xarray":{"url":"https://docs.xarray.dev/en/stable"},"matplotlib":{"url":"https://matplotlib.org/stable"}},"thebe":{"binder":{"url":"https://mybinder.org/","provider":"github","repo":"projectpythia/cookbook-template","ref":"HEAD"}},"toc":[{"file":"README.md"},{"children":[{"file":"notebooks/how-to-cite.md"}],"title":"Preamble"},{"file":"notebooks/calibration_note.ipynb"},{"file":"notebooks/validation.ipynb"}],"thumbnail":"/landsatproduct-cookbook/build/thumbnail-1c010466148cdb9282b43e9e92cbe804.png","exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"Preamble"},{"slug":"notebooks.how-to-cite","title":"How to Cite This Cookbook","description":"","date":"","thumbnail":"/landsatproduct-cookbook/build/72a08caa5cbe5f9cce5999dbd1a81dfd.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.calibration-note","title":"Calibrate a physical model","description":"","date":"2025-08-07","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"notebooks.validation","title":"Validation","description":"","date":"","thumbnail":"/landsatproduct-cookbook/build/7f5ce2075ca8bde52118602eb0344051.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/landsatproduct-cookbook/build/manifest-B2B2E6A5.js";
import * as route0 from "/landsatproduct-cookbook/build/root-IB5726YR.js";
import * as route1 from "/landsatproduct-cookbook/build/routes/$-LXLHKVOR.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/landsatproduct-cookbook/build/entry.client-UNPC4GT3.js");</script></body></html>