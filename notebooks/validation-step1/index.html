<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Validating your data product - Raw Pixels to Products</title><meta property="og:title" content="Validating your data product - Raw Pixels to Products"/><meta name="generator" content="mystmd"/><meta name="keywords" content=""/><meta name="image" content="/landsatproduct-cookbook/build/cookbook_schem_genev-ef1ec07afdd1ca226f8ed87944bfef8a.png"/><meta property="og:image" content="/landsatproduct-cookbook/build/cookbook_schem_genev-ef1ec07afdd1ca226f8ed87944bfef8a.png"/><link rel="stylesheet" href="/landsatproduct-cookbook/build/_assets/app-5WKS5EPQ.css"/><link rel="stylesheet" href="/landsatproduct-cookbook/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-T52X8HNYE8"></script><script>window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-T52X8HNYE8');</script><link rel="icon" href="/landsatproduct-cookbook/favicon.ico"/><link rel="stylesheet" href="/landsatproduct-cookbook/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="block px-2 py-1 text-black underline">Skip to article content</a></div><div class="bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-screen top-0 z-30 h-[60px]"><nav class="flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="flex items-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="m-1"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="https://projectpythia.org"><div class="p-1 mr-3"><img src="/landsatproduct-cookbook/build/config-item-24692dda-9b1a51be2ae3a53260985b36368ad409.svg" class="h-9 dark:hidden" height="2.25rem"/><img src="/landsatproduct-cookbook/build/config-item-84d6d338-309dcf57210f339d5431e4d63b7c9f82.svg" class="hidden h-9 dark:block" height="2.25rem"/></div><span class="text-md sm:text-xl tracking-tight sm:mr-5 sr-only">Made with MyST</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"><div class="relative inline-block mx-2 grow-0"><a href="https://projectpythia.org" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75">Home</a></div><div class="relative inline-block mx-2 grow-0"><a href="https://foundations.projectpythia.org" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75">Foundations</a></div><div class="relative inline-block mx-2 grow-0"><a href="https://cookbooks.projectpythia.org/" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75">Cookbooks</a></div><div class="relative inline-block mx-2 grow-0"><a href="https://projectpythia.org/resource-gallery/" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75">Resources</a></div><div class="relative inline-block mx-2 grow-0"><a href="https://projectpythia.org/#join-us" target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center w-full mx-2 py-1 text-md font-medium dark:text-white focus:outline-none focus-visible:ring-2 focus-visible:ring-white focus-visible:ring-opacity-75">Community</a></div></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R74op:" data-state="closed" class="flex items-center h-10 aspect-square sm:w-64 text-left text-gray-400 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="hidden sm:block grow">Search</span><div aria-hidden="true" class="items-center hidden mx-1 font-mono text-sm text-gray-400 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-8 h-8 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"><div class="relative" data-headlessui-state=""><div><button class="flex text-sm bg-transparent rounded-full focus:outline-none" id="headlessui-menu-button-:Rr4op:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Open Menu</span><div class="flex items-center text-stone-200 hover:text-white"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="p-1"><path fill-rule="evenodd" d="M10.5 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Zm0 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Zm0 6a1.5 1.5 0 1 1 3 0 1.5 1.5 0 0 1-3 0Z" clip-rule="evenodd"></path></svg></div></button></div></div></div><div class="hidden sm:block"><a href="https://projectpythia.org" target="_blank" rel="noopener noreferrer" class="inline-block px-4 py-2 mx-1 mt-0 leading-none border rounded text-md border-stone-700 dark:border-white text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 hover:bg-neutral-100">Project Pythia</a></div></div></nav></div><div class="fixed xl:article-grid grid-gap xl:w-screen xl:pointer-events-none overflow-auto max-xl:min-w-[300px] hidden z-10" style="top:60px"><div class="pointer-events-auto xl:col-margin-left flex-col overflow-hidden hidden xl:flex"><div class="flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px] lg:hidden"><div class="w-full px-1 dark:text-white font-medium"><a href="https://projectpythia.org" target="_blank" rel="noopener noreferrer" class="p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded">Home</a><a href="https://foundations.projectpythia.org" target="_blank" rel="noopener noreferrer" class="p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded">Foundations</a><a href="https://cookbooks.projectpythia.org/" target="_blank" rel="noopener noreferrer" class="p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded">Cookbooks</a><a href="https://projectpythia.org/resource-gallery/" target="_blank" rel="noopener noreferrer" class="p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded">Resources</a><a href="https://projectpythia.org/#join-us" target="_blank" rel="noopener noreferrer" class="p-2 my-1 rounded-lg hover:bg-slate-300/30 block break-words focus:outline outline-blue-200 outline-2 rounded">Community</a></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white"><a title="Raw Pixels to Products" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/landsatproduct-cookbook/">Raw Pixels to Products</a><div data-state="closed" class="w-full"><div class="flex flex-row w-full gap-2 px-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Preamble" class="block break-words rounded py-2 grow cursor-pointer">Preamble</div><button class="self-center flex-none rounded-md group hover:bg-slate-300/30 focus:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rmp8p:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rmp8p:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><a title="Preprocessing data" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/landsatproduct-cookbook/notebooks/preprocessing">Preprocessing data</a><a title="Calibration" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/landsatproduct-cookbook/notebooks/calibration">Calibration</a><a title="Validating your data product" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/landsatproduct-cookbook/notebooks/validation-step1">Validating your data product</a><a title="Validation" class="block break-words focus:outline outline-blue-200 outline-2 rounded p-2 my-1 rounded-lg hover:bg-slate-300/30" href="/landsatproduct-cookbook/notebooks/validation-p2">Validation</a></div></nav></div><div class="flex-none py-6 transition-all duration-700 translate-y-6 opacity-0"><a class="flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><article class="article content article-grid grid-gap"><main class="article-grid subgrid-gap col-screen"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="mb-8 pt-9"><div class="flex items-center h-6 mb-5 text-sm font-light"><div class="flex-grow"></div><a href="https://opensource.org/licenses/Apache-2.0" target="_blank" rel="noopener noreferrer" title="Content License: Apache License 2.0 (Apache-2.0)" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="mx-1 inline-block opacity-60 hover:opacity-100 hover:text-[#599F46]"><path d="M13.2 15.6c1.4-.5 2.1-1.6 2.1-3.3S13.8 8.9 12 8.9c-1.9 0-3.3 1.6-3.3 3.3 0 1.8.8 3 2.2 3.4l-2.3 5.9c-3.1-.8-6.3-4.6-6.3-9.3 0-5.5 4.3-10 9.7-10s9.8 4.5 9.8 10c0 4.7-3.1 8.5-6.3 9.3l-2.3-5.9z"></path></svg></a><a href="https://en.wikipedia.org/wiki/Open_access" target="_blank" rel="noopener noreferrer" title="Open Access" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="mr-1 inline-block opacity-60 hover:opacity-100 hover:text-[#E18435]"><path d="M17.1 12.6h-2V7.5c0-1.7-1.4-3.1-3-3.1-.8 0-1.6.3-2.2.9-.6.5-.9 1.3-.9 2.2v.7H7v-.7c0-1.4.5-2.7 1.5-3.7s2.2-1.5 3.6-1.5 2.6.5 3.6 1.5 1.5 2.3 1.5 3.7v5.1z"></path><path d="M12 21.8c-.8 0-1.6-.2-2.3-.5-.7-.3-1.4-.8-1.9-1.3-.6-.6-1-1.2-1.3-2-.3-.8-.5-1.6-.5-2.4s.2-1.6.5-2.4c.3-.7.7-1.4 1.3-2s1.2-1 1.9-1.3c.7-.3 1.5-.5 2.3-.5.8 0 1.6.2 2.3.5.7.3 1.4.8 1.9 1.3.6.6 1 1.2 1.3 2 .3.8.5 1.6.5 2.4s-.2 1.6-.5 2.4c-.3.7-.7 1.4-1.3 2-.6.6-1.2 1-1.9 1.3-.7.3-1.5.5-2.3.5zm0-10.3c-2.2 0-4 1.8-4 4.1s1.8 4.1 4 4.1 4-1.8 4-4.1-1.8-4.1-4-4.1z"></path><circle cx="12" cy="15.6" r="1.7"></circle></svg></a><a href="https://github.com/projectpythia/landsatproduct-cookbook" title="GitHub Repository: projectpythia/landsatproduct-cookbook" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a><div class="inline-block mr-1"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="inline-block"><title>Jupyter Notebook</title><path d="M20.2 1.7c0 .8-.5 1.4-1.3 1.5-.8 0-1.4-.5-1.5-1.3 0-.8.5-1.4 1.3-1.5.8-.1 1.5.5 1.5 1.3zM12 17.9c-3.7 0-7-1.3-8.7-3.3 1.8 4.8 7.1 7.3 11.9 5.5 2.5-.9 4.5-2.9 5.5-5.5-1.7 2-4.9 3.3-8.7 3.3zM12 5.1c3.7 0 7 1.3 8.7 3.3-1.8-4.8-7.1-7.3-11.9-5.5-2.5.9-4.5 2.9-5.5 5.5 1.7-2 5-3.3 8.7-3.3zM6.9 21.8c.1 1-.7 1.8-1.7 1.9-1 .1-1.8-.7-1.9-1.7 0-1 .7-1.8 1.7-1.9 1-.1 1.8.7 1.9 1.7zM3.7 4.6c-.6 0-1-.4-1-1s.4-1 1-1 1 .4 1 1c0 .5-.4 1-1 1z"></path></svg></div><a href="https://github.com/projectpythia/landsatproduct-cookbook/blob/main/notebooks/validation_step1.ipynb" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8top:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div><button class="inline-flex size-[24px] hover:text-[#E18435] items-center justify-center" aria-label="Launch in external computing interface" title="Launch in external computing interface" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:Re8top:" data-state="closed"><svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6.85357 3.85355L7.65355 3.05353C8.2981 2.40901 9.42858 1.96172 10.552 1.80125C11.1056 1.72217 11.6291 1.71725 12.0564 1.78124C12.4987 1.84748 12.7698 1.97696 12.8965 2.10357C13.0231 2.23018 13.1526 2.50125 13.2188 2.94357C13.2828 3.37086 13.2779 3.89439 13.1988 4.44801C13.0383 5.57139 12.591 6.70188 11.9464 7.34645L7.49999 11.7929L6.35354 10.6465C6.15827 10.4512 5.84169 10.4512 5.64643 10.6465C5.45117 10.8417 5.45117 11.1583 5.64643 11.3536L7.14644 12.8536C7.34171 13.0488 7.65829 13.0488 7.85355 12.8536L8.40073 12.3064L9.57124 14.2572C9.65046 14.3893 9.78608 14.4774 9.9389 14.4963C10.0917 14.5151 10.2447 14.4624 10.3535 14.3536L12.3535 12.3536C12.4648 12.2423 12.5172 12.0851 12.495 11.9293L12.0303 8.67679L12.6536 8.05355C13.509 7.19808 14.0117 5.82855 14.1887 4.58943C14.2784 3.9618 14.2891 3.33847 14.2078 2.79546C14.1287 2.26748 13.9519 1.74482 13.6035 1.39645C13.2552 1.04809 12.7325 0.871332 12.2045 0.792264C11.6615 0.710945 11.0382 0.721644 10.4105 0.8113C9.17143 0.988306 7.80189 1.491 6.94644 2.34642L6.32322 2.96968L3.07071 2.50504C2.91492 2.48278 2.75773 2.53517 2.64645 2.64646L0.646451 4.64645C0.537579 4.75533 0.484938 4.90829 0.50375 5.0611C0.522563 5.21391 0.61073 5.34954 0.742757 5.42876L2.69364 6.59928L2.14646 7.14645C2.0527 7.24022 2.00002 7.3674 2.00002 7.50001C2.00002 7.63261 2.0527 7.75979 2.14646 7.85356L3.64647 9.35356C3.84173 9.54883 4.15831 9.54883 4.35357 9.35356C4.54884 9.1583 4.54884 8.84172 4.35357 8.64646L3.20712 7.50001L3.85357 6.85356L6.85357 3.85355ZM10.0993 13.1936L9.12959 11.5775L11.1464 9.56067L11.4697 11.8232L10.0993 13.1936ZM3.42251 5.87041L5.43935 3.85356L3.17678 3.53034L1.80638 4.90074L3.42251 5.87041ZM2.35356 10.3535C2.54882 10.1583 2.54882 9.8417 2.35356 9.64644C2.1583 9.45118 1.84171 9.45118 1.64645 9.64644L0.646451 10.6464C0.451188 10.8417 0.451188 11.1583 0.646451 11.3535C0.841713 11.5488 1.1583 11.5488 1.35356 11.3535L2.35356 10.3535ZM3.85358 11.8536C4.04884 11.6583 4.04885 11.3417 3.85359 11.1465C3.65833 10.9512 3.34175 10.9512 3.14648 11.1465L1.14645 13.1464C0.95119 13.3417 0.951187 13.6583 1.14645 13.8535C1.34171 14.0488 1.65829 14.0488 1.85355 13.8536L3.85358 11.8536ZM5.35356 13.3535C5.54882 13.1583 5.54882 12.8417 5.35356 12.6464C5.1583 12.4512 4.84171 12.4512 4.64645 12.6464L3.64645 13.6464C3.45119 13.8417 3.45119 14.1583 3.64645 14.3535C3.84171 14.5488 4.1583 14.5488 4.35356 14.3535L5.35356 13.3535ZM9.49997 6.74881C10.1897 6.74881 10.7488 6.1897 10.7488 5.5C10.7488 4.8103 10.1897 4.25118 9.49997 4.25118C8.81026 4.25118 8.25115 4.8103 8.25115 5.5C8.25115 6.1897 8.81026 6.74881 9.49997 6.74881Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></button></div><h1 class="mb-0">Validating your data product</h1><header class="mt-4 not-prose"><div><span class="font-semibold text-sm inline-block"><button class="focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R78top:" data-state="closed">Genevive Clow</button></span></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div class="sticky top-[60px] pb-[14px] flex justify-end w-full z-20 pointer-events-none"><div class="flex p-1 m-1 space-x-1 border rounded-full shadow pointer-events-auto border-stone-300 bg-white/80 dark:bg-stone-900/80 backdrop-blur"><div class="rounded"><button class="flex text-center rounded-full cursor-pointer text-stone-800 dark:text-white hover:opacity-100 opacity-60" aria-label="start compute environment"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="inline-block w-6 h-6 align-top"><title>Launch kernel</title><path stroke-linecap="round" stroke-linejoin="round" d="M5.636 5.636a9 9 0 1 0 12.728 0M12 3v9"></path></svg></button></div></div></div><div id="skip-to-article"></div><div id="Ur93KxHiAe" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">#%pip install xarray==2024.05.0</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="hKYLGNoJGmXuElQKUsoAe" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="vc65UtnPlm" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Imports
#%pip install pykrige
#%pip install xarray
# %pip install xarray==2024.05.0

%matplotlib widget

%load_ext autoreload
%autoreload 2
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="C3gXWQVVntU2bHZ0OsWko" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="AsU8u8rUG0" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">import numpy as np
import matplotlib.pyplot as plt
from matplotlib.colors import Normalize
from mpl_toolkits.mplot3d import Axes3D
#from skimage import exposure
#from skimage.io import imsave, imread
#from osgeo import ogr
import pystac_client
from pyproj import Transformer
from datetime import date, timedelta, datetime
from dateutil.relativedelta import relativedelta
import geopandas as gpd
import pandas as pd
import geoviews as gv
import hvplot.pandas
import intake
import xarray as xr
import numpy as np
from numpy.random import default_rng
import intake
from pyproj import Proj, transform
#from osgeo import gdal
from sklearn.neighbors import BallTree
import earthaccess
import gzip
import s3fs</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="HhP4FK5bmSlLpxOnoRxwa" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><div class="p-2.5">Loading...</div></div></div></div><div id="bCmbwwJUf0" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># for progress bar
from ipywidgets import IntProgress
from IPython.display import display
from ipywidgets import interact, Dropdown
import time
from tqdm.notebook import trange, tqdm

import boto3
import rasterio as rio
from rasterio.features import rasterize
from rasterio.session import AWSSession
import dask
import os
import rioxarray
from rasterio.enums import Resampling
from rasterio.warp import reproject
from rasterio.warp import Resampling as resample
import cartopy.crs as ccrs
import cartopy
#from pykrige.ok import OrdinaryKriging
from sklearn.linear_model import LinearRegression, RANSACRegressor
from scipy.odr import Model, RealData, ODR
import scipy.odr as odr
import scipy
import statsmodels.formula.api as smf
from shapely.geometry.polygon import Polygon, Point
import pygmt
import gc
import pytz
import pyproj
import math
from pathlib import Path
from matplotlib.patches import Polygon as Pgon
from tqdm import tqdm
from sklearn.preprocessing import RobustScaler
from sklearn.preprocessing import StandardScaler

import SSTutils as sut

import warnings
warnings.filterwarnings(&#x27;ignore&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="9-QtItW9eA8TUZyTqoTGT" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left mb-5"><div><pre class="text-sm font-thin font-system jupyter-error"><code><span style="color:rgb(187, 0, 0)">---------------------------------------------------------------------------</span><span>
</span><span style="color:rgb(187, 0, 0)">ModuleNotFoundError</span><span>                       Traceback (most recent call last)
</span><span style="color:rgb(0, 187, 187)">Cell</span><span style="color:rgb(0, 187, 187)"> </span><span style="color:rgb(0, 187, 0)">In[4]</span><span style="color:rgb(0, 187, 0)">, line 38</span><span>
</span><span style="color:rgb(0, 187, 0)">     35</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">from</span><span style="color:rgb(undefined, undefined, undefined)"> </span><span style="color:rgb(0, 0, 187);font-weight:bold">sklearn</span><span style="color:rgb(0, 0, 187);font-weight:bold">.</span><span style="color:rgb(0, 0, 187);font-weight:bold">preprocessing</span><span style="color:rgb(undefined, undefined, undefined)"> </span><span style="color:rgb(0, 135, 0);font-weight:bold">import</span><span> RobustScaler
</span><span style="color:rgb(0, 187, 0)">     36</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">from</span><span style="color:rgb(undefined, undefined, undefined)"> </span><span style="color:rgb(0, 0, 187);font-weight:bold">sklearn</span><span style="color:rgb(0, 0, 187);font-weight:bold">.</span><span style="color:rgb(0, 0, 187);font-weight:bold">preprocessing</span><span style="color:rgb(undefined, undefined, undefined)"> </span><span style="color:rgb(0, 135, 0);font-weight:bold">import</span><span> StandardScaler
</span><span style="color:rgb(0, 187, 0)">---&gt; </span><span style="color:rgb(0, 187, 0)">38</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">import</span><span style="color:rgb(undefined, undefined, undefined)"> </span><span style="color:rgb(0, 0, 187);font-weight:bold">SSTutils</span><span style="color:rgb(undefined, undefined, undefined)"> </span><span style="color:rgb(0, 135, 0);font-weight:bold">as</span><span style="color:rgb(undefined, undefined, undefined)"> </span><span style="color:rgb(0, 0, 187);font-weight:bold">sut</span><span>
</span><span style="color:rgb(0, 187, 0)">     40</span><span> </span><span style="color:rgb(0, 135, 0);font-weight:bold">import</span><span style="color:rgb(undefined, undefined, undefined)"> </span><span style="color:rgb(0, 0, 187);font-weight:bold">warnings</span><span>
</span><span style="color:rgb(0, 187, 0)">     41</span><span> warnings.filterwarnings(</span><span style="color:rgb(187, 187, 0)">&#x27;</span><span style="color:rgb(187, 187, 0)">ignore</span><span style="color:rgb(187, 187, 0)">&#x27;</span><span>)

</span><span style="color:rgb(187, 0, 0)">ModuleNotFoundError</span><span>: No module named &#x27;SSTutils&#x27;</span></code></pre></div></div></div><div id="PBVfa2kf2n" class="relative group/block"><h3 id="why-do-we-need-to-validate" class="relative group"><span class="heading-text">Why do we need to validate?</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#why-do-we-need-to-validate" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>Now we have our calibrated SST data product! 🥳 We’re almost ready to use this data product for our scientific analysis, but there is still one more important step. As a quick reminder, our data product was derived from top-of-atmosphere radiance measurements. We then converted these radiances into actual SST values (in units of temperature) by calibrating with another satellite (MODIS). But can we trust that these derived SST values are accurately reflecting real ocean surface temperatures? Validation allows us to quantitfy the uncertainty of our product.</p></div><div id="nU3tn2wPC5" class="relative group/block"><h3 id="finding-data-to-validate-with" class="relative group"><span class="heading-text">Finding data to validate with</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#finding-data-to-validate-with" title="Link to this Section" aria-label="Link to this Section">¶</a></h3><p>When validating satellite products, we typically want to use in situ measurements: i.e., direct measurements taken in the field. For the ocean, these measurements come from buoys, ship-based thermometers and autonomous floats. An important thing to keep in mind is that while satellites measure the skin temperature (top ~10–20 microns), in situ platforms measure bulk SST (a few cm to 1 m depth).</p><p>Should be high quality!</p><p>Finding a good validation dataset can be tricky. Here’s are some lists of commonly-used validation datasets to help get you started:</p></div><div id="YGIw5re74L" class="relative group/block"><p>TO DO: These links need to be checked</p></div><div id="bgvmD1dNkQ" class="relative group/block"><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500 toggle"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">🌊 Ocean</div></div><div class="myst-admonition-body px-4 py-1"><table class=""><tbody><tr class=""><th class=""><strong>Dataset</strong></th><th class=""><strong>Access</strong></th><th class=""><strong>Variables</strong></th></tr><tr class=""><td class=""><strong>Argo</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://argo.ucsd.edu/data/acknowledging-argo/" class="">argo.ucsd.edu</a>  — DOI: <cite class="" data-state="closed"><a href="https://doi.org/10.17882/42182" target="_blank" rel="noreferrer" class="hover-link">Argo (2025)</a></cite> <br/> <a target="_blank" rel="noreferrer" href="https://www.ncei.noaa.gov/access/metadata/landing-page/bin/iso?id=gov.noaa.nodc%3AArgo-Monthly" class="">NOAA archive</a> — DOI: <cite class="" data-state="closed"><a href="https://doi.org/10.25921/Q97E-D719" target="_blank" rel="noreferrer" class="hover-link">10.25921/q97e‑d719</a></cite></td><td class="">Sea surface temperature, salinity</td></tr><tr class=""><td class=""><strong>GHRSST iQuam</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://www.star.nesdis.noaa.gov/socd/sst/iquam/" class="">GHRSST iQuam website</a> <br/> <cite class="" data-state="closed"><a href="https://doi.org/10.5281/ZENODO.7589540" target="_blank" rel="noreferrer" class="hover-link">GHRSST documentation (Zenodo)</a></cite></td><td class="">Sea surface temperature</td></tr><tr class=""><td class=""><strong>GTSPP</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://www.ncei.noaa.gov/products/global-temperature-salinity-profile-program" class="">NCEI GTSPP access</a></td><td class="">Temperature, salinity profiles</td></tr><tr class=""><td class=""><strong>SPURS</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://spurs.jpl.nasa.gov/" class="">SPURS homepage (NASA)</a></td><td class="">Sea surface salinity</td></tr><tr class=""><td class=""><strong>SeaBASS</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://seabass.gsfc.nasa.gov/" class="">seabass<wbr/>.gsfc<wbr/>.nasa<wbr/>.gov</a></td><td class="">Ocean color, chlorophyll-a</td></tr><tr class=""><td class=""><strong>NOMAD</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://www.star.nesdis.noaa.gov/socd/ocean/color/NOMAD/NOMAD.shtml" class="">NOMAD at NOAA STAR</a></td><td class="">Ocean color, chlorophyll-a</td></tr><tr class=""><td class=""><strong>BOUSSOLE</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://www.obs-vlfr.fr/Boussole/html/home/home.php" class="">BOUSSOLE Project</a></td><td class="">Ocean color, optics, chlorophyll</td></tr><tr class=""><td class=""><strong>GDP (Drifters)</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://www.aoml.noaa.gov/phod/gdp/" class="">Global Drifter Program</a></td><td class="">Ocean surface currents</td></tr><tr class=""><td class=""><strong>HF Radar</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://hfrnet.ucsd.edu/" class="">HFRNet Portal</a></td><td class="">Ocean surface currents</td></tr><tr class=""><td class=""><strong>ADCP</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://www.aoml.noaa.gov/phod/goos/adcp/index.php" class="">NOAA ADCP Program</a></td><td class="">Water column currents</td></tr></tbody></table></div></aside></div><div id="BQS1PTXjDU" class="relative group/block"><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500 toggle"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">⛅️ Atmosphere</div></div><div class="myst-admonition-body px-4 py-1"><table class=""><tbody><tr class=""><th class=""><strong>Dataset</strong></th><th class=""><strong>Access</strong></th><th class=""><strong>Variables</strong></th></tr><tr class=""><td class=""><strong>AERONET</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://aeronet.gsfc.nasa.gov/" class="">aeronet<wbr/>.gsfc<wbr/>.nasa<wbr/>.gov</a> <br/> <a target="_blank" rel="noreferrer" href="https://www.re3data.org/repository/r3d100011742" class="">re3data entry</a></td><td class="">Aerosol optical depth (AOD), aerosol type</td></tr><tr class=""><td class=""><strong>IGRA</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://www.ncei.noaa.gov/products/integrated-global-radiosonde-archive" class="">IGRA at NOAA</a></td><td class="">Atmospheric temperature, pressure</td></tr><tr class=""><td class=""><strong>GRUAN</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://www.gruan.org/" class="">GRUAN</a></td><td class="">Temperature, humidity, pressure</td></tr><tr class=""><td class=""><strong>METAR/ASOS</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://mesonet.agron.iastate.edu/request/download.phtml" class="">Iowa State Mesonet</a></td><td class="">Surface temperature, pressure</td></tr><tr class=""><td class=""><strong>GPM-GV</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://gpm.nasa.gov/resources/ground-validation" class="">NASA GPM Ground Validation</a></td><td class="">Precipitation</td></tr><tr class=""><td class=""><strong>GPCC</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://opendata.dwd.de/climate_environment/GPCC/" class="">GPCC at DWD</a></td><td class="">Precipitation</td></tr><tr class=""><td class=""><strong>SKYNET</strong></td><td class=""><a target="_blank" rel="noreferrer" href="http://atmos.cr.chiba-u.ac.jp/skynet/" class="">Chiba University SKYNET</a></td><td class="">Aerosols, AOD</td></tr><tr class=""><td class=""><strong>MPLNET</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://mplnet.gsfc.nasa.gov/" class="">MPLNET at NASA</a></td><td class="">Aerosols, clouds</td></tr><tr class=""><td class=""><strong>TCCON</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://tccondata.org/" class="">TCCON Data Portal</a></td><td class="">CO₂, CH₄, other trace gases</td></tr><tr class=""><td class=""><strong>Pandora</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://pandora.gsfc.nasa.gov/" class="">Pandora Project</a></td><td class="">NO₂, O₃, trace gases</td></tr><tr class=""><td class=""><strong>MAX-DOAS</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://uv-vis.aeronomie.be/maxdoas/" class="">MAX-DOAS Network</a></td><td class="">NO₂, SO₂, HCHO</td></tr></tbody></table></div></aside></div><div id="qbODjb9M1z" class="relative group/block"><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500 toggle"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">🌳 Land</div></div><div class="myst-admonition-body px-4 py-1"><table class=""><tbody><tr class=""><th class=""><strong>Dataset</strong></th><th class=""><strong>Access</strong></th><th class=""><strong>Variables</strong></th></tr><tr class=""><td class=""><strong>SURFRAD</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://www.esrl.noaa.gov/gmd/grad/surfrad/" class="">NOAA SURFRAD</a></td><td class="">Land surface temperature, radiation</td></tr><tr class=""><td class=""><strong>BSRN</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://bsrn.awi.de/" class="">BSRN</a></td><td class="">Solar radiation, surface energy fluxes</td></tr><tr class=""><td class=""><strong>FLUXNET</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://fluxnet.org/" class="">fluxnet.org</a></td><td class="">LST, vegetation indices, fluxes</td></tr><tr class=""><td class=""><strong>SCAN</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://www.wcc.nrcs.usda.gov/scan/" class="">USDA SCAN</a></td><td class="">Soil moisture</td></tr><tr class=""><td class=""><strong>ISMN</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://ismn.earth/" class="">International Soil Moisture Network</a></td><td class="">Soil moisture</td></tr><tr class=""><td class=""><strong>Phenocam</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://phenocam.sr.unh.edu/" class="">Phenocam Network</a></td><td class="">Vegetation phenology (NDVI proxy)</td></tr><tr class=""><td class=""><strong>NEON</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://www.neonscience.org/" class="">NEON Data Portal</a></td><td class="">Vegetation indices, climate variables</td></tr><tr class=""><td class=""><strong>BELMANIP</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://land.copernicus.eu/global/sites" class="">Copernicus Land Service</a></td><td class="">Leaf area index (LAI)</td></tr><tr class=""><td class=""><strong>VALERI</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://w3.avignon.inrae.fr/valeri/" class="">VALERI Project</a></td><td class="">LAI, fAPAR</td></tr><tr class=""><td class=""><strong>DIRECT</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://www.avignon.inrae.fr/valeri/?q=node/13" class="">VALERI/DIRECT Info</a></td><td class="">LAI</td></tr></tbody></table></div></aside></div><div id="qScdq0sHd4" class="relative group/block"><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500 toggle"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">❄️ Cryosphere</div></div><div class="myst-admonition-body px-4 py-1"><table class=""><tbody><tr class=""><th class=""><strong>Dataset</strong></th><th class=""><strong>Access</strong></th><th class=""><strong>Variables</strong></th></tr><tr class=""><td class=""><strong>SnowEx</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://snow.nasa.gov/campaigns/snowex" class="">NASA SnowEx</a></td><td class="">Snow depth, snow cover, SWE</td></tr><tr class=""><td class=""><strong>CALVAL (NSIDC)</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://nsidc.org/data/calval" class="">NSIDC Cal/Val</a></td><td class="">Snow, cryosphere</td></tr><tr class=""><td class=""><strong>GSNOW</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://www.ncei.noaa.gov/products/snow-cover" class="">NOAA GSNOW</a></td><td class="">Snow cover</td></tr><tr class=""><td class=""><strong>NSIDC</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://nsidc.org/" class="">NSIDC</a></td><td class="">Sea ice, snow cover</td></tr><tr class=""><td class=""><strong>IABP (Ice Buoys)</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://iabp.apl.uw.edu/" class="">International Arctic Buoy Program</a></td><td class="">Sea ice concentration, drift</td></tr><tr class=""><td class=""><strong>IceBridge</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://nsidc.org/data/icebridge" class="">NASA IceBridge</a></td><td class="">Ice sheet elevation, thickness</td></tr><tr class=""><td class=""><strong>ATM</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://nsidc.org/data/ILATM2" class="">Airborne Topographic Mapper (ATM)</a></td><td class="">Ice elevation profiles</td></tr><tr class=""><td class=""><strong>NOHRSC</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://www.nohrsc.noaa.gov/" class="">NOAA NOHRSC</a></td><td class="">Snow depth and snow water equivalent</td></tr><tr class=""><td class=""><strong>CCSN (Canada)</strong></td><td class=""><a target="_blank" rel="noreferrer" href="https://open.canada.ca/data/en/dataset/5ff9d50e-591f-4e06-9b8f-0a707e8a1a74" class="">Canadian Cryospheric Snow Network</a></td><td class="">Snow depth, SWE</td></tr></tbody></table></div></aside></div><div id="qDott7stbQ" class="relative group/block"><h4 id="example-ghrsst-iquam-data" class="relative group"><span class="heading-text">Example: GHRSST iQUAM data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#example-ghrsst-iquam-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h4><p>For our new SST product, we’ll use the GHRSST iQUAM dataset for validation. GHRSST is the Group for High Resolution Sea Surface Temperature – an international collaboration supporting high-quality SST products for research and operational use – and iQuam is a system developed by NOAA to collect, quality-control (QC), and distribute in situ SST observations in near real-time and delayed mode. This dataset aggregates SST measurements from a variety of in situ platforms, such as drifting buoys, moored buoys, shipboard sensors, and Argo floats.</p><p><a target="_blank" rel="noreferrer" href="https://www.star.nesdis.noaa.gov/socd/sst/iquam/?tab=0&amp;dateinput_year=2023&amp;dateinput_month=02&amp;dayofmoninput_day=26&amp;dateinput_hour=00&amp;dayofmon=monthly&amp;qcrefsst=_qcrey&amp;qcrefsst=_qccmc&amp;outlier=qced#qmap" class="">https://<wbr/>www<wbr/>.star<wbr/>.nesdis<wbr/>.noaa<wbr/>.gov<wbr/>/socd<wbr/>/sst<wbr/>/iquam<wbr/>/<wbr/>?tab<wbr/>=<wbr/>0<wbr/>&amp;<wbr/>dateinput<wbr/>_year<wbr/>=<wbr/>2023<wbr/>&amp;<wbr/>dateinput<wbr/>_month<wbr/>=<wbr/>02<wbr/>&amp;<wbr/>dayofmoninput<wbr/>_day<wbr/>=<wbr/>26<wbr/>&amp;<wbr/>dateinput<wbr/>_hour<wbr/>=<wbr/>00<wbr/>&amp;<wbr/>dayofmon<wbr/>=<wbr/>monthly<wbr/>&amp;<wbr/>qcrefsst<wbr/>=<wbr/><wbr/>_qcrey<wbr/>&amp;<wbr/>qcrefsst<wbr/>=<wbr/><wbr/>_qccmc<wbr/>&amp;<wbr/>outlier<wbr/>=<wbr/>qced<wbr/>#qmap</a></p></div><div id="AjGcMyQuq7" class="relative group/block"><h3 id="finding-data-matchups" class="relative group"><span class="heading-text">Finding data matchups</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#finding-data-matchups" title="Link to this Section" aria-label="Link to this Section">¶</a></h3></div><div id="bJNhEkb7OM" class="relative group/block"><p>Here are some important considerations we need to make when finding matchups between the satellite product and in situ datasets:</p><p>🔹 <strong>1. Spatial Collocation</strong></p><ul><li><p>Footprint Differences: Satellite pixels often represent an area (e.g., 1 km² or more), while in situ data may be point measurements.</p><ul><li>Solution: Use in situ data averaged over the satellite footprint or compare satellite data averaged over multiple pixels surrounding the in situ point.</li></ul></li><li><p>Geolocation Accuracy: Both satellite and in situ positions should be accurately known, especially in dynamic environments (e.g., drifting buoys).</p></li><li><p>Environmental Variability: Spatial gradients (e.g., near coastlines or fronts) can lead to mismatches even with close locations.</p></li></ul><p>🔹 <strong>2. Temporal Matching</strong></p><ul><li><p>Temporal Resolution: Satellites provide snapshots (sometimes daily, sometimes instantaneous), while in situ data may be continuous or periodic.</p><ul><li>Solution: Match satellite observation time as closely as possible to in situ sampling time (e.g., within ±1 hour).</li></ul></li><li><p>Diurnal Effects: Some variables (e.g., SST, radiative fluxes) vary significantly throughout the day.</p><ul><li>Solution: Use diurnal correction or only match at known overpass times (e.g., MODIS ~1:30 pm local time).</li></ul></li></ul><p>🔹 <strong>3. Variable Definitions and Depths</strong></p><ul><li>Depth Differences: For example, satellite SST represents skin temperature (top ~10–20 μm), whereas in situ sensors often measure at ~1 m.<ul><li>Solution: Apply a skin-to-bulk correction or compare to “foundation temperature” from models.</li></ul></li><li>Variable Representation: Ensure the in situ measurement is of the same quantity the satellite estimates (e.g., top-of-canopy reflectance vs. leaf-level LAI).</li></ul><p>🔹 <strong>4. Quality Control</strong></p><ul><li>Flagging: Use only high-quality satellite and in situ data (e.g., use quality flags to exclude cloud-contaminated pixels or questionable sensor readings).</li><li>Consistency in Units and Calibration: Verify that data are in the same units and reference systems (e.g., radiance vs. reflectance, SI units).</li><li>Error Estimates: Consider measurement uncertainty and noise in both datasets.</li></ul><p>🔹 <strong>5. Statistical Considerations</strong></p><ul><li>Matchup Volume: A large number of matchup pairs increases robustness.</li><li>Bias and RMSE Analysis: Use metrics like bias, RMSE, and correlation to assess agreement.</li><li>Outlier Handling: Identify and analyze outliers to understand limitations or failure modes.</li></ul><p>🔹 <strong>6. Sensor Calibration</strong></p><ul><li>Ensure both satellite and in situ instruments are properly calibrated and traceable to standards.</li></ul><p>🔹 <strong>7. Geophysical Context</strong></p><ul><li>Geographical Diversity: Validation should include diverse regions (e.g., open ocean, coastal, tropical, polar) to capture algorithm performance globally. In our example, we are only validating our product near Antarctica, so we should only use this product in that region.</li></ul></div><div id="xF3s8ylgzk" class="relative group/block"><p>In order to maximize the number of data matchups while still making a fair comparison, we need to determine an appropriate window in space and time. In our example, we set our spatial window to 1 km and our temporal window to half of a day:</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-text" style="white-space:pre">dist = 1.0
time_add = 0.5</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div></div><div id="EF1vrXr5RX" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Landsat STAC catalog location
url = &#x27;https://landsatlook.usgs.gov/stac-server&#x27;

# Add Jetstream2 access
jetstream_url = &#x27;https://js2.jetstream-cloud.org:8001/&#x27;
s3 = s3fs.S3FileSystem(anon=True, client_kwargs=dict(endpoint_url=jetstream_url))
iQfiles=s3.ls(&#x27;pythia/landsat8/iQuam&#x27;) 
print(iQfiles)

# Paths
basepath = Path(&#x27;/home/jovyan/landsatproduct-cookbook&#x27;)
lsatpath = basepath / &#x27;Data&#x27;
atmpath = lsatpath / &#x27;AtmCorrection&#x27;
modout_path = lsatpath / &#x27;MOD07_L2&#x27;
SSTpath = lsatpath / &#x27;SST/Validation/iQuamIntercomp/&#x27;
#iQpath = lsatpath / &#x27;iQuam&#x27;

WV = &#x27;Water_Vapor&#x27;

# For geopandas and tile plots
satellite = &#x27;Landsat8&#x27;
collection = &#x27;landsat-c2l1&#x27; # Landsat Collection 2, Level 1
colnm = [&#x27;landsat:wrs_path&#x27;,&#x27;landsat:wrs_row&#x27;]
gjson_outfile = lsatpath / f&#x27;{satellite}_iQuam.geojson&#x27;

# Buffer around iquam point used to create a bounding box for Landsat sample
dist = 1.0 # km

# Temporal search range (days) before/after iquam measurement for finding Landsat image
time_add = 0.5

lthresh = -1.9

interp = 1</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="UOQ5iSCOkdaeiZf1QpG_S" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="Gz3mJ9AQOs" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Year and months desired (multiple years)
start_yr = 2013
end_yr = 2023

# Note these will get months from the later part of the year to early next
start_mo = &#x27;09&#x27;
end_mo = &#x27;03&#x27;

# Headers for the saved outputs
headers = [&#x27;DateTime&#x27;,&#x27;L8_filename&#x27;,&#x27;L8_SST&#x27;,&#x27;L8_std&#x27;,&#x27;center&#x27;,&#x27;N&#x27;,&#x27;S&#x27;,&#x27;E&#x27;,&#x27;W&#x27;,&#x27;NE&#x27;,&#x27;SE&#x27;,&#x27;NW&#x27;,&#x27;SW&#x27;,&#x27;L8_SST_max&#x27;,&#x27;L8_SST_min&#x27;,&#x27;Argo_id&#x27;,&#x27;Argo_SST&#x27;,&#x27;A_lat&#x27;,&#x27;A_lon&#x27;]

# Desired projection transformation
source_crs = &#x27;epsg:4326&#x27; 
target_crs = &#x27;epsg:3031&#x27; # Coordinate system of the Landsat file</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="QzYVtvPcs9hgP1MqgmxAB" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="HuFaDgmL8Q" class="relative group/block"><p>Now we’re ready to find our matchups!</p><p>We’re repeating the retrieval step for the locations where we have data matchups.</p></div><div id="yEij9U1mEb" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">%%time

# Multiple years

# Set up projections
transformer = Transformer.from_crs(source_crs, target_crs, always_xy=True)

# Get iQuam file paths in directory between desired dates and find and produce matching Landsat SSTs 
for year in range(start_yr, end_yr):  
    yrmo = []
    start_yrmo = f&quot;{year}{start_mo}&quot;  # Start from September of the current year
    end_yrmo = f&quot;{year+1}{end_mo}&quot;  # End in March of the next year

    m0 = start_yrmo
    
    # Make a list of months between start and end
    while int(m0) &lt;= int(end_yrmo):
        calc_dt = datetime.strptime(f&#x27;{m0[:4]}-{m0[4:]}&#x27;, &#x27;%Y-%m&#x27;)
        yrmo.append(calc_dt.strftime(&quot;%Y%m&quot;))
        m0 = (calc_dt + relativedelta(months=1)).strftime(&quot;%Y%m&quot;)
    
    # Get file names and select only those matching dates from yrmo  
    #iQfiles = os.listdir(iQpath)
    s3path = &#x27;s3://pythia/landsat8/iQuam/*.nc&#x27;
    iQfiles = s3.glob(s3path)
    #s3.invalidate_cache()

    #iQfiles = [x for x in iQfiles if x[:6] in yrmo]
    iQfiles = [x for x in iQfiles if x[22:22+6] in yrmo]
    iQfiles.sort(reverse=True)
    print (f&#x27;{year}: {len(iQfiles)}&#x27;)
    
    #os.chdir(iQpath)

    # For each iquam file, pair West Antarctic Argo buoy data with Landsat data and create calibrated SSTs
    valid = []
    
    for iquam_file in iQfiles:
        print(iquam_file)
        print(&#x27;s3://&#x27;+iquam_file)
        # Open Argos data from iQuam file
        
        df = xr.open_dataset(&#x27;s3://&#x27;+iquam_file)
        iquam = df.to_dataframe()
        
        # Subset to Antarctica
        ant = iquam[(iquam.lat&lt;-65)&amp;(iquam.lon&gt;-142)&amp;(iquam.lon&lt;-72)&amp;(iquam.platform_type==5.0)&amp;(iquam.quality_level==5.0)]  # Entire West Antarctica (later)
        # ant = iquam[(iquam.lat&lt;-69)&amp;(iquam.lon&gt;-125)&amp;(iquam.lon&lt;-98)&amp;(iquam.platform_type==5.0)&amp;(iquam.quality_level==5.0)] # Amundsen Sea
        
        # To remove a landsat day that is coming up with a 403 error
        if ant[&#x27;year&#x27;].iloc[0] == 2020 and ant[&#x27;month&#x27;].iloc[0] == 12:
            ant = ant[ant.day != 9.0] # for 202012 because otherwise will fail
        
        print(&#x27;&#x27;)
        print(f&#x27;{iquam_file[:6]}: {ant.shape[0]} measurements&#x27;)
    
        for idx in tqdm(range(ant.shape[0]), desc=&quot;Processing&quot;):
    
            # Create search area
            ilat = ant[&#x27;lat&#x27;].iloc[idx]
            ilon = ant[&#x27;lon&#x27;].iloc[idx]
    
            lat_add = sut.km_to_decimal_degrees(dist, ilat, direction=&#x27;latitude&#x27;)
            lon_add = sut.km_to_decimal_degrees(dist, ilat, direction=&#x27;longitude&#x27;)
            bboxV = (ilon-lon_add,ilat-lat_add,ilon+lon_add,ilat+lat_add)
    
            # Create Landsat temporal search range in correct format
            ihr = int(ant.hour.iloc[idx])
            iyr = int(ant.year.iloc[idx])
            imo = int(ant.month.iloc[idx])
    
            calc_dt = datetime.strptime(f&#x27;{iyr}-{imo}-{int(ant.day.iloc[idx])} {ihr}&#x27;, &#x27;%Y-%m-%d %H&#x27;)
            start_dt = (calc_dt + timedelta(days=-time_add)).strftime(&#x27;%Y-%m-%dT%H:%M:%SZ&#x27;)
            end_dt = (calc_dt + timedelta(days=time_add)).strftime(&#x27;%Y-%m-%dT%H:%M:%SZ&#x27;)
    
            timeRangeV = f&#x27;{start_dt}/{end_dt}&#x27;
    
            # Search for desired Landsat scenes
            items = sut.search_stac(url,collection,gjson_outfile=gjson_outfile,bbox=bboxV,timeRange=timeRangeV)
    
            # Load the geojson file and open stac catalog
            catalog = intake.open_stac_item_collection(items)
            gf = gpd.read_file(gjson_outfile)
    
            # Exclude Landsat 9
            catalog_list = [x for x in items if x.id[3]==&#x27;8&#x27;]
            num_scene = len(catalog_list)
            # print(f&#x27;{num_scene} Landsat 8 items&#x27;)
    
            # If any matching landsat scenes are found create calibrated SSTs for them
            if num_scene&gt;0:
    
                # Reproject to determine bounding box in espg 3031
                sbox,checkbox = sut.lsat_reproj(source_crs,target_crs,(bboxV[0],bboxV[1],bboxV[2],bboxV[3]))
    
                # Create polygon for later cropping
                polygon = Polygon([(sbox[0][0],sbox[0][1]),(sbox[3][0],sbox[3][1]),(sbox[2][0],sbox[2][1]),(sbox[1][0],sbox[1][1])])
                
                # Create min/max boundaries for trimming image before crop_xarray to cut down on processing times
                minx, miny, maxx, maxy = polygon.bounds
                polarx = [minx, maxx]
                polary = [miny, maxy]
    
                # Create calibrated SSTs for each matching landsat scene
                for sceneid in catalog_list:
                    print(sceneid.id)
    
                    scene = catalog[sceneid.id]
                    timestr = scene.metadata[&#x27;datetime&#x27;].strftime(&#x27;%H%M%S&#x27;)
    
                    outFile = f&#x27;{SSTpath}/{sceneid.id}_{timestr}_Cel.tif&#x27;
    
                    if os.path.isfile(outFile):
                        print (f&#x27;{sceneid.id} - atm corr exists&#x27;)
                        ls_scene = xr.open_dataset(outFile,chunks=dict(x=512, y=512),engine=&#x27;rasterio&#x27;)
                        ls_scene = ls_scene.rio.write_crs(&quot;epsg:3031&quot;, inplace=True)
    
                        # Subset all scenes and check for right dimensions because y order changes sometimes
                        ls_sub = sut.subset_img(ls_scene[&#x27;band_data&#x27;].sel(band=1),polarx,polary) # subset so easier to work with
    
                    else:
                        # try:
                        # Open all desired bands for one scene
                        ls_scene = sut.landsat_to_xarray(sceneid,catalog)
                        ls_scene = ls_scene.rio.write_crs(&quot;epsg:3031&quot;, inplace=True)
        
                        # Create classification mask
                        ls_scene = sut.create_masks(ls_scene, cloud_mask=True, ice_mask=True, ocean_mask=True)

                        # Check for any open ocean pixels - go to next image if none - ??? s
                        mask = np.ones(ls_scene.shape[1:])
                        mask[ls_scene.mask!=3] = np.nan
                        ls_thermal = ls_scene.sel(band=&#x27;lwir11&#x27;).compute()

                        # Check in bounding box or for entire Landsat image depending on whether doing calibration runs or not
                        ls_box = sut.subset_img(ls_thermal*mask,polarx,polary)

                        if ((ls_box).notnull()).sum().values==0:
                            print (f&#x27;{sceneid.id} has no SSTs&#x27;)
                            try:
                                del ls_scene, scene, mask, ls_thermal, ls_box
                            except:
                                pass
                            gc.collect()
                            continue

                        # Use band ratios for RF cloud pixel classification
                        ####

                        # Atmospheric correction using MODIS
                        # Acquire and align MODIS water vapor (MOD/MYD07) to Landsat
                        mod07,modfilenm = sut.open_MODIS(ls_scene,scene,modout_path)
                        print(&quot;1&quot;)

                        # Create water vapor files aligned and subsampled to Landsat
                        spacing = [300,-300] # 300m sampling of MODIS data so that upsampling is easy and because 30m takes far too long
                        WV_xr = sut.get_wv(ls_scene,mod07,spacing,WV,scene,interp=interp)
                        print(&quot;2&quot;)
                        # Create SST by masking and using water vapor to apply atmospheric correction
                        SST = sut.apply_retrieval(ls_thermal,scene,mask,WV_xr,atmcor,simT_transformer,simTOA_transformer,simWV_transformer)

                        # Record MODIS water vapor image used in atmospheric correction, will find this info save under band_data in
                        # data variables in COG (click on white paper info button in xarray readout)
                        SST.attrs[&#x27;MODIS_WV&#x27;] = modfilenm

                        # Save to a cloud-optimized Geotiff
                        SST.rio.to_raster(raster_path=outFile, driver=&quot;COG&quot;)
                        print (f&#x27;Mean SST: {np.nanmean(SST)}&#x27;)

                        # Subset all scenes and check for right dimensions because y order changes sometimes
                        ls_sub = sut.subset_img(SST,polarx,polary) # subset so easier to work with 

                        try:
                            del mask, ls_thermal, mod07, WV_xr, SST
                        except:
                            pass
    
                        # except Exception as e:
                        #     print (sceneid.id, e)
                        #     lsat = np.nan
                        #     lstd = np.nan
    
                    # Crop data to exact bounding box
                    ls_sub = sut.crop_xarray_dataarray_with_polygon(ls_sub, polygon) 
    
                    # Calibrate using MODIS
                    ls_sub = ls_sub * calib_m + calib_b
    
                    # Remove all pixels that are too cold
                    ls_sub = ls_sub.where(ls_sub&gt;=lthresh,np.nan)
    
                    lsat = np.around(np.nanmean(ls_sub),2)
                    lstd = np.around(np.nanstd(ls_sub),2)
    
                    # Convert Argo lat/lon to Landsat&#x27;s EPSG:3031
                    argo_px, argo_py = transformer.transform(ilon, ilat)
    
                    # 1) Find the nearest center pixel
                    center_val = ls_sub.sel(x=argo_px, y=argo_py, method=&quot;nearest&quot;)
                    
                    # Extract the x/y coordinate values as plain floats
                    center_x = center_val.x.item()
                    center_y = center_val.y.item()
                    
                    # 2) Get integer indices from the coordinate indexes
                    #    This uses ls_sub.get_index(&#x27;dim_name&#x27;) -&gt; pandas.Index -&gt; get_indexer(...)
                    center_x_idx = ls_sub.get_index(&quot;x&quot;).get_indexer([center_x])[0]
                    center_y_idx = ls_sub.get_index(&quot;y&quot;).get_indexer([center_y])[0]
                    
                    # 3) Gather offsets for the 3x3 neighborhood
                    offsets = [
                        ( 0,  0, &quot;center&quot;),
                        ( 0,  1, &quot;N&quot;),
                        ( 0, -1, &quot;S&quot;),
                        ( 1,  0, &quot;E&quot;),
                        (-1,  0, &quot;W&quot;),
                        ( 1,  1, &quot;NE&quot;),
                        ( 1, -1, &quot;SE&quot;),
                        (-1,  1, &quot;NW&quot;),
                        (-1, -1, &quot;SW&quot;),
                    ]
                    
                    neighbors = {}
                    for dx, dy, name in offsets:
                        nx = center_x_idx + dx
                        ny = center_y_idx + dy
                        # Ensure we&#x27;re within the array bounds
                        if (0 &lt;= nx &lt; ls_sub.sizes[&#x27;x&#x27;]) and (0 &lt;= ny &lt; ls_sub.sizes[&#x27;y&#x27;]):
                            # xarray dimension order is typically (y, x), so use isel(y=ny, x=nx):
                            neighbors[name] = ls_sub.isel(y=ny, x=nx).values.item()
                        else:
                            neighbors[name] = np.nan
                    
                    # 4) Record coincident data from Landsat and Argo float
                    argo_temp = np.around((ant.sst.iloc[idx] - 273.15),2)  # convert to Celsius
                    times = pd.to_datetime(calc_dt, format=&#x27;%Y%m%d%H&#x27;)  # standardize time
                    
                    valid.append([
                        times,
                        sceneid.id,
                        lsat,
                        lstd,
                        neighbors[&#x27;center&#x27;],
                        neighbors[&#x27;N&#x27;],
                        neighbors[&#x27;S&#x27;],
                        neighbors[&#x27;E&#x27;],
                        neighbors[&#x27;W&#x27;],
                        neighbors[&#x27;NE&#x27;],
                        neighbors[&#x27;SE&#x27;],
                        neighbors[&#x27;NW&#x27;],
                        neighbors[&#x27;SW&#x27;],
                        ls_sub.max().values.item(),
                        ls_sub.min().values.item(),
                        ant.iloc[idx].name,  # Argo ID or whichever label you prefer
                        argo_temp,
                        ilat,
                        ilon
                    ])
                    print (f&#x27;Argo temp: {argo_temp}, Landsat 8 mean: {lsat}+/-{lstd}&#x27;)
    
                    try:
                        del ls_scene, scene, ls_thermal, ls_box, mod07, WV_xr, SST, ls_sub, neighbors
                    except:
                        pass
    
                    gc.collect()

    # Put data into DataFrame and save    
    lsat_mod_df = pd.DataFrame(valid,columns=headers)
    out_df = lsatpath / f&#x27;Landsat_validation_{start_yrmo}_{end_yrmo}_{dist}.csv&#x27;
    #lsat_mod_df.to_csv(out_df)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="VXSqw4Z30MkWsCaBEGb2S" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="yapeAcO4cP" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">



df = xr.open_dataset(&#x27;s3://&#x27;+iquam_file)
iquam = df.to_dataframe()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="ESNLICkG-KaWyJZxHM-Zh" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="XGZkKEggXh" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># test cell for S3 access, delete once working

#import xarray as xr
#import s3fs

jetstream_url = &#x27;https://js2.jetstream-cloud.org:8001/&#x27;

s3 = s3fs.S3FileSystem(anon=True, client_kwargs=dict(endpoint_url=jetstream_url))

s3path = &#x27;s3://pythia/landsat8/iQuam/202302-STAR-L2i_GHRSST-SST-iQuam-V2.10-v01.0-fv02.0.nc&#x27;

# Open all files from folder
s3file = s3.open(s3path)

# Open with xarray
ds = xr.open_dataset(s3file)

ds
</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="Pm5p3FMS5EJI1GDNAEtp0" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="yaP8iuVfIQ" class="relative group/block"><h4 id="landsat-iquam-validation-assessment" class="relative group"><span class="heading-text">Landsat-iQUAM validation assessment</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#landsat-iquam-validation-assessment" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="qoc7vCrN0E" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Read in processed matchups

# 20250107 is threshold=-1.9, 20250114 is thresh=-1.94, 20250205 is thresh=-1.9
out_df = lsatpath / &#x27;Landsat_validation_202009_202103_1.0.csv&#x27;
valids = pd.read_csv(out_df)

valids = valids.set_index(&#x27;DateTime&#x27;)
valids = valids.sort_index()
valids[&#x27;Argo_id&#x27;] = valids[&#x27;Argo_id&#x27;].astype(int)

# Remove the non-numeric column for calculating daily means
numeric_valids = valids.select_dtypes(include=[np.number])
validmn = numeric_valids.groupby(numeric_valids[&#x27;Argo_id&#x27;]).mean()
valids = valids.reset_index()

# Group by the date component of the datetime and calculate the difference
valids[&#x27;temp_dif&#x27;] = valids.groupby(valids[&#x27;Argo_id&#x27;])[f&#x27;L8_SST&#x27;].diff()
validmn[&#x27;temp_dif&#x27;] = valids.groupby(valids[&#x27;Argo_id&#x27;])[&#x27;temp_dif&#x27;].first()
valids = valids.set_index(&#x27;DateTime&#x27;)

validmn[&#x27;std&#x27;] = valids.groupby([valids[&#x27;Argo_id&#x27;]])[f&#x27;L8_SST&#x27;].std()
validmn[&#x27;xaxis&#x27;] = pd.to_datetime(validmn.index).dayofyear
validmn[&#x27;xaxis&#x27;][validmn[&#x27;xaxis&#x27;]&lt;(365/2)] = validmn[&#x27;xaxis&#x27;] + 365

valids[&#x27;xaxis&#x27;] = pd.to_datetime(valids.index).dayofyear
valids[&#x27;xaxis&#x27;][valids[&#x27;xaxis&#x27;]&lt;(365/2)] = valids[&#x27;xaxis&#x27;] + 365

validmn = validmn.dropna(subset=[&#x27;L8_SST&#x27;])

valids</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="EWaftd2ZiyLU9G-MMEM5F" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="UP0oJxCeSv" class="relative group/block"><h4 id="visualize-all-validation-matchups-for-manual-qc" class="relative group"><span class="heading-text">Visualize all validation matchups for manual QC</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#visualize-all-validation-matchups-for-manual-qc" title="Link to this Section" aria-label="Link to this Section">¶</a></h4></div><div id="sqM4cWFO1L" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Setup and authenticate 
from dask.distributed import Client
import logging
client = Client(processes=True, n_workers=4, 
                threads_per_worker=1,
                silence_logs=logging.ERROR)
client.run(lambda: os.environ[&quot;AWS_REQUEST_PAYER&quot;] == &quot;requester&quot; )
client</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="-hlRU8C5UICz55sDj0WIz" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="v76vxDNEDC" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">pwd</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="3ZnnWs06djgB-GJbhOllv" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="m3HO0zxCkV" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">os.chdir(lsatpath)
lsatfiles = os.listdir(lsatpath)
lsatfiles = [i for i in lsatfiles if i[0]==&#x27;L&#x27;]

# Remove all files from the list with repeats and Landsat mean = nan
remove = [
&#x27;LC08_L1GT_029109_20160922_20200906_02_T2&#x27;, 
&#x27;LC08_L1GT_022110_20181029_20201016_02_T2&#x27;, 
&#x27;LC08_L1GT_005110_20181209_20201016_02_T2&#x27;,
&#x27;LC08_L1GT_228108_20200123_20201016_02_T2&#x27;,
&#x27;LC08_L1GT_001108_20200929_20201006_02_T2&#x27;,
&#x27;LC08_L1GT_002109_20201022_20201105_02_T2&#x27;,
&#x27;LC08_L1GT_233108_20201109_20210317_02_T2&#x27;,
&#x27;LC08_L1GT_233109_20201109_20210317_02_T2&#x27;,
&#x27;LC08_L1GT_001109_20201202_20210312_02_T2&#x27;,
&#x27;LC08_L1GT_027112_20220128_20220204_02_T2&#x27;,
&#x27;LC08_L1GT_002109_20210331_20210408_02_T2&#x27;
]

lsatfiles = [i for i in lsatfiles if i[:-15] not in remove]
if len(lsatfiles)!=12:
    print(&#x27;Wrong number of Landsat scenes!!!&#x27;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="n6OV_h8Bw-DUCTset--7O" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="CpHMSxaAWh" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Number of columns/rows for subplots
n_cols = 3
n_rows = 4

# Create one figure and a 4x7 grid of subplots
# The figsize is 10 across; adjust height as needed for clarity
fig, axes = plt.subplots(
    nrows=n_rows,
    ncols=n_cols,
    figsize=(11, 8.5),   
    subplot_kw={&#x27;projection&#x27;: ccrs.PlateCarree()}
)

# Optional: if you want them *really* close, you can fine-tune spacing:
plt.subplots_adjust(wspace=0.05, hspace=0.03)
# plt.subplots_adjust(bottom=0.15)

# Counter for subplot index, and a handle to store the last &quot;imshow&quot; (for colorbar)
i = 0
im_obj = None

for lsatfile in lsatfiles:
    lsID = lsatfile
    print(lsID)
    
    mrow = valids[valids[&#x27;L8_filename&#x27;].str.contains(lsatfile[:-15])]
    
    for idx, row in mrow.iterrows():
        # Check if L8_SST is NaN
        if pd.isnull(row[&#x27;L8_SST&#x27;]):
            # If it is NaN, skip this iteration and do not plot
            continue
        
        # --- Prepare data and coordinates ---
        ilat = row[&#x27;A_lat&#x27;]
        ilon = row[&#x27;A_lon&#x27;]
        
        lat_add = km_to_decimal_degrees(dist, ilat, direction=&#x27;latitude&#x27;)
        lon_add = km_to_decimal_degrees(dist, ilat, direction=&#x27;longitude&#x27;)
        xmin, ymin, xmax, ymax = (ilon - lon_add, ilat - lat_add, 
                                  ilon + lon_add, ilat + lat_add)
        
        # Load the Landsat file
        ds = xr.open_dataset(lsatfile, chunks=dict(x=512, y=512), engine=&#x27;rasterio&#x27;)
        ls_scene = ds[&#x27;band_data&#x27;].sel(band=1).rio.write_crs(&quot;epsg:3031&quot;, inplace=True)
        
        # Assign time coordinate
        times = pd.to_datetime(lsatfile[17:25] + lsatfile[41:47], format=&#x27;%Y%m%d%H%M%S&#x27;)
        ls_scene = ls_scene.assign_coords(time=times, ID=lsatfile[:-8])
        
        # Reproject to EPSG:4326
        ls_scene = ls_scene.rio.reproject(&quot;EPSG:4326&quot;)

        # Calibrate using MODIS
        ls_scene = ls_scene * calib_m + calib_b

        # Remove all pixels that are too cold
        ls_scene = ls_scene.where(ls_scene&gt;=lthresh,np.nan)
        
        # Select the subplot axis
        ax = axes[i // n_cols, i % n_cols]
        
        # Plot on that axis, without a colorbar
        # Store the &quot;imshow&quot; result in im_obj so we can build one colorbar later
        im_obj = ls_scene.plot.imshow(
            x=&#x27;x&#x27;, y=&#x27;y&#x27;,
            vmin=-2.0, vmax=1.5,
            ax=ax,
            transform=ccrs.PlateCarree(),
            origin=&#x27;upper&#x27;,
            add_colorbar=False  # &lt;- No individual colorbar
        )
        
        # Remove titles completely (xarray may add one by default)
        ax.set_title(&#x27;&#x27;)
        
        # Set extent
        ax.set_extent([ilon - 0.4, ilon + 0.4, ilat - 0.2, ilat + 0.2], crs=ccrs.PlateCarree())
        
        # Argo observation
        ax.scatter([ilon], [ilat], c=&#x27;r&#x27;, s=3, transform=ccrs.PlateCarree(), label=&#x27;Argo location&#x27;)
        
        # Draw bounding box
        polygon_show = Pgon([(xmin, ymin), (xmin, ymax), 
                             (xmax, ymax), (xmax, ymin)],
                            closed=True, edgecolor=&#x27;red&#x27;, facecolor=&#x27;none&#x27;)
        ax.add_patch(polygon_show)
        
        # Text label
        text_str = (
            f&quot;Argo ID: {row[&#x27;Argo_id&#x27;]}\n&quot;
            f&quot;Argo Temp: {np.around(row[&#x27;Argo_SST&#x27;], 2)}\n&quot;
            f&quot;Landsat SST: {np.around(row[&#x27;L8_SST&#x27;], 2)}&quot;
        )
        ax.text(
            0.02, 0.95,
            text_str,
            transform=ax.transAxes,
            fontsize=10,
            va=&#x27;top&#x27;,
            ha=&#x27;left&#x27;
        )

        gc.collect()
        
        # Move to next subplot index
        i += 1
        

# --- Add a single colorbar for the entire figure ---
# We use the last &quot;imshow&quot; (im_obj) and attach to all subplot axes
cbar_ax = fig.add_axes([0.25, 0.05, 0.5, 0.03])

cbar = fig.colorbar(
    im_obj, 
    ax=axes.ravel().tolist(),  # or just ax=axes if axes is 2D
    cax=cbar_ax,
    orientation=&#x27;horizontal&#x27;,  # &#x27;vertical&#x27; or &#x27;horizontal&#x27;
    fraction=0.025,            # how long the colorbar is relative to axes
    pad=0.05                   # space between colorbar and subplots
)
cbar.set_label(&quot;Temperature [°C]&quot;, fontsize=12)

# plt.tight_layout()
plt.show() </code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="e-uNBAAYHyhjDRv71MgNY" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="oKQk3BdssL" class="relative group/block"><h2 id="use-matchups-to-compare-modeled-and-observed-data" class="relative group"><span class="heading-text">Use matchups to compare modeled and observed data</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#use-matchups-to-compare-modeled-and-observed-data" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Here, we are going to use a linear regression</p></div><div id="V0Ydb04tht" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Remove low quality validation data from the valids data
rm_ids = [1460597, 1614080, 2143782, 2016236, 1790883]
rm = validmn[validmn.index.isin(rm_ids)]
validmn = validmn.drop(index=rm_ids, errors=&#x27;ignore&#x27;)
valids = valids[~valids[&#x27;Argo_id&#x27;].isin(rm_ids)]</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="x_XPLYVVokcddUiKObuk5" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="UA5Wt4P1IF" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre"># Orthoganal Regression 
data = validmn

# Original data
x_original = np.array(data[&#x27;Argo_SST&#x27;])
y_original = np.array(data[&#x27;L8_SST&#x27;])

# Define a linear function for the model
def linear_model(p, x):
    return p[0] * x + p[1]

# Create a Model
linear = Model(linear_model)

# Create a RealData object using your DataFrame
data = RealData(x_original, y_original)

# Set up ODR with the model and data
odr = ODR(data, linear, beta0=[1., 0.])

# Run the regression
out = odr.run()

# Use the output
beta = out.beta
beta_err = out.sd_beta

# Print the summary
out.pprint()

# Predicting values using the ODR model
y_pred = linear_model(beta, x_original)

# Get R2
# Calculate Total Sum of Squares (SST)
y_mean = np.mean(y_original)
SST = np.sum((y_original - y_mean)**2)

# Calculate Residual Sum of Squares (SSR)
SSR = np.sum((y_original - y_pred)**2)

# Compute RMSE
rmse = np.sqrt(((y_original - y_pred) ** 2).mean())

# Calculate R^2
R2 = 1 - (SSR / SST)
print(&quot;R^2:&quot;, np.around(R2,2))
print(f&quot;RMSE: {np.around(rmse,2)}&quot;)</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="8p_SOtCbMX12y0DtSq2NY" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div id="txE2Caal1V" class="relative group/block"><div class="flex sticky top-[115px] z-10 opacity-90 group-hover/block:opacity-100 group-hover/block:hidden"><div class="flex absolute top-0 right-0"></div></div><div class="hidden sticky top-[80px] z-10 opacity-70 group-hover/block:opacity-100 group-hover/block:flex"><div class="absolute top-0 -right-[28px] flex md:flex-col"></div></div><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 border border-l-4 border-gray-200 border-l-blue-400 dark:border-l-blue-400 dark:border-gray-800"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-python" style="white-space:pre">beta_mdn = [beta[0]-beta_err[0]*1.96,beta[1]-beta_err[1]*1.96]
beta_mup = [beta[0]+beta_err[0]*1.96,beta[1]-beta_err[1]*1.96]
beta_bdn = [beta[0]-beta_err[0]*1.96,beta[1]+beta_err[1]*1.96]
beta_bup = [beta[0]+beta_err[0]*1.96,beta[1]+beta_err[1]*1.96]
print(f&#x27;At 95% confidence interval: {np.around(beta[0],2)}+/-{np.around(beta_err[0]*1.96,2)}, {np.around(beta[1],2)}+/-{np.around(beta_err[1]*1.96,2)}, n={y_pred.shape[0]}&#x27;)
xfill = np.array([-4.3,0.9])


# Plot data points and 1:1 line
fig, ax = plt.subplots(figsize=(5, 4))
ax.tick_params(labelsize=14)

xi = np.arange(-7.0,5.0,1.0)

# lower_err = abs(data[&#x27;L8_SST&#x27;] - data[&#x27;L8_SST_min&#x27;])  # distance to lower bound
# upper_err = abs(data[&#x27;L8_SST_max&#x27;] - data[&#x27;L8_SST&#x27;])  # distance to upper bound

ax.scatter(x_original,y_original,color=&#x27;k&#x27;,linewidth=0,s=35,label=&#x27;High quality&#x27;)
ax.errorbar(x_original,y_original,yerr=validmn[&#x27;std&#x27;],color=&#x27;k&#x27;,fmt=&#x27;o&#x27;,ecolor=&#x27;k&#x27;,elinewidth=1,capthick=1,marker=&#x27;o&#x27;,ms=3,capsize=5,label=&#x27;_no legend_&#x27;)
# ax.errorbar(data[&#x27;Argo_SST&#x27;],data[&#x27;L8_SST&#x27;],yerr=[lower_err,upper_err],color=&#x27;k&#x27;,fmt=&#x27;o&#x27;,ecolor=&#x27;k&#x27;,elinewidth=1,capthick=1,marker=&#x27;o&#x27;,ms=3,capsize=5,label=&#x27;_no legend_&#x27;)
# ax.scatter(data[&#x27;Argo_SST&#x27;],data[&#x27;center&#x27;],color=&#x27;r&#x27;,linewidth=0,s=25,label=&#x27;_no label_&#x27;)
ax.scatter(rm[&#x27;Argo_SST&#x27;],rm[&#x27;L8_SST&#x27;],color=&#x27;0.7&#x27;, s=35, label=&#x27;Removed&#x27;,zorder=2)
ax.plot(xi,xi,color=&#x27;k&#x27;,linewidth=2, label=&#x27;1:1&#x27;)
ax.plot(x_original, y_pred, color=&#x27;k&#x27;, ls=&#x27;:&#x27;, label=&#x27;Validation ODR&#x27;)
ax.fill_between(xfill, linear_model(beta_bdn, xfill), linear_model(beta_mup, xfill),alpha=0.1, facecolor=&#x27;0.3&#x27;)
# a1.plot(xi,xi*lreg.coef_[0]+lreg.intercept_[0],color=&#x27;r&#x27;,linewidth=2,label=&#x27;RANSAC regression&#x27;)
# a1.scatter(xC,yLC,color=&#x27;r&#x27;,linewidth=0,s=35,label=&#x27;_no label_&#x27;)
# a1.plot(xi,xi*resultC.params.L8_SST+resultC.params.Intercept,color=&#x27;k&#x27;,linewidth=2,label=&#x27;OLS regression&#x27;)
# a1.text(-2.1,-2.85,f&#x27;y={np.around(resultC.params.L8_SST,2)}x+{np.around(resultC.params.Intercept,2)}   p={p_val}&#x27;,fontsize=12)
ax.text(-1.1,-1.5,f&#x27;y={np.around(beta[0],2)}x+{np.around(beta[1],2)}   $r^2$={np.around(R2,2)}&#x27;,fontsize=14)
ax.spines[&#x27;top&#x27;].set_visible(False)
ax.spines[&#x27;right&#x27;].set_visible(False)
ax.set_ylim([-1.95,1.5])
ax.set_xlim([-1.95,1.5])
ax.set_xlabel(&#x27;Argo Temperature [°C]&#x27;,fontsize=16)
ax.set_ylabel(&#x27;Landsat SST [°C]&#x27;,fontsize=16)
ax.legend(markerscale=1,fontsize=12,loc=&#x27;upper left&#x27;)

plt.tight_layout()
# plt.savefig(&#x27;/Users/tsnow03/GoogleDrive/User/Docs/PhD_Project/Manuscripts/AmundsenCC_Manuscript/Figures/LMCalibration.jpg&#x27;, format=&#x27;jpg&#x27;, dpi=1000)
plt.show()</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><div data-mdast-node-id="s9y05XR4IvbqMCHAtqETi" class="max-w-full overflow-y-visible overflow-x-auto m-0 group not-prose relative text-left"></div></div><div></div><section id="references" class="article-grid subgrid-gap col-screen"><div><header class="text-lg font-semibold text-stone-900 dark:text-white group">References<a class="no-underline text-inherit hover:text-inherit ml-2 select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#references" title="Link to References" aria-label="Link to References">¶</a></header></div><div class="pl-3 mb-8 text-xs text-stone-500 dark:text-stone-300"><ol><li class="break-words" id="cite-https://doi.org/10.17882/42182">Argo. (2025). <i>Argo float data and metadata from Global Data Assembly Centre (Argo GDAC)</i>. SEANOE. <a target="_blank" rel="noreferrer" href="https://doi.org/10.17882/42182">10.17882/42182</a></li><li class="break-words" id="cite-https://doi.org/10.25921/q97e-d719">International Argo Program. (2003). <i>Temperature, salinity, pressure, and biogeochemical profile data from globally distributed Argo profiling floats, by month since April 2003 for the Global Argo Data Repository, containing data from 1995-09-07 to present</i>. NOAA National Centers for Environmental Information. <a target="_blank" rel="noreferrer" href="https://doi.org/10.25921/Q97E-D719">10.25921/Q97E-D719</a></li><li class="break-words" id="cite-https://doi.org/10.5281/zenodo.7589540">GHRSST Project Office, Beggs, H., Karagali, I., & Castro, S. (2023). <i>Sea surface temperature: An introduction to users on the set of GHRSST formatted products</i>. <a target="_blank" rel="noreferrer" href="https://doi.org/10.5281/ZENODO.7589540">10.5281/ZENODO.7589540</a></li></ol></div></section><div class="flex pt-10 mb-10 space-x-4"><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/landsatproduct-cookbook/notebooks/calibration"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="text-xs text-gray-500 dark:text-gray-400">Preamble</div>Calibration</div></div></a><a class="flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700" href="/landsatproduct-cookbook/notebooks/validation-p2"><div class="flex h-full align-middle"><div class="flex-grow"><div class="text-xs text-gray-500 dark:text-gray-400">Preamble</div>Validation</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"></path></svg></div></a></div></main></article><script>((a,d)=>{if(!window.history.state||!window.history.state.key){let h=Math.random().toString(32).slice(2);window.history.replaceState({key:h},"")}try{let f=JSON.parse(sessionStorage.getItem(a)||"{}")[d||window.history.state.key];typeof f=="number"&&window.scrollTo(0,f)}catch(h){console.error(h),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/landsatproduct-cookbook/build/entry.client-UNPC4GT3.js"/><link rel="modulepreload" href="/landsatproduct-cookbook/build/_shared/chunk-OCTKKCIL.js"/><link rel="modulepreload" href="/landsatproduct-cookbook/build/_shared/chunk-UAI5KRM7.js"/><link rel="modulepreload" href="/landsatproduct-cookbook/build/_shared/chunk-2NH4LW52.js"/><link rel="modulepreload" href="/landsatproduct-cookbook/build/_shared/chunk-JSE36H2O.js"/><link rel="modulepreload" href="/landsatproduct-cookbook/build/_shared/chunk-HBJK6BW3.js"/><link rel="modulepreload" href="/landsatproduct-cookbook/build/_shared/chunk-HYMQ7M2K.js"/><link rel="modulepreload" href="/landsatproduct-cookbook/build/_shared/chunk-OHOXABTA.js"/><link rel="modulepreload" href="/landsatproduct-cookbook/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/landsatproduct-cookbook/build/_shared/chunk-C7FW3E47.js"/><link rel="modulepreload" href="/landsatproduct-cookbook/build/_shared/chunk-3CVK3PYF.js"/><link rel="modulepreload" href="/landsatproduct-cookbook/build/_shared/chunk-J6FHCSRC.js"/><link rel="modulepreload" href="/landsatproduct-cookbook/build/_shared/chunk-ND43KHSX.js"/><link rel="modulepreload" href="/landsatproduct-cookbook/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/landsatproduct-cookbook/build/root-IB5726YR.js"/><link rel="modulepreload" href="/landsatproduct-cookbook/build/_shared/chunk-NBON2RSI.js"/><link rel="modulepreload" href="/landsatproduct-cookbook/build/routes/$-LXLHKVOR.js"/><script>window.__remixContext = {"url":"/notebooks/validation-step1","state":{"loaderData":{"root":{"config":{"version":2,"myst":"1.6.0","options":{"favicon":"/landsatproduct-cookbook/build/config-item-9b3afca6-8add067388d4603368978412fc18e5a3.ico","logo":"/landsatproduct-cookbook/build/config-item-24692dda-9b1a51be2ae3a53260985b36368ad409.svg","logo_dark":"/landsatproduct-cookbook/build/config-item-84d6d338-309dcf57210f339d5431e4d63b7c9f82.svg","logo_url":"https://projectpythia.org","analytics_google":"G-T52X8HNYE8","folders":true},"parts":{},"nav":[{"title":"Home","url":"https://projectpythia.org"},{"title":"Foundations","url":"https://foundations.projectpythia.org"},{"title":"Cookbooks","url":"https://cookbooks.projectpythia.org/"},{"title":"Resources","url":"https://projectpythia.org/resource-gallery/"},{"title":"Community","url":"https://projectpythia.org/#join-us"}],"actions":[{"title":"Project Pythia","url":"https://projectpythia.org","internal":false,"static":false}],"projects":[{"open_access":true,"license":{"content":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"title":"Raw Pixels to Products","authors":[{"nameParsed":{"literal":"Tasha Snow","given":"Tasha","family":"Snow"},"name":"Tasha Snow","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Kathryn Moore","given":"Kathryn","family":"Moore"},"name":"Kathryn Moore","id":"contributors-myst-generated-uid-1"},{"nameParsed":{"literal":"Genevieve Clow","given":"Genevieve","family":"Clow"},"name":"Genevieve Clow","id":"contributors-myst-generated-uid-2"},{"nameParsed":{"literal":"Jianwen Du","given":"Jianwen","family":"Du"},"name":"Jianwen Du","id":"contributors-myst-generated-uid-3"},{"nameParsed":{"literal":"Arman Oliazneeh","given":"Arman","family":"Oliazneeh"},"name":"Arman Oliazneeh","id":"contributors-myst-generated-uid-4"}],"contributors":[{"id":"brian-rose","nameParsed":{"literal":"Brian E. J. Rose","given":"Brian E. J.","family":"Rose"},"name":"Brian E. J. Rose","orcid":"0000-0002-9961-3821","email":"brose@albany.edu","affiliations":["UAlbany"],"url":"https://brian-rose.github.io","github":"brian-rose","bluesky":"@brianejrose.bsky.social","linkedin":"https://www.linkedin.com/in/brian-rose-37bb55106/"},{"id":"clyne","nameParsed":{"literal":"John Clyne","given":"John","family":"Clyne"},"name":"John Clyne","orcid":"0000-0003-2788-9017","affiliations":["CISL"],"github":"clyne"},{"id":"jukent","nameParsed":{"literal":"Julia Kent","given":"Julia","family":"Kent"},"name":"Julia Kent","orcid":"0000-0002-5611-8986","affiliations":["CISL"],"github":"jukent"},{"id":"ktyle","nameParsed":{"literal":"Kevin Tyle","given":"Kevin","family":"Tyle"},"name":"Kevin Tyle","orcid":"0000-0001-5249-9665","affiliations":["UAlbany"],"github":"ktyle"},{"id":"andersy005","nameParsed":{"literal":"Anderson Banihirwe","given":"Anderson","family":"Banihirwe"},"name":"Anderson Banihirwe","orcid":"0000-0001-6583-571X","affiliations":["CarbonPlan"],"github":"andersy005"},{"id":"dcamron","nameParsed":{"literal":"Drew Camron","given":"Drew","family":"Camron"},"name":"Drew Camron","orcid":"0000-0001-7246-6502","affiliations":["Unidata"],"github":"dcamron"},{"id":"dopplershift","nameParsed":{"literal":"Ryan May","given":"Ryan","family":"May"},"name":"Ryan May","orcid":"0000-0003-2907-038X","affiliations":["Unidata"],"github":"dopplershift"},{"id":"mgrover1","nameParsed":{"literal":"Maxwell Grover","given":"Maxwell","family":"Grover"},"name":"Maxwell Grover","orcid":"0000-0002-0370-8974","affiliations":["Argonne"],"github":"mgrover1"},{"id":"r-ford","nameParsed":{"literal":"Robert R. Ford","given":"Robert R.","family":"Ford"},"name":"Robert R. Ford","orcid":"0000-0001-5483-4965","affiliations":["UAlbany"],"github":"r-ford"},{"id":"kmpaul","nameParsed":{"literal":"Kevin Paul","given":"Kevin","family":"Paul"},"name":"Kevin Paul","orcid":"0000-0001-8155-8038","affiliations":["NVIDIA"],"github":"kmpaul"},{"id":"jnmorley","nameParsed":{"literal":"James Morley","given":"James","family":"Morley"},"name":"James Morley","orcid":"0009-0005-5193-7981","github":"jnmorley"},{"id":"erogluorhan","nameParsed":{"literal":"Orhan Eroglu","given":"Orhan","family":"Eroglu"},"name":"Orhan Eroglu","orcid":"0000-0003-3099-8775","affiliations":["CISL"],"github":"erogluorhan"},{"id":"lkailynncar","nameParsed":{"literal":"Lily Kailyn","given":"Lily","family":"Kailyn"},"name":"Lily Kailyn","orcid":"0009-0002-0125-5091","affiliations":["CISL"],"github":"lkailynncar"},{"id":"anissa111","nameParsed":{"literal":"Anissa Zacharias","given":"Anissa","family":"Zacharias"},"name":"Anissa Zacharias","orcid":"0000-0002-2666-8493","affiliations":["CISL"],"github":"anissa111"},{"id":"kafitzgerald","nameParsed":{"literal":"Katelyn FitzGerald","given":"Katelyn","family":"FitzGerald"},"name":"Katelyn FitzGerald","orcid":"0000-0003-4184-1917","affiliations":["CISL"],"github":"kafitzgerald"}],"github":"https://github.com/projectpythia/landsatproduct-cookbook","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"copyright":"2025","references":{"foundations":{"url":"https://foundations.projectpythia.org"},"xarray":{"url":"https://docs.xarray.dev/en/stable"},"matplotlib":{"url":"https://matplotlib.org/stable"}},"thebe":{"binder":{"url":"https://mybinder.org/","provider":"github","repo":"projectpythia/cookbook-template","ref":"HEAD"}},"toc":[{"file":"README.md"},{"children":[{"file":"notebooks/how-to-cite.md"}],"title":"Preamble"},{"file":"notebooks/preprocessing.ipynb"},{"file":"notebooks/calibration.ipynb"},{"file":"notebooks/validation_step1.ipynb"},{"file":"notebooks/validation_p2.ipynb"}],"thumbnail":"/landsatproduct-cookbook/build/cookbook_schem_genev-ef1ec07afdd1ca226f8ed87944bfef8a.png","exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"Preamble"},{"slug":"notebooks.how-to-cite","title":"How to Cite This Cookbook","description":"","date":"","thumbnail":"/landsatproduct-cookbook/build/72a08caa5cbe5f9cce5999dbd1a81dfd.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.preprocessing","title":"Preprocessing data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"notebooks.calibration","title":"Calibration","description":"","date":"2025-08-08","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"notebooks.validation-step1","title":"Validating your data product","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"notebooks.validation-p2","title":"Validation","description":"","date":"","thumbnail":"/landsatproduct-cookbook/build/7f5ce2075ca8bde52118602eb0344051.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/landsatproduct-cookbook"},"routes/$":{"config":{"version":2,"myst":"1.6.0","options":{"favicon":"/landsatproduct-cookbook/build/config-item-9b3afca6-8add067388d4603368978412fc18e5a3.ico","logo":"/landsatproduct-cookbook/build/config-item-24692dda-9b1a51be2ae3a53260985b36368ad409.svg","logo_dark":"/landsatproduct-cookbook/build/config-item-84d6d338-309dcf57210f339d5431e4d63b7c9f82.svg","logo_url":"https://projectpythia.org","analytics_google":"G-T52X8HNYE8","folders":true},"parts":{},"nav":[{"title":"Home","url":"https://projectpythia.org"},{"title":"Foundations","url":"https://foundations.projectpythia.org"},{"title":"Cookbooks","url":"https://cookbooks.projectpythia.org/"},{"title":"Resources","url":"https://projectpythia.org/resource-gallery/"},{"title":"Community","url":"https://projectpythia.org/#join-us"}],"actions":[{"title":"Project Pythia","url":"https://projectpythia.org","internal":false,"static":false}],"projects":[{"open_access":true,"license":{"content":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"title":"Raw Pixels to Products","authors":[{"nameParsed":{"literal":"Tasha Snow","given":"Tasha","family":"Snow"},"name":"Tasha Snow","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Kathryn Moore","given":"Kathryn","family":"Moore"},"name":"Kathryn Moore","id":"contributors-myst-generated-uid-1"},{"nameParsed":{"literal":"Genevieve Clow","given":"Genevieve","family":"Clow"},"name":"Genevieve Clow","id":"contributors-myst-generated-uid-2"},{"nameParsed":{"literal":"Jianwen Du","given":"Jianwen","family":"Du"},"name":"Jianwen Du","id":"contributors-myst-generated-uid-3"},{"nameParsed":{"literal":"Arman Oliazneeh","given":"Arman","family":"Oliazneeh"},"name":"Arman Oliazneeh","id":"contributors-myst-generated-uid-4"}],"contributors":[{"id":"brian-rose","nameParsed":{"literal":"Brian E. J. Rose","given":"Brian E. J.","family":"Rose"},"name":"Brian E. J. Rose","orcid":"0000-0002-9961-3821","email":"brose@albany.edu","affiliations":["UAlbany"],"url":"https://brian-rose.github.io","github":"brian-rose","bluesky":"@brianejrose.bsky.social","linkedin":"https://www.linkedin.com/in/brian-rose-37bb55106/"},{"id":"clyne","nameParsed":{"literal":"John Clyne","given":"John","family":"Clyne"},"name":"John Clyne","orcid":"0000-0003-2788-9017","affiliations":["CISL"],"github":"clyne"},{"id":"jukent","nameParsed":{"literal":"Julia Kent","given":"Julia","family":"Kent"},"name":"Julia Kent","orcid":"0000-0002-5611-8986","affiliations":["CISL"],"github":"jukent"},{"id":"ktyle","nameParsed":{"literal":"Kevin Tyle","given":"Kevin","family":"Tyle"},"name":"Kevin Tyle","orcid":"0000-0001-5249-9665","affiliations":["UAlbany"],"github":"ktyle"},{"id":"andersy005","nameParsed":{"literal":"Anderson Banihirwe","given":"Anderson","family":"Banihirwe"},"name":"Anderson Banihirwe","orcid":"0000-0001-6583-571X","affiliations":["CarbonPlan"],"github":"andersy005"},{"id":"dcamron","nameParsed":{"literal":"Drew Camron","given":"Drew","family":"Camron"},"name":"Drew Camron","orcid":"0000-0001-7246-6502","affiliations":["Unidata"],"github":"dcamron"},{"id":"dopplershift","nameParsed":{"literal":"Ryan May","given":"Ryan","family":"May"},"name":"Ryan May","orcid":"0000-0003-2907-038X","affiliations":["Unidata"],"github":"dopplershift"},{"id":"mgrover1","nameParsed":{"literal":"Maxwell Grover","given":"Maxwell","family":"Grover"},"name":"Maxwell Grover","orcid":"0000-0002-0370-8974","affiliations":["Argonne"],"github":"mgrover1"},{"id":"r-ford","nameParsed":{"literal":"Robert R. Ford","given":"Robert R.","family":"Ford"},"name":"Robert R. Ford","orcid":"0000-0001-5483-4965","affiliations":["UAlbany"],"github":"r-ford"},{"id":"kmpaul","nameParsed":{"literal":"Kevin Paul","given":"Kevin","family":"Paul"},"name":"Kevin Paul","orcid":"0000-0001-8155-8038","affiliations":["NVIDIA"],"github":"kmpaul"},{"id":"jnmorley","nameParsed":{"literal":"James Morley","given":"James","family":"Morley"},"name":"James Morley","orcid":"0009-0005-5193-7981","github":"jnmorley"},{"id":"erogluorhan","nameParsed":{"literal":"Orhan Eroglu","given":"Orhan","family":"Eroglu"},"name":"Orhan Eroglu","orcid":"0000-0003-3099-8775","affiliations":["CISL"],"github":"erogluorhan"},{"id":"lkailynncar","nameParsed":{"literal":"Lily Kailyn","given":"Lily","family":"Kailyn"},"name":"Lily Kailyn","orcid":"0009-0002-0125-5091","affiliations":["CISL"],"github":"lkailynncar"},{"id":"anissa111","nameParsed":{"literal":"Anissa Zacharias","given":"Anissa","family":"Zacharias"},"name":"Anissa Zacharias","orcid":"0000-0002-2666-8493","affiliations":["CISL"],"github":"anissa111"},{"id":"kafitzgerald","nameParsed":{"literal":"Katelyn FitzGerald","given":"Katelyn","family":"FitzGerald"},"name":"Katelyn FitzGerald","orcid":"0000-0003-4184-1917","affiliations":["CISL"],"github":"kafitzgerald"}],"github":"https://github.com/projectpythia/landsatproduct-cookbook","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"copyright":"2025","references":{"foundations":{"url":"https://foundations.projectpythia.org"},"xarray":{"url":"https://docs.xarray.dev/en/stable"},"matplotlib":{"url":"https://matplotlib.org/stable"}},"thebe":{"binder":{"url":"https://mybinder.org/","provider":"github","repo":"projectpythia/cookbook-template","ref":"HEAD"}},"toc":[{"file":"README.md"},{"children":[{"file":"notebooks/how-to-cite.md"}],"title":"Preamble"},{"file":"notebooks/preprocessing.ipynb"},{"file":"notebooks/calibration.ipynb"},{"file":"notebooks/validation_step1.ipynb"},{"file":"notebooks/validation_p2.ipynb"}],"thumbnail":"/landsatproduct-cookbook/build/cookbook_schem_genev-ef1ec07afdd1ca226f8ed87944bfef8a.png","exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"Preamble"},{"slug":"notebooks.how-to-cite","title":"How to Cite This Cookbook","description":"","date":"","thumbnail":"/landsatproduct-cookbook/build/72a08caa5cbe5f9cce5999dbd1a81dfd.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.preprocessing","title":"Preprocessing data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"notebooks.calibration","title":"Calibration","description":"","date":"2025-08-08","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"notebooks.validation-step1","title":"Validating your data product","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"notebooks.validation-p2","title":"Validation","description":"","date":"","thumbnail":"/landsatproduct-cookbook/build/7f5ce2075ca8bde52118602eb0344051.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}]},"page":{"version":2,"kind":"Notebook","sha256":"2aa5eab3c1b0293b8959d9bfdce2782fb1d2d00a42de6733c3ebe3f59ef1b0a8","slug":"notebooks.validation-step1","location":"/notebooks/validation_step1.ipynb","dependencies":[],"frontmatter":{"title":"Validating your data product","authors":[{"nameParsed":{"literal":"Genevive Clow","given":"Genevive","family":"Clow"},"name":"Genevive Clow","id":"contributors-validation_step1-generated-uid-0"}],"kernelspec":{"name":"python3","display_name":"Python 3 (ipykernel)","language":"python"},"open_access":true,"license":{"content":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"github":"https://github.com/projectpythia/landsatproduct-cookbook","copyright":"2025","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"edit_url":"https://github.com/projectpythia/landsatproduct-cookbook/blob/main/notebooks/validation_step1.ipynb","exports":[{"format":"ipynb","filename":"validation_step1.ipynb","url":"/landsatproduct-cookbook/build/validation_step1-c7cbfd6a75ba80251f7fd398ffad2c3f.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"#%pip install xarray==2024.05.0","key":"IYVYYCCQEL"},{"type":"output","id":"hKYLGNoJGmXuElQKUsoAe","data":[],"key":"qOsL6GG9z3"}],"key":"Ur93KxHiAe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Imports\n#%pip install pykrige\n#%pip install xarray\n# %pip install xarray==2024.05.0\n\n%matplotlib widget\n\n%load_ext autoreload\n%autoreload 2\n","key":"Eozh4CZOZN"},{"type":"output","id":"C3gXWQVVntU2bHZ0OsWko","data":[],"key":"LkLfPmDG42"}],"key":"vc65UtnPlm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport matplotlib.pyplot as plt\nfrom matplotlib.colors import Normalize\nfrom mpl_toolkits.mplot3d import Axes3D\n#from skimage import exposure\n#from skimage.io import imsave, imread\n#from osgeo import ogr\nimport pystac_client\nfrom pyproj import Transformer\nfrom datetime import date, timedelta, datetime\nfrom dateutil.relativedelta import relativedelta\nimport geopandas as gpd\nimport pandas as pd\nimport geoviews as gv\nimport hvplot.pandas\nimport intake\nimport xarray as xr\nimport numpy as np\nfrom numpy.random import default_rng\nimport intake\nfrom pyproj import Proj, transform\n#from osgeo import gdal\nfrom sklearn.neighbors import BallTree\nimport earthaccess\nimport gzip\nimport s3fs","key":"xrbzcbAAyQ"},{"type":"output","id":"HhP4FK5bmSlLpxOnoRxwa","data":[{"output_type":"display_data","metadata":{},"data":{"text/html":{"content":"\u003cscript type=\"esms-options\"\u003e{\"shimMode\": true}\u003c/script\u003e\u003cstyle\u003e*[data-root-id],\n*[data-root-id] \u003e * {\n  box-sizing: border-box;\n  font-family: var(--jp-ui-font-family);\n  font-size: var(--jp-ui-font-size1);\n  color: var(--vscode-editor-foreground, var(--jp-ui-font-color1));\n}\n\n/* Override VSCode background color */\n.cell-output-ipywidget-background:has(\n  \u003e .cell-output-ipywidget-background \u003e .lm-Widget \u003e *[data-root-id]\n),\n.cell-output-ipywidget-background:has(\u003e .lm-Widget \u003e *[data-root-id]) {\n  background-color: transparent !important;\n}\n\u003c/style\u003e","content_type":"text/html"}}},{"output_type":"display_data","metadata":{},"data":{"application/javascript":{"content":"(function(root) {\n  function now() {\n    return new Date();\n  }\n\n  const force = true;\n  const py_version = '3.7.3'.replace('rc', '-rc.').replace('.dev', '-dev.');\n  const reloading = false;\n  const Bokeh = root.Bokeh;\n\n  // Set a timeout for this load but only if we are not already initializing\n  if (typeof (root._bokeh_timeout) === \"undefined\" || (force || !root._bokeh_is_initializing)) {\n    root._bokeh_timeout = Date.now() + 5000;\n    root._bokeh_failed_load = false;\n  }\n\n  function run_callbacks() {\n    try {\n      root._bokeh_onload_callbacks.forEach(function(callback) {\n        if (callback != null)\n          callback();\n      });\n    } finally {\n      delete root._bokeh_onload_callbacks;\n    }\n    console.debug(\"Bokeh: all callbacks have finished\");\n  }\n\n  function load_libs(css_urls, js_urls, js_modules, js_exports, callback) {\n    if (css_urls == null) css_urls = [];\n    if (js_urls == null) js_urls = [];\n    if (js_modules == null) js_modules = [];\n    if (js_exports == null) js_exports = {};\n\n    root._bokeh_onload_callbacks.push(callback);\n\n    if (root._bokeh_is_loading \u003e 0) {\n      // Don't load bokeh if it is still initializing\n      console.debug(\"Bokeh: BokehJS is being loaded, scheduling callback at\", now());\n      return null;\n    } else if (js_urls.length === 0 \u0026\u0026 js_modules.length === 0 \u0026\u0026 Object.keys(js_exports).length === 0) {\n      // There is nothing to load\n      run_callbacks();\n      return null;\n    }\n\n    function on_load() {\n      root._bokeh_is_loading--;\n      if (root._bokeh_is_loading === 0) {\n        console.debug(\"Bokeh: all BokehJS libraries/stylesheets loaded\");\n        run_callbacks()\n      }\n    }\n    window._bokeh_on_load = on_load\n\n    function on_error(e) {\n      const src_el = e.srcElement\n      console.error(\"failed to load \" + (src_el.href || src_el.src));\n    }\n\n    const skip = [];\n    if (window.requirejs) {\n      window.requirejs.config({'packages': {}, 'paths': {}, 'shim': {}});\n      root._bokeh_is_loading = css_urls.length + 0;\n    } else {\n      root._bokeh_is_loading = css_urls.length + js_urls.length + js_modules.length + Object.keys(js_exports).length;\n    }\n\n    const existing_stylesheets = []\n    const links = document.getElementsByTagName('link')\n    for (let i = 0; i \u003c links.length; i++) {\n      const link = links[i]\n      if (link.href != null) {\n        existing_stylesheets.push(link.href)\n      }\n    }\n    for (let i = 0; i \u003c css_urls.length; i++) {\n      const url = css_urls[i];\n      const escaped = encodeURI(url)\n      if (existing_stylesheets.indexOf(escaped) !== -1) {\n        on_load()\n        continue;\n      }\n      const element = document.createElement(\"link\");\n      element.onload = on_load;\n      element.onerror = on_error;\n      element.rel = \"stylesheet\";\n      element.type = \"text/css\";\n      element.href = url;\n      console.debug(\"Bokeh: injecting link tag for BokehJS stylesheet: \", url);\n      document.body.appendChild(element);\n    }    var existing_scripts = []\n    const scripts = document.getElementsByTagName('script')\n    for (let i = 0; i \u003c scripts.length; i++) {\n      var script = scripts[i]\n      if (script.src != null) {\n        existing_scripts.push(script.src)\n      }\n    }\n    for (let i = 0; i \u003c js_urls.length; i++) {\n      const url = js_urls[i];\n      const escaped = encodeURI(url)\n      if (skip.indexOf(escaped) !== -1 || existing_scripts.indexOf(escaped) !== -1) {\n        if (!window.requirejs) {\n          on_load();\n        }\n        continue;\n      }\n      const element = document.createElement('script');\n      element.onload = on_load;\n      element.onerror = on_error;\n      element.async = false;\n      element.src = url;\n      console.debug(\"Bokeh: injecting script tag for BokehJS library: \", url);\n      document.head.appendChild(element);\n    }\n    for (let i = 0; i \u003c js_modules.length; i++) {\n      const url = js_modules[i];\n      const escaped = encodeURI(url)\n      if (skip.indexOf(escaped) !== -1 || existing_scripts.indexOf(escaped) !== -1) {\n        if (!window.requirejs) {\n          on_load();\n        }\n        continue;\n      }\n      var element = document.createElement('script');\n      element.onload = on_load;\n      element.onerror = on_error;\n      element.async = false;\n      element.src = url;\n      element.type = \"module\";\n      console.debug(\"Bokeh: injecting script tag for BokehJS library: \", url);\n      document.head.appendChild(element);\n    }\n    for (const name in js_exports) {\n      const url = js_exports[name];\n      const escaped = encodeURI(url)\n      if (skip.indexOf(escaped) \u003e= 0 || root[name] != null) {\n        if (!window.requirejs) {\n          on_load();\n        }\n        continue;\n      }\n      var element = document.createElement('script');\n      element.onerror = on_error;\n      element.async = false;\n      element.type = \"module\";\n      console.debug(\"Bokeh: injecting script tag for BokehJS library: \", url);\n      element.textContent = `\n      import ${name} from \"${url}\"\n      window.${name} = ${name}\n      window._bokeh_on_load()\n      `\n      document.head.appendChild(element);\n    }\n    if (!js_urls.length \u0026\u0026 !js_modules.length) {\n      on_load()\n    }\n  };\n\n  function inject_raw_css(css) {\n    const element = document.createElement(\"style\");\n    element.appendChild(document.createTextNode(css));\n    document.body.appendChild(element);\n  }\n\n  const js_urls = [\"https://cdn.holoviz.org/panel/1.7.5/dist/bundled/reactiveesm/es-module-shims@^1.10.0/dist/es-module-shims.min.js\", \"https://cdn.bokeh.org/bokeh/release/bokeh-3.7.3.min.js\", \"https://cdn.bokeh.org/bokeh/release/bokeh-gl-3.7.3.min.js\", \"https://cdn.bokeh.org/bokeh/release/bokeh-widgets-3.7.3.min.js\", \"https://cdn.bokeh.org/bokeh/release/bokeh-tables-3.7.3.min.js\", \"https://cdn.holoviz.org/panel/1.7.5/dist/panel.min.js\", \"https://cdn.jsdelivr.net/npm/@holoviz/geoviews@1.14.0/dist/geoviews.min.js\"];\n  const js_modules = [];\n  const js_exports = {};\n  const css_urls = [];\n  const inline_js = [    function(Bokeh) {\n      Bokeh.set_log_level(\"info\");\n    },\nfunction(Bokeh) {} // ensure no trailing comma for IE\n  ];\n\n  function run_inline_js() {\n    if ((root.Bokeh !== undefined) || (force === true)) {\n      for (let i = 0; i \u003c inline_js.length; i++) {\n        try {\n          inline_js[i].call(root, root.Bokeh);\n        } catch(e) {\n          if (!reloading) {\n            throw e;\n          }\n        }\n      }\n      // Cache old bokeh versions\n      if (Bokeh != undefined \u0026\u0026 !reloading) {\n        var NewBokeh = root.Bokeh;\n        if (Bokeh.versions === undefined) {\n          Bokeh.versions = new Map();\n        }\n        if (NewBokeh.version !== Bokeh.version) {\n          Bokeh.versions.set(NewBokeh.version, NewBokeh)\n        }\n        root.Bokeh = Bokeh;\n      }\n    } else if (Date.now() \u003c root._bokeh_timeout) {\n      setTimeout(run_inline_js, 100);\n    } else if (!root._bokeh_failed_load) {\n      console.log(\"Bokeh: BokehJS failed to load within specified timeout.\");\n      root._bokeh_failed_load = true;\n    }\n    root._bokeh_is_initializing = false\n  }\n\n  function load_or_wait() {\n    // Implement a backoff loop that tries to ensure we do not load multiple\n    // versions of Bokeh and its dependencies at the same time.\n    // In recent versions we use the root._bokeh_is_initializing flag\n    // to determine whether there is an ongoing attempt to initialize\n    // bokeh, however for backward compatibility we also try to ensure\n    // that we do not start loading a newer (Panel\u003e=1.0 and Bokeh\u003e3) version\n    // before older versions are fully initialized.\n    if (root._bokeh_is_initializing \u0026\u0026 Date.now() \u003e root._bokeh_timeout) {\n      // If the timeout and bokeh was not successfully loaded we reset\n      // everything and try loading again\n      root._bokeh_timeout = Date.now() + 5000;\n      root._bokeh_is_initializing = false;\n      root._bokeh_onload_callbacks = undefined;\n      root._bokeh_is_loading = 0\n      console.log(\"Bokeh: BokehJS was loaded multiple times but one version failed to initialize.\");\n      load_or_wait();\n    } else if (root._bokeh_is_initializing || (typeof root._bokeh_is_initializing === \"undefined\" \u0026\u0026 root._bokeh_onload_callbacks !== undefined)) {\n      setTimeout(load_or_wait, 100);\n    } else {\n      root._bokeh_is_initializing = true\n      root._bokeh_onload_callbacks = []\n      const bokeh_loaded = root.Bokeh != null \u0026\u0026 (root.Bokeh.version === py_version || (root.Bokeh.versions !== undefined \u0026\u0026 root.Bokeh.versions.has(py_version)));\n      if (!reloading \u0026\u0026 !bokeh_loaded) {\n        if (root.Bokeh) {\n          root.Bokeh = undefined;\n        }\n        console.debug(\"Bokeh: BokehJS not loaded, scheduling load and callback at\", now());\n      }\n      load_libs(css_urls, js_urls, js_modules, js_exports, function() {\n        console.debug(\"Bokeh: BokehJS plotting callback run at\", now());\n        run_inline_js();\n      });\n    }\n  }\n  // Give older versions of the autoload script a head-start to ensure\n  // they initialize before we start loading newer version.\n  setTimeout(load_or_wait, 100)\n}(window));","content_type":"application/javascript"},"application/vnd.holoviews_load.v0+json":{"content":"(function(root) {\n  function now() {\n    return new Date();\n  }\n\n  const force = true;\n  const py_version = '3.7.3'.replace('rc', '-rc.').replace('.dev', '-dev.');\n  const reloading = false;\n  const Bokeh = root.Bokeh;\n\n  // Set a timeout for this load but only if we are not already initializing\n  if (typeof (root._bokeh_timeout) === \"undefined\" || (force || !root._bokeh_is_initializing)) {\n    root._bokeh_timeout = Date.now() + 5000;\n    root._bokeh_failed_load = false;\n  }\n\n  function run_callbacks() {\n    try {\n      root._bokeh_onload_callbacks.forEach(function(callback) {\n        if (callback != null)\n          callback();\n      });\n    } finally {\n      delete root._bokeh_onload_callbacks;\n    }\n    console.debug(\"Bokeh: all callbacks have finished\");\n  }\n\n  function load_libs(css_urls, js_urls, js_modules, js_exports, callback) {\n    if (css_urls == null) css_urls = [];\n    if (js_urls == null) js_urls = [];\n    if (js_modules == null) js_modules = [];\n    if (js_exports == null) js_exports = {};\n\n    root._bokeh_onload_callbacks.push(callback);\n\n    if (root._bokeh_is_loading \u003e 0) {\n      // Don't load bokeh if it is still initializing\n      console.debug(\"Bokeh: BokehJS is being loaded, scheduling callback at\", now());\n      return null;\n    } else if (js_urls.length === 0 \u0026\u0026 js_modules.length === 0 \u0026\u0026 Object.keys(js_exports).length === 0) {\n      // There is nothing to load\n      run_callbacks();\n      return null;\n    }\n\n    function on_load() {\n      root._bokeh_is_loading--;\n      if (root._bokeh_is_loading === 0) {\n        console.debug(\"Bokeh: all BokehJS libraries/stylesheets loaded\");\n        run_callbacks()\n      }\n    }\n    window._bokeh_on_load = on_load\n\n    function on_error(e) {\n      const src_el = e.srcElement\n      console.error(\"failed to load \" + (src_el.href || src_el.src));\n    }\n\n    const skip = [];\n    if (window.requirejs) {\n      window.requirejs.config({'packages': {}, 'paths': {}, 'shim': {}});\n      root._bokeh_is_loading = css_urls.length + 0;\n    } else {\n      root._bokeh_is_loading = css_urls.length + js_urls.length + js_modules.length + Object.keys(js_exports).length;\n    }\n\n    const existing_stylesheets = []\n    const links = document.getElementsByTagName('link')\n    for (let i = 0; i \u003c links.length; i++) {\n      const link = links[i]\n      if (link.href != null) {\n        existing_stylesheets.push(link.href)\n      }\n    }\n    for (let i = 0; i \u003c css_urls.length; i++) {\n      const url = css_urls[i];\n      const escaped = encodeURI(url)\n      if (existing_stylesheets.indexOf(escaped) !== -1) {\n        on_load()\n        continue;\n      }\n      const element = document.createElement(\"link\");\n      element.onload = on_load;\n      element.onerror = on_error;\n      element.rel = \"stylesheet\";\n      element.type = \"text/css\";\n      element.href = url;\n      console.debug(\"Bokeh: injecting link tag for BokehJS stylesheet: \", url);\n      document.body.appendChild(element);\n    }    var existing_scripts = []\n    const scripts = document.getElementsByTagName('script')\n    for (let i = 0; i \u003c scripts.length; i++) {\n      var script = scripts[i]\n      if (script.src != null) {\n        existing_scripts.push(script.src)\n      }\n    }\n    for (let i = 0; i \u003c js_urls.length; i++) {\n      const url = js_urls[i];\n      const escaped = encodeURI(url)\n      if (skip.indexOf(escaped) !== -1 || existing_scripts.indexOf(escaped) !== -1) {\n        if (!window.requirejs) {\n          on_load();\n        }\n        continue;\n      }\n      const element = document.createElement('script');\n      element.onload = on_load;\n      element.onerror = on_error;\n      element.async = false;\n      element.src = url;\n      console.debug(\"Bokeh: injecting script tag for BokehJS library: \", url);\n      document.head.appendChild(element);\n    }\n    for (let i = 0; i \u003c js_modules.length; i++) {\n      const url = js_modules[i];\n      const escaped = encodeURI(url)\n      if (skip.indexOf(escaped) !== -1 || existing_scripts.indexOf(escaped) !== -1) {\n        if (!window.requirejs) {\n          on_load();\n        }\n        continue;\n      }\n      var element = document.createElement('script');\n      element.onload = on_load;\n      element.onerror = on_error;\n      element.async = false;\n      element.src = url;\n      element.type = \"module\";\n      console.debug(\"Bokeh: injecting script tag for BokehJS library: \", url);\n      document.head.appendChild(element);\n    }\n    for (const name in js_exports) {\n      const url = js_exports[name];\n      const escaped = encodeURI(url)\n      if (skip.indexOf(escaped) \u003e= 0 || root[name] != null) {\n        if (!window.requirejs) {\n          on_load();\n        }\n        continue;\n      }\n      var element = document.createElement('script');\n      element.onerror = on_error;\n      element.async = false;\n      element.type = \"module\";\n      console.debug(\"Bokeh: injecting script tag for BokehJS library: \", url);\n      element.textContent = `\n      import ${name} from \"${url}\"\n      window.${name} = ${name}\n      window._bokeh_on_load()\n      `\n      document.head.appendChild(element);\n    }\n    if (!js_urls.length \u0026\u0026 !js_modules.length) {\n      on_load()\n    }\n  };\n\n  function inject_raw_css(css) {\n    const element = document.createElement(\"style\");\n    element.appendChild(document.createTextNode(css));\n    document.body.appendChild(element);\n  }\n\n  const js_urls = [\"https://cdn.holoviz.org/panel/1.7.5/dist/bundled/reactiveesm/es-module-shims@^1.10.0/dist/es-module-shims.min.js\", \"https://cdn.bokeh.org/bokeh/release/bokeh-3.7.3.min.js\", \"https://cdn.bokeh.org/bokeh/release/bokeh-gl-3.7.3.min.js\", \"https://cdn.bokeh.org/bokeh/release/bokeh-widgets-3.7.3.min.js\", \"https://cdn.bokeh.org/bokeh/release/bokeh-tables-3.7.3.min.js\", \"https://cdn.holoviz.org/panel/1.7.5/dist/panel.min.js\", \"https://cdn.jsdelivr.net/npm/@holoviz/geoviews@1.14.0/dist/geoviews.min.js\"];\n  const js_modules = [];\n  const js_exports = {};\n  const css_urls = [];\n  const inline_js = [    function(Bokeh) {\n      Bokeh.set_log_level(\"info\");\n    },\nfunction(Bokeh) {} // ensure no trailing comma for IE\n  ];\n\n  function run_inline_js() {\n    if ((root.Bokeh !== undefined) || (force === true)) {\n      for (let i = 0; i \u003c inline_js.length; i++) {\n        try {\n          inline_js[i].call(root, root.Bokeh);\n        } catch(e) {\n          if (!reloading) {\n            throw e;\n          }\n        }\n      }\n      // Cache old bokeh versions\n      if (Bokeh != undefined \u0026\u0026 !reloading) {\n        var NewBokeh = root.Bokeh;\n        if (Bokeh.versions === undefined) {\n          Bokeh.versions = new Map();\n        }\n        if (NewBokeh.version !== Bokeh.version) {\n          Bokeh.versions.set(NewBokeh.version, NewBokeh)\n        }\n        root.Bokeh = Bokeh;\n      }\n    } else if (Date.now() \u003c root._bokeh_timeout) {\n      setTimeout(run_inline_js, 100);\n    } else if (!root._bokeh_failed_load) {\n      console.log(\"Bokeh: BokehJS failed to load within specified timeout.\");\n      root._bokeh_failed_load = true;\n    }\n    root._bokeh_is_initializing = false\n  }\n\n  function load_or_wait() {\n    // Implement a backoff loop that tries to ensure we do not load multiple\n    // versions of Bokeh and its dependencies at the same time.\n    // In recent versions we use the root._bokeh_is_initializing flag\n    // to determine whether there is an ongoing attempt to initialize\n    // bokeh, however for backward compatibility we also try to ensure\n    // that we do not start loading a newer (Panel\u003e=1.0 and Bokeh\u003e3) version\n    // before older versions are fully initialized.\n    if (root._bokeh_is_initializing \u0026\u0026 Date.now() \u003e root._bokeh_timeout) {\n      // If the timeout and bokeh was not successfully loaded we reset\n      // everything and try loading again\n      root._bokeh_timeout = Date.now() + 5000;\n      root._bokeh_is_initializing = false;\n      root._bokeh_onload_callbacks = undefined;\n      root._bokeh_is_loading = 0\n      console.log(\"Bokeh: BokehJS was loaded multiple times but one version failed to initialize.\");\n      load_or_wait();\n    } else if (root._bokeh_is_initializing || (typeof root._bokeh_is_initializing === \"undefined\" \u0026\u0026 root._bokeh_onload_callbacks !== undefined)) {\n      setTimeout(load_or_wait, 100);\n    } else {\n      root._bokeh_is_initializing = true\n      root._bokeh_onload_callbacks = []\n      const bokeh_loaded = root.Bokeh != null \u0026\u0026 (root.Bokeh.version === py_version || (root.Bokeh.versions !== undefined \u0026\u0026 root.Bokeh.versions.has(py_version)));\n      if (!reloading \u0026\u0026 !bokeh_loaded) {\n        if (root.Bokeh) {\n          root.Bokeh = undefined;\n        }\n        console.debug(\"Bokeh: BokehJS not loaded, scheduling load and callback at\", now());\n      }\n      load_libs(css_urls, js_urls, js_modules, js_exports, function() {\n        console.debug(\"Bokeh: BokehJS plotting callback run at\", now());\n        run_inline_js();\n      });\n    }\n  }\n  // Give older versions of the autoload script a head-start to ensure\n  // they initialize before we start loading newer version.\n  setTimeout(load_or_wait, 100)\n}(window));","content_type":"application/vnd.holoviews_load.v0+json"}}},{"output_type":"display_data","metadata":{},"data":{"application/vnd.holoviews_load.v0+json":{"content":"\nif ((window.PyViz === undefined) || (window.PyViz instanceof HTMLElement)) {\n  window.PyViz = {comms: {}, comm_status:{}, kernels:{}, receivers: {}, plot_index: []}\n}\n\n\n    function JupyterCommManager() {\n    }\n\n    JupyterCommManager.prototype.register_target = function(plot_id, comm_id, msg_handler) {\n      if (window.comm_manager || ((window.Jupyter !== undefined) \u0026\u0026 (Jupyter.notebook.kernel != null))) {\n        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;\n        comm_manager.register_target(comm_id, function(comm) {\n          comm.on_msg(msg_handler);\n        });\n      } else if ((plot_id in window.PyViz.kernels) \u0026\u0026 (window.PyViz.kernels[plot_id])) {\n        window.PyViz.kernels[plot_id].registerCommTarget(comm_id, function(comm) {\n          comm.onMsg = msg_handler;\n        });\n      } else if (typeof google != 'undefined' \u0026\u0026 google.colab.kernel != null) {\n        google.colab.kernel.comms.registerTarget(comm_id, (comm) =\u003e {\n          var messages = comm.messages[Symbol.asyncIterator]();\n          function processIteratorResult(result) {\n            var message = result.value;\n            var content = {data: message.data, comm_id};\n            var buffers = []\n            for (var buffer of message.buffers || []) {\n              buffers.push(new DataView(buffer))\n            }\n            var metadata = message.metadata || {};\n            var msg = {content, buffers, metadata}\n            msg_handler(msg);\n            return messages.next().then(processIteratorResult);\n          }\n          return messages.next().then(processIteratorResult);\n        })\n      }\n    }\n\n    JupyterCommManager.prototype.get_client_comm = function(plot_id, comm_id, msg_handler) {\n      if (comm_id in window.PyViz.comms) {\n        return window.PyViz.comms[comm_id];\n      } else if (window.comm_manager || ((window.Jupyter !== undefined) \u0026\u0026 (Jupyter.notebook.kernel != null))) {\n        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;\n        var comm = comm_manager.new_comm(comm_id, {}, {}, {}, comm_id);\n        if (msg_handler) {\n          comm.on_msg(msg_handler);\n        }\n      } else if ((plot_id in window.PyViz.kernels) \u0026\u0026 (window.PyViz.kernels[plot_id])) {\n        var comm = window.PyViz.kernels[plot_id].connectToComm(comm_id);\n        let retries = 0;\n        const open = () =\u003e {\n          if (comm.active) {\n            comm.open();\n          } else if (retries \u003e 3) {\n            console.warn('Comm target never activated')\n          } else {\n            retries += 1\n            setTimeout(open, 500)\n          }\n        }\n        if (comm.active) {\n          comm.open();\n        } else {\n          setTimeout(open, 500)\n        }\n        if (msg_handler) {\n          comm.onMsg = msg_handler;\n        }\n      } else if (typeof google != 'undefined' \u0026\u0026 google.colab.kernel != null) {\n        var comm_promise = google.colab.kernel.comms.open(comm_id)\n        comm_promise.then((comm) =\u003e {\n          window.PyViz.comms[comm_id] = comm;\n          if (msg_handler) {\n            var messages = comm.messages[Symbol.asyncIterator]();\n            function processIteratorResult(result) {\n              var message = result.value;\n              var content = {data: message.data};\n              var metadata = message.metadata || {comm_id};\n              var msg = {content, metadata}\n              msg_handler(msg);\n              return messages.next().then(processIteratorResult);\n            }\n            return messages.next().then(processIteratorResult);\n          }\n        })\n        var sendClosure = (data, metadata, buffers, disposeOnDone) =\u003e {\n          return comm_promise.then((comm) =\u003e {\n            comm.send(data, metadata, buffers, disposeOnDone);\n          });\n        };\n        var comm = {\n          send: sendClosure\n        };\n      }\n      window.PyViz.comms[comm_id] = comm;\n      return comm;\n    }\n    window.PyViz.comm_manager = new JupyterCommManager();\n    \n\n\nvar JS_MIME_TYPE = 'application/javascript';\nvar HTML_MIME_TYPE = 'text/html';\nvar EXEC_MIME_TYPE = 'application/vnd.holoviews_exec.v0+json';\nvar CLASS_NAME = 'output';\n\n/**\n * Render data to the DOM node\n */\nfunction render(props, node) {\n  var div = document.createElement(\"div\");\n  var script = document.createElement(\"script\");\n  node.appendChild(div);\n  node.appendChild(script);\n}\n\n/**\n * Handle when a new output is added\n */\nfunction handle_add_output(event, handle) {\n  var output_area = handle.output_area;\n  var output = handle.output;\n  if ((output.data == undefined) || (!output.data.hasOwnProperty(EXEC_MIME_TYPE))) {\n    return\n  }\n  var id = output.metadata[EXEC_MIME_TYPE][\"id\"];\n  var toinsert = output_area.element.find(\".\" + CLASS_NAME.split(' ')[0]);\n  if (id !== undefined) {\n    var nchildren = toinsert.length;\n    var html_node = toinsert[nchildren-1].children[0];\n    html_node.innerHTML = output.data[HTML_MIME_TYPE];\n    var scripts = [];\n    var nodelist = html_node.querySelectorAll(\"script\");\n    for (var i in nodelist) {\n      if (nodelist.hasOwnProperty(i)) {\n        scripts.push(nodelist[i])\n      }\n    }\n\n    scripts.forEach( function (oldScript) {\n      var newScript = document.createElement(\"script\");\n      var attrs = [];\n      var nodemap = oldScript.attributes;\n      for (var j in nodemap) {\n        if (nodemap.hasOwnProperty(j)) {\n          attrs.push(nodemap[j])\n        }\n      }\n      attrs.forEach(function(attr) { newScript.setAttribute(attr.name, attr.value) });\n      newScript.appendChild(document.createTextNode(oldScript.innerHTML));\n      oldScript.parentNode.replaceChild(newScript, oldScript);\n    });\n    if (JS_MIME_TYPE in output.data) {\n      toinsert[nchildren-1].children[1].textContent = output.data[JS_MIME_TYPE];\n    }\n    output_area._hv_plot_id = id;\n    if ((window.Bokeh !== undefined) \u0026\u0026 (id in Bokeh.index)) {\n      window.PyViz.plot_index[id] = Bokeh.index[id];\n    } else {\n      window.PyViz.plot_index[id] = null;\n    }\n  } else if (output.metadata[EXEC_MIME_TYPE][\"server_id\"] !== undefined) {\n    var bk_div = document.createElement(\"div\");\n    bk_div.innerHTML = output.data[HTML_MIME_TYPE];\n    var script_attrs = bk_div.children[0].attributes;\n    for (var i = 0; i \u003c script_attrs.length; i++) {\n      toinsert[toinsert.length - 1].childNodes[1].setAttribute(script_attrs[i].name, script_attrs[i].value);\n    }\n    // store reference to server id on output_area\n    output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE][\"server_id\"];\n  }\n}\n\n/**\n * Handle when an output is cleared or removed\n */\nfunction handle_clear_output(event, handle) {\n  var id = handle.cell.output_area._hv_plot_id;\n  var server_id = handle.cell.output_area._bokeh_server_id;\n  if (((id === undefined) || !(id in PyViz.plot_index)) \u0026\u0026 (server_id !== undefined)) { return; }\n  var comm = window.PyViz.comm_manager.get_client_comm(\"hv-extension-comm\", \"hv-extension-comm\", function () {});\n  if (server_id !== null) {\n    comm.send({event_type: 'server_delete', 'id': server_id});\n    return;\n  } else if (comm !== null) {\n    comm.send({event_type: 'delete', 'id': id});\n  }\n  delete PyViz.plot_index[id];\n  if ((window.Bokeh !== undefined) \u0026 (id in window.Bokeh.index)) {\n    var doc = window.Bokeh.index[id].model.document\n    doc.clear();\n    const i = window.Bokeh.documents.indexOf(doc);\n    if (i \u003e -1) {\n      window.Bokeh.documents.splice(i, 1);\n    }\n  }\n}\n\n/**\n * Handle kernel restart event\n */\nfunction handle_kernel_cleanup(event, handle) {\n  delete PyViz.comms[\"hv-extension-comm\"];\n  window.PyViz.plot_index = {}\n}\n\n/**\n * Handle update_display_data messages\n */\nfunction handle_update_output(event, handle) {\n  handle_clear_output(event, {cell: {output_area: handle.output_area}})\n  handle_add_output(event, handle)\n}\n\nfunction register_renderer(events, OutputArea) {\n  function append_mime(data, metadata, element) {\n    // create a DOM node to render to\n    var toinsert = this.create_output_subarea(\n    metadata,\n    CLASS_NAME,\n    EXEC_MIME_TYPE\n    );\n    this.keyboard_manager.register_events(toinsert);\n    // Render to node\n    var props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};\n    render(props, toinsert[0]);\n    element.append(toinsert);\n    return toinsert\n  }\n\n  events.on('output_added.OutputArea', handle_add_output);\n  events.on('output_updated.OutputArea', handle_update_output);\n  events.on('clear_output.CodeCell', handle_clear_output);\n  events.on('delete.Cell', handle_clear_output);\n  events.on('kernel_ready.Kernel', handle_kernel_cleanup);\n\n  OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {\n    safe: true,\n    index: 0\n  });\n}\n\nif (window.Jupyter !== undefined) {\n  try {\n    var events = require('base/js/events');\n    var OutputArea = require('notebook/js/outputarea').OutputArea;\n    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {\n      register_renderer(events, OutputArea);\n    }\n  } catch(err) {\n  }\n}\n","content_type":"application/vnd.holoviews_load.v0+json"},"application/javascript":{"content":"\nif ((window.PyViz === undefined) || (window.PyViz instanceof HTMLElement)) {\n  window.PyViz = {comms: {}, comm_status:{}, kernels:{}, receivers: {}, plot_index: []}\n}\n\n\n    function JupyterCommManager() {\n    }\n\n    JupyterCommManager.prototype.register_target = function(plot_id, comm_id, msg_handler) {\n      if (window.comm_manager || ((window.Jupyter !== undefined) \u0026\u0026 (Jupyter.notebook.kernel != null))) {\n        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;\n        comm_manager.register_target(comm_id, function(comm) {\n          comm.on_msg(msg_handler);\n        });\n      } else if ((plot_id in window.PyViz.kernels) \u0026\u0026 (window.PyViz.kernels[plot_id])) {\n        window.PyViz.kernels[plot_id].registerCommTarget(comm_id, function(comm) {\n          comm.onMsg = msg_handler;\n        });\n      } else if (typeof google != 'undefined' \u0026\u0026 google.colab.kernel != null) {\n        google.colab.kernel.comms.registerTarget(comm_id, (comm) =\u003e {\n          var messages = comm.messages[Symbol.asyncIterator]();\n          function processIteratorResult(result) {\n            var message = result.value;\n            var content = {data: message.data, comm_id};\n            var buffers = []\n            for (var buffer of message.buffers || []) {\n              buffers.push(new DataView(buffer))\n            }\n            var metadata = message.metadata || {};\n            var msg = {content, buffers, metadata}\n            msg_handler(msg);\n            return messages.next().then(processIteratorResult);\n          }\n          return messages.next().then(processIteratorResult);\n        })\n      }\n    }\n\n    JupyterCommManager.prototype.get_client_comm = function(plot_id, comm_id, msg_handler) {\n      if (comm_id in window.PyViz.comms) {\n        return window.PyViz.comms[comm_id];\n      } else if (window.comm_manager || ((window.Jupyter !== undefined) \u0026\u0026 (Jupyter.notebook.kernel != null))) {\n        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;\n        var comm = comm_manager.new_comm(comm_id, {}, {}, {}, comm_id);\n        if (msg_handler) {\n          comm.on_msg(msg_handler);\n        }\n      } else if ((plot_id in window.PyViz.kernels) \u0026\u0026 (window.PyViz.kernels[plot_id])) {\n        var comm = window.PyViz.kernels[plot_id].connectToComm(comm_id);\n        let retries = 0;\n        const open = () =\u003e {\n          if (comm.active) {\n            comm.open();\n          } else if (retries \u003e 3) {\n            console.warn('Comm target never activated')\n          } else {\n            retries += 1\n            setTimeout(open, 500)\n          }\n        }\n        if (comm.active) {\n          comm.open();\n        } else {\n          setTimeout(open, 500)\n        }\n        if (msg_handler) {\n          comm.onMsg = msg_handler;\n        }\n      } else if (typeof google != 'undefined' \u0026\u0026 google.colab.kernel != null) {\n        var comm_promise = google.colab.kernel.comms.open(comm_id)\n        comm_promise.then((comm) =\u003e {\n          window.PyViz.comms[comm_id] = comm;\n          if (msg_handler) {\n            var messages = comm.messages[Symbol.asyncIterator]();\n            function processIteratorResult(result) {\n              var message = result.value;\n              var content = {data: message.data};\n              var metadata = message.metadata || {comm_id};\n              var msg = {content, metadata}\n              msg_handler(msg);\n              return messages.next().then(processIteratorResult);\n            }\n            return messages.next().then(processIteratorResult);\n          }\n        })\n        var sendClosure = (data, metadata, buffers, disposeOnDone) =\u003e {\n          return comm_promise.then((comm) =\u003e {\n            comm.send(data, metadata, buffers, disposeOnDone);\n          });\n        };\n        var comm = {\n          send: sendClosure\n        };\n      }\n      window.PyViz.comms[comm_id] = comm;\n      return comm;\n    }\n    window.PyViz.comm_manager = new JupyterCommManager();\n    \n\n\nvar JS_MIME_TYPE = 'application/javascript';\nvar HTML_MIME_TYPE = 'text/html';\nvar EXEC_MIME_TYPE = 'application/vnd.holoviews_exec.v0+json';\nvar CLASS_NAME = 'output';\n\n/**\n * Render data to the DOM node\n */\nfunction render(props, node) {\n  var div = document.createElement(\"div\");\n  var script = document.createElement(\"script\");\n  node.appendChild(div);\n  node.appendChild(script);\n}\n\n/**\n * Handle when a new output is added\n */\nfunction handle_add_output(event, handle) {\n  var output_area = handle.output_area;\n  var output = handle.output;\n  if ((output.data == undefined) || (!output.data.hasOwnProperty(EXEC_MIME_TYPE))) {\n    return\n  }\n  var id = output.metadata[EXEC_MIME_TYPE][\"id\"];\n  var toinsert = output_area.element.find(\".\" + CLASS_NAME.split(' ')[0]);\n  if (id !== undefined) {\n    var nchildren = toinsert.length;\n    var html_node = toinsert[nchildren-1].children[0];\n    html_node.innerHTML = output.data[HTML_MIME_TYPE];\n    var scripts = [];\n    var nodelist = html_node.querySelectorAll(\"script\");\n    for (var i in nodelist) {\n      if (nodelist.hasOwnProperty(i)) {\n        scripts.push(nodelist[i])\n      }\n    }\n\n    scripts.forEach( function (oldScript) {\n      var newScript = document.createElement(\"script\");\n      var attrs = [];\n      var nodemap = oldScript.attributes;\n      for (var j in nodemap) {\n        if (nodemap.hasOwnProperty(j)) {\n          attrs.push(nodemap[j])\n        }\n      }\n      attrs.forEach(function(attr) { newScript.setAttribute(attr.name, attr.value) });\n      newScript.appendChild(document.createTextNode(oldScript.innerHTML));\n      oldScript.parentNode.replaceChild(newScript, oldScript);\n    });\n    if (JS_MIME_TYPE in output.data) {\n      toinsert[nchildren-1].children[1].textContent = output.data[JS_MIME_TYPE];\n    }\n    output_area._hv_plot_id = id;\n    if ((window.Bokeh !== undefined) \u0026\u0026 (id in Bokeh.index)) {\n      window.PyViz.plot_index[id] = Bokeh.index[id];\n    } else {\n      window.PyViz.plot_index[id] = null;\n    }\n  } else if (output.metadata[EXEC_MIME_TYPE][\"server_id\"] !== undefined) {\n    var bk_div = document.createElement(\"div\");\n    bk_div.innerHTML = output.data[HTML_MIME_TYPE];\n    var script_attrs = bk_div.children[0].attributes;\n    for (var i = 0; i \u003c script_attrs.length; i++) {\n      toinsert[toinsert.length - 1].childNodes[1].setAttribute(script_attrs[i].name, script_attrs[i].value);\n    }\n    // store reference to server id on output_area\n    output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE][\"server_id\"];\n  }\n}\n\n/**\n * Handle when an output is cleared or removed\n */\nfunction handle_clear_output(event, handle) {\n  var id = handle.cell.output_area._hv_plot_id;\n  var server_id = handle.cell.output_area._bokeh_server_id;\n  if (((id === undefined) || !(id in PyViz.plot_index)) \u0026\u0026 (server_id !== undefined)) { return; }\n  var comm = window.PyViz.comm_manager.get_client_comm(\"hv-extension-comm\", \"hv-extension-comm\", function () {});\n  if (server_id !== null) {\n    comm.send({event_type: 'server_delete', 'id': server_id});\n    return;\n  } else if (comm !== null) {\n    comm.send({event_type: 'delete', 'id': id});\n  }\n  delete PyViz.plot_index[id];\n  if ((window.Bokeh !== undefined) \u0026 (id in window.Bokeh.index)) {\n    var doc = window.Bokeh.index[id].model.document\n    doc.clear();\n    const i = window.Bokeh.documents.indexOf(doc);\n    if (i \u003e -1) {\n      window.Bokeh.documents.splice(i, 1);\n    }\n  }\n}\n\n/**\n * Handle kernel restart event\n */\nfunction handle_kernel_cleanup(event, handle) {\n  delete PyViz.comms[\"hv-extension-comm\"];\n  window.PyViz.plot_index = {}\n}\n\n/**\n * Handle update_display_data messages\n */\nfunction handle_update_output(event, handle) {\n  handle_clear_output(event, {cell: {output_area: handle.output_area}})\n  handle_add_output(event, handle)\n}\n\nfunction register_renderer(events, OutputArea) {\n  function append_mime(data, metadata, element) {\n    // create a DOM node to render to\n    var toinsert = this.create_output_subarea(\n    metadata,\n    CLASS_NAME,\n    EXEC_MIME_TYPE\n    );\n    this.keyboard_manager.register_events(toinsert);\n    // Render to node\n    var props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};\n    render(props, toinsert[0]);\n    element.append(toinsert);\n    return toinsert\n  }\n\n  events.on('output_added.OutputArea', handle_add_output);\n  events.on('output_updated.OutputArea', handle_update_output);\n  events.on('clear_output.CodeCell', handle_clear_output);\n  events.on('delete.Cell', handle_clear_output);\n  events.on('kernel_ready.Kernel', handle_kernel_cleanup);\n\n  OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {\n    safe: true,\n    index: 0\n  });\n}\n\nif (window.Jupyter !== undefined) {\n  try {\n    var events = require('base/js/events');\n    var OutputArea = require('notebook/js/outputarea').OutputArea;\n    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {\n      register_renderer(events, OutputArea);\n    }\n  } catch(err) {\n  }\n}\n","content_type":"application/javascript"}}},{"output_type":"display_data","metadata":{"application/vnd.holoviews_exec.v0+json":{"id":"372f98c2-1f2c-4506-9458-553419e66bbb"}},"data":{"text/html":{"content":"\u003cdiv id='372f98c2-1f2c-4506-9458-553419e66bbb'\u003e\n  \u003cdiv id=\"da4ef610-ed65-4eb4-9200-4f633c624ca6\" data-root-id=\"372f98c2-1f2c-4506-9458-553419e66bbb\" style=\"display: contents;\"\u003e\u003c/div\u003e\n\u003c/div\u003e\n\u003cscript type=\"application/javascript\"\u003e(function(root) {\n  var docs_json = {\"d79b9167-c506-4b74-b0fc-2c55bd8d7334\":{\"version\":\"3.7.3\",\"title\":\"Bokeh Application\",\"roots\":[{\"type\":\"object\",\"name\":\"panel.models.browser.BrowserInfo\",\"id\":\"372f98c2-1f2c-4506-9458-553419e66bbb\"},{\"type\":\"object\",\"name\":\"panel.models.comm_manager.CommManager\",\"id\":\"70eb7271-0b73-4d91-ad06-1fc4861f039d\",\"attributes\":{\"plot_id\":\"372f98c2-1f2c-4506-9458-553419e66bbb\",\"comm_id\":\"4045f5ea87794704a592884638abfecf\",\"client_comm_id\":\"6bc8cfe8ebe54dbc8a464707c79d29d0\"}}],\"defs\":[{\"type\":\"model\",\"name\":\"ReactiveHTML1\"},{\"type\":\"model\",\"name\":\"FlexBox1\",\"properties\":[{\"name\":\"align_content\",\"kind\":\"Any\",\"default\":\"flex-start\"},{\"name\":\"align_items\",\"kind\":\"Any\",\"default\":\"flex-start\"},{\"name\":\"flex_direction\",\"kind\":\"Any\",\"default\":\"row\"},{\"name\":\"flex_wrap\",\"kind\":\"Any\",\"default\":\"wrap\"},{\"name\":\"gap\",\"kind\":\"Any\",\"default\":\"\"},{\"name\":\"justify_content\",\"kind\":\"Any\",\"default\":\"flex-start\"}]},{\"type\":\"model\",\"name\":\"FloatPanel1\",\"properties\":[{\"name\":\"config\",\"kind\":\"Any\",\"default\":{\"type\":\"map\"}},{\"name\":\"contained\",\"kind\":\"Any\",\"default\":true},{\"name\":\"position\",\"kind\":\"Any\",\"default\":\"right-top\"},{\"name\":\"offsetx\",\"kind\":\"Any\",\"default\":null},{\"name\":\"offsety\",\"kind\":\"Any\",\"default\":null},{\"name\":\"theme\",\"kind\":\"Any\",\"default\":\"primary\"},{\"name\":\"status\",\"kind\":\"Any\",\"default\":\"normalized\"}]},{\"type\":\"model\",\"name\":\"GridStack1\",\"properties\":[{\"name\":\"ncols\",\"kind\":\"Any\",\"default\":null},{\"name\":\"nrows\",\"kind\":\"Any\",\"default\":null},{\"name\":\"allow_resize\",\"kind\":\"Any\",\"default\":true},{\"name\":\"allow_drag\",\"kind\":\"Any\",\"default\":true},{\"name\":\"state\",\"kind\":\"Any\",\"default\":[]}]},{\"type\":\"model\",\"name\":\"drag1\",\"properties\":[{\"name\":\"slider_width\",\"kind\":\"Any\",\"default\":5},{\"name\":\"slider_color\",\"kind\":\"Any\",\"default\":\"black\"},{\"name\":\"value\",\"kind\":\"Any\",\"default\":50}]},{\"type\":\"model\",\"name\":\"click1\",\"properties\":[{\"name\":\"terminal_output\",\"kind\":\"Any\",\"default\":\"\"},{\"name\":\"debug_name\",\"kind\":\"Any\",\"default\":\"\"},{\"name\":\"clears\",\"kind\":\"Any\",\"default\":0}]},{\"type\":\"model\",\"name\":\"ReactiveESM1\",\"properties\":[{\"name\":\"esm_constants\",\"kind\":\"Any\",\"default\":{\"type\":\"map\"}}]},{\"type\":\"model\",\"name\":\"JSComponent1\",\"properties\":[{\"name\":\"esm_constants\",\"kind\":\"Any\",\"default\":{\"type\":\"map\"}}]},{\"type\":\"model\",\"name\":\"ReactComponent1\",\"properties\":[{\"name\":\"use_shadow_dom\",\"kind\":\"Any\",\"default\":true},{\"name\":\"esm_constants\",\"kind\":\"Any\",\"default\":{\"type\":\"map\"}}]},{\"type\":\"model\",\"name\":\"AnyWidgetComponent1\",\"properties\":[{\"name\":\"use_shadow_dom\",\"kind\":\"Any\",\"default\":true},{\"name\":\"esm_constants\",\"kind\":\"Any\",\"default\":{\"type\":\"map\"}}]},{\"type\":\"model\",\"name\":\"FastWrapper1\",\"properties\":[{\"name\":\"object\",\"kind\":\"Any\",\"default\":null},{\"name\":\"style\",\"kind\":\"Any\",\"default\":null}]},{\"type\":\"model\",\"name\":\"NotificationArea1\",\"properties\":[{\"name\":\"js_events\",\"kind\":\"Any\",\"default\":{\"type\":\"map\"}},{\"name\":\"max_notifications\",\"kind\":\"Any\",\"default\":5},{\"name\":\"notifications\",\"kind\":\"Any\",\"default\":[]},{\"name\":\"position\",\"kind\":\"Any\",\"default\":\"bottom-right\"},{\"name\":\"_clear\",\"kind\":\"Any\",\"default\":0},{\"name\":\"types\",\"kind\":\"Any\",\"default\":[{\"type\":\"map\",\"entries\":[[\"type\",\"warning\"],[\"background\",\"#ffc107\"],[\"icon\",{\"type\":\"map\",\"entries\":[[\"className\",\"fas fa-exclamation-triangle\"],[\"tagName\",\"i\"],[\"color\",\"white\"]]}]]},{\"type\":\"map\",\"entries\":[[\"type\",\"info\"],[\"background\",\"#007bff\"],[\"icon\",{\"type\":\"map\",\"entries\":[[\"className\",\"fas fa-info-circle\"],[\"tagName\",\"i\"],[\"color\",\"white\"]]}]]}]}]},{\"type\":\"model\",\"name\":\"Notification\",\"properties\":[{\"name\":\"background\",\"kind\":\"Any\",\"default\":null},{\"name\":\"duration\",\"kind\":\"Any\",\"default\":3000},{\"name\":\"icon\",\"kind\":\"Any\",\"default\":null},{\"name\":\"message\",\"kind\":\"Any\",\"default\":\"\"},{\"name\":\"notification_type\",\"kind\":\"Any\",\"default\":null},{\"name\":\"_rendered\",\"kind\":\"Any\",\"default\":false},{\"name\":\"_destroyed\",\"kind\":\"Any\",\"default\":false}]},{\"type\":\"model\",\"name\":\"TemplateActions1\",\"properties\":[{\"name\":\"open_modal\",\"kind\":\"Any\",\"default\":0},{\"name\":\"close_modal\",\"kind\":\"Any\",\"default\":0}]},{\"type\":\"model\",\"name\":\"BootstrapTemplateActions1\",\"properties\":[{\"name\":\"open_modal\",\"kind\":\"Any\",\"default\":0},{\"name\":\"close_modal\",\"kind\":\"Any\",\"default\":0}]},{\"type\":\"model\",\"name\":\"TemplateEditor1\",\"properties\":[{\"name\":\"layout\",\"kind\":\"Any\",\"default\":[]}]},{\"type\":\"model\",\"name\":\"MaterialTemplateActions1\",\"properties\":[{\"name\":\"open_modal\",\"kind\":\"Any\",\"default\":0},{\"name\":\"close_modal\",\"kind\":\"Any\",\"default\":0}]},{\"type\":\"model\",\"name\":\"request_value1\",\"properties\":[{\"name\":\"fill\",\"kind\":\"Any\",\"default\":\"none\"},{\"name\":\"_synced\",\"kind\":\"Any\",\"default\":null},{\"name\":\"_request_sync\",\"kind\":\"Any\",\"default\":0}]},{\"type\":\"model\",\"name\":\"holoviews.plotting.bokeh.raster.HoverModel\",\"properties\":[{\"name\":\"xy\",\"kind\":\"Any\",\"default\":null},{\"name\":\"data\",\"kind\":\"Any\",\"default\":null}]}]}};\n  var render_items = [{\"docid\":\"d79b9167-c506-4b74-b0fc-2c55bd8d7334\",\"roots\":{\"372f98c2-1f2c-4506-9458-553419e66bbb\":\"da4ef610-ed65-4eb4-9200-4f633c624ca6\"},\"root_ids\":[\"372f98c2-1f2c-4506-9458-553419e66bbb\"]}];\n  var docs = Object.values(docs_json)\n  if (!docs) {\n    return\n  }\n  const py_version = docs[0].version.replace('rc', '-rc.').replace('.dev', '-dev.')\n  async function embed_document(root) {\n    var Bokeh = get_bokeh(root)\n    await Bokeh.embed.embed_items_notebook(docs_json, render_items);\n    for (const render_item of render_items) {\n      for (const root_id of render_item.root_ids) {\n\tconst id_el = document.getElementById(root_id)\n\tif (id_el.children.length \u0026\u0026 id_el.children[0].hasAttribute('data-root-id')) {\n\t  const root_el = id_el.children[0]\n\t  root_el.id = root_el.id + '-rendered'\n\t  for (const child of root_el.children) {\n            // Ensure JupyterLab does not capture keyboard shortcuts\n            // see: https://jupyterlab.readthedocs.io/en/4.1.x/extension/notebook.html#keyboard-interaction-model\n\t    child.setAttribute('data-lm-suppress-shortcuts', 'true')\n\t  }\n\t}\n      }\n    }\n  }\n  function get_bokeh(root) {\n    if (root.Bokeh === undefined) {\n      return null\n    } else if (root.Bokeh.version !== py_version) {\n      if (root.Bokeh.versions === undefined || !root.Bokeh.versions.has(py_version)) {\n\treturn null\n      }\n      return root.Bokeh.versions.get(py_version);\n    } else if (root.Bokeh.version === py_version) {\n      return root.Bokeh\n    }\n    return null\n  }\n  function is_loaded(root) {\n    var Bokeh = get_bokeh(root)\n    return (Bokeh != null \u0026\u0026 Bokeh.Panel !== undefined)\n  }\n  if (is_loaded(root)) {\n    embed_document(root);\n  } else {\n    var attempts = 0;\n    var timer = setInterval(function(root) {\n      if (is_loaded(root)) {\n        clearInterval(timer);\n        embed_document(root);\n      } else if (document.readyState == \"complete\") {\n        attempts++;\n        if (attempts \u003e 200) {\n          clearInterval(timer);\n\t  var Bokeh = get_bokeh(root)\n\t  if (Bokeh == null || Bokeh.Panel == null) {\n            console.warn(\"Panel: ERROR: Unable to run Panel code because Bokeh or Panel library is missing\");\n\t  } else {\n\t    console.warn(\"Panel: WARNING: Attempting to render but not all required libraries could be resolved.\")\n\t    embed_document(root)\n\t  }\n        }\n      }\n    }, 25, root)\n  }\n})(window);\u003c/script\u003e","content_type":"text/html"},"application/vnd.holoviews_exec.v0+json":{"content":"","content_type":"application/vnd.holoviews_exec.v0+json"}}}],"key":"TOuyJZOaxN"}],"key":"AsU8u8rUG0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# for progress bar\nfrom ipywidgets import IntProgress\nfrom IPython.display import display\nfrom ipywidgets import interact, Dropdown\nimport time\nfrom tqdm.notebook import trange, tqdm\n\nimport boto3\nimport rasterio as rio\nfrom rasterio.features import rasterize\nfrom rasterio.session import AWSSession\nimport dask\nimport os\nimport rioxarray\nfrom rasterio.enums import Resampling\nfrom rasterio.warp import reproject\nfrom rasterio.warp import Resampling as resample\nimport cartopy.crs as ccrs\nimport cartopy\n#from pykrige.ok import OrdinaryKriging\nfrom sklearn.linear_model import LinearRegression, RANSACRegressor\nfrom scipy.odr import Model, RealData, ODR\nimport scipy.odr as odr\nimport scipy\nimport statsmodels.formula.api as smf\nfrom shapely.geometry.polygon import Polygon, Point\nimport pygmt\nimport gc\nimport pytz\nimport pyproj\nimport math\nfrom pathlib import Path\nfrom matplotlib.patches import Polygon as Pgon\nfrom tqdm import tqdm\nfrom sklearn.preprocessing import RobustScaler\nfrom sklearn.preprocessing import StandardScaler\n\nimport SSTutils as sut\n\nimport warnings\nwarnings.filterwarnings('ignore')","key":"O5EyyHwMbQ"},{"type":"output","id":"9-QtItW9eA8TUZyTqoTGT","data":[{"output_type":"error","traceback":"\u001b[31m---------------------------------------------------------------------------\u001b[39m\n\u001b[31mModuleNotFoundError\u001b[39m                       Traceback (most recent call last)\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[4]\u001b[39m\u001b[32m, line 38\u001b[39m\n\u001b[32m     35\u001b[39m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01msklearn\u001b[39;00m\u001b[34;01m.\u001b[39;00m\u001b[34;01mpreprocessing\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m RobustScaler\n\u001b[32m     36\u001b[39m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01msklearn\u001b[39;00m\u001b[34;01m.\u001b[39;00m\u001b[34;01mpreprocessing\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m StandardScaler\n\u001b[32m---\u003e \u001b[39m\u001b[32m38\u001b[39m \u001b[38;5;28;01mimport\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mSSTutils\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mas\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01msut\u001b[39;00m\n\u001b[32m     40\u001b[39m \u001b[38;5;28;01mimport\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mwarnings\u001b[39;00m\n\u001b[32m     41\u001b[39m warnings.filterwarnings(\u001b[33m'\u001b[39m\u001b[33mignore\u001b[39m\u001b[33m'\u001b[39m)\n\n\u001b[31mModuleNotFoundError\u001b[39m: No module named 'SSTutils'","ename":"ModuleNotFoundError","evalue":"No module named 'SSTutils'"}],"key":"NqAuzvgHaT"}],"key":"bCmbwwJUf0"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Why do we need to validate?","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OBQ5bJ4Zuu"}],"identifier":"why-do-we-need-to-validate","label":"Why do we need to validate?","html_id":"why-do-we-need-to-validate","implicit":true,"key":"KVEyzOuJve"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Now we have our calibrated SST data product! 🥳 We’re almost ready to use this data product for our scientific analysis, but there is still one more important step. As a quick reminder, our data product was derived from top-of-atmosphere radiance measurements. We then converted these radiances into actual SST values (in units of temperature) by calibrating with another satellite (MODIS). But can we trust that these derived SST values are accurately reflecting real ocean surface temperatures? Validation allows us to quantitfy the uncertainty of our product.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"AoD8ZoBJnS"}],"key":"LM2tbQWCex"}],"key":"PBVfa2kf2n"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Finding data to validate with","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iDh8jH4GnU"}],"identifier":"finding-data-to-validate-with","label":"Finding data to validate with","html_id":"finding-data-to-validate-with","implicit":true,"key":"aev2Tbloro"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"When validating satellite products, we typically want to use in situ measurements: i.e., direct measurements taken in the field. For the ocean, these measurements come from buoys, ship-based thermometers and autonomous floats. An important thing to keep in mind is that while satellites measure the skin temperature (top ~10–20 microns), in situ platforms measure bulk SST (a few cm to 1 m depth).","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"RhVALDfuQc"}],"key":"eKJWBqCvT4"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Should be high quality!","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"mGyGcPUekE"}],"key":"rzTwxuCV5o"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Finding a good validation dataset can be tricky. Here’s are some lists of commonly-used validation datasets to help get you started:","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"jKtVh7HaNL"}],"key":"LkzyZbiPBm"}],"key":"nU3tn2wPC5"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"TO DO: These links need to be checked","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xVQAhTRSTB"}],"key":"mXsaFAyqia"}],"key":"YGIw5re74L"},{"type":"block","kind":"notebook-content","children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"🌊 Ocean","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ne5h9LyZqD"}],"key":"FY3in1AFSv"},{"type":"table","position":{"start":{"line":4,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Dataset","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"aTSibMVjGm"}],"key":"SFqDVL6snf"}],"key":"AHkJmlJ8lA"},{"type":"tableCell","header":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Access","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"QQGsNPYkWJ"}],"key":"dnf7ZqEFyP"}],"key":"YBFlnDy7od"},{"type":"tableCell","header":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Variables","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"SuqrmXaINa"}],"key":"bmMP9Biq4Z"}],"key":"CMECSQkKet"}],"key":"TgtlcMhJ4A"},{"type":"tableRow","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Argo","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"bsy7tL7j3y"}],"key":"eK6in04gyS"}],"key":"P7xXuYBsIy"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"link","url":"https://argo.ucsd.edu/data/acknowledging-argo/","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"argo.ucsd.edu","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"GOkv5qjqux"}],"urlSource":"https://argo.ucsd.edu/data/acknowledging-argo/","key":"UEXqjcUwk4"},{"type":"text","value":"  — DOI: ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"skTJ7HxMlY"},{"type":"cite","url":"https://doi.org/10.17882/42182","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Argo (2025)","key":"gRViwbFgzL"}],"kind":"narrative","label":"https://doi.org/10.17882/42182","identifier":"https://doi.org/10.17882/42182","enumerator":"1","key":"jRMQbnfUOi"},{"type":"text","value":" ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"R9cWgdv4DX"},{"type":"break","key":"RZ3vDHasXR"},{"type":"text","value":" ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"VAJWlyXvx1"},{"type":"link","url":"https://www.ncei.noaa.gov/access/metadata/landing-page/bin/iso?id=gov.noaa.nodc%3AArgo-Monthly","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"NOAA archive","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"dsxM8PcHug"}],"urlSource":"https://www.ncei.noaa.gov/access/metadata/landing-page/bin/iso?id=gov.noaa.nodc%3AArgo-Monthly","key":"qcc9mgJ7mt"},{"type":"text","value":" — DOI: ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"rY61gRdD8W"},{"type":"cite","url":"https://doi.org/10.25921/q97e-d719","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"10.25921/q97e‑d719","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"J6HTwofYe6"}],"kind":"narrative","label":"https://doi.org/10.25921/q97e-d719","identifier":"https://doi.org/10.25921/q97e-d719","enumerator":"2","key":"gsRJRE8sk9"}],"key":"UuegClGWXM"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Sea surface temperature, salinity","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"VQ7k1kpzhb"}],"key":"qxtpfptZg2"}],"key":"LMGLa3SHWt"},{"type":"tableRow","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"GHRSST iQuam","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"XHaNjMIEAK"}],"key":"c3ineFjzU2"}],"key":"IhT0zszgWT"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"link","url":"https://www.star.nesdis.noaa.gov/socd/sst/iquam/","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"GHRSST iQuam website","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ZXeNHXV9f4"}],"urlSource":"https://www.star.nesdis.noaa.gov/socd/sst/iquam/","key":"dzfzyj0qaA"},{"type":"text","value":" ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"qCWowqssd2"},{"type":"break","key":"j4cYSIUKjW"},{"type":"text","value":" ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"dusVUzSAmk"},{"type":"cite","url":"https://doi.org/10.5281/zenodo.7589540","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"GHRSST documentation (Zenodo)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"urVYS8xzsy"}],"kind":"narrative","label":"https://doi.org/10.5281/zenodo.7589540","identifier":"https://doi.org/10.5281/zenodo.7589540","enumerator":"3","key":"AHchf7AVbg"}],"key":"LJKmGWsBSk"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Sea surface temperature","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"Z9RR2ju1Aq"}],"key":"nI8QD5x6ho"}],"key":"RJEJ44a80F"},{"type":"tableRow","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"GTSPP","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"YLk3bjD3d6"}],"key":"Fg5cB5zrVd"}],"key":"EQtiIaw5Re"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"link","url":"https://www.ncei.noaa.gov/products/global-temperature-salinity-profile-program","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"NCEI GTSPP access","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"CbhYrVLLSc"}],"urlSource":"https://www.ncei.noaa.gov/products/global-temperature-salinity-profile-program","key":"YcnlfRapjB"}],"key":"lQcgaVRgXW"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Temperature, salinity profiles","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"rNtHySXXKT"}],"key":"dZ7buI1M7e"}],"key":"Z7gGhbfMyc"},{"type":"tableRow","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"SPURS","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"VuHg1xIYAi"}],"key":"pUWqbQZMzB"}],"key":"m227LduffP"},{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"link","url":"https://spurs.jpl.nasa.gov/","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"SPURS homepage (NASA)","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"Ab3DeTquUB"}],"urlSource":"https://spurs.jpl.nasa.gov/","key":"asxEWVmyEM"}],"key":"n62qq5NmDX"},{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Sea surface salinity","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"xdx6VUegzu"}],"key":"Ir0hCdaLBY"}],"key":"PiIqIzECnm"},{"type":"tableRow","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"SeaBASS","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"fQJKD0ZJhQ"}],"key":"f7qAGdLVrh"}],"key":"JRg88SNMSl"},{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"link","url":"https://seabass.gsfc.nasa.gov/","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"seabass​.gsfc​.nasa​.gov","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"kibOss9JlQ"}],"urlSource":"https://seabass.gsfc.nasa.gov/","key":"S42UAdJuZo"}],"key":"febMyJPsnG"},{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Ocean color, chlorophyll-a","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"kD0DUKYeRO"}],"key":"TjUvizddW0"}],"key":"sdP1VzY8v1"},{"type":"tableRow","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"NOMAD","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"IDiWxtFXka"}],"key":"WzqkuGzCnx"}],"key":"aEeIiffLiz"},{"type":"tableCell","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"link","url":"https://www.star.nesdis.noaa.gov/socd/ocean/color/NOMAD/NOMAD.shtml","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"NOMAD at NOAA STAR","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"ZBhtc6G2dr"}],"urlSource":"https://www.star.nesdis.noaa.gov/socd/ocean/color/NOMAD/NOMAD.shtml","key":"HK7GVAGpW8"}],"key":"kAhvxc94xk"},{"type":"tableCell","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Ocean color, chlorophyll-a","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"QQqCLgzriY"}],"key":"o8urM0USfn"}],"key":"om0Ia4WZrW"},{"type":"tableRow","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"BOUSSOLE","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"i7fnJmbfcQ"}],"key":"e6645mHfZC"}],"key":"yLHDFHV1wj"},{"type":"tableCell","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"link","url":"https://www.obs-vlfr.fr/Boussole/html/home/home.php","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"BOUSSOLE Project","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"fl7lUuT7ds"}],"urlSource":"https://www.obs-vlfr.fr/Boussole/html/home/home.php","key":"H2Q5kKVXEi"}],"key":"xtZsi14X8r"},{"type":"tableCell","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Ocean color, optics, chlorophyll","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"jKYqwoXPgT"}],"key":"Qmz5wTwTk0"}],"key":"MQ7sLEjegw"},{"type":"tableRow","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"GDP (Drifters)","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"LwIHdwduCG"}],"key":"mR6QbZnHtC"}],"key":"IgA10ozgFm"},{"type":"tableCell","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"link","url":"https://www.aoml.noaa.gov/phod/gdp/","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Global Drifter Program","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"h2peVtWHyW"}],"urlSource":"https://www.aoml.noaa.gov/phod/gdp/","key":"nsRSX4f386"}],"key":"FJW451wv4W"},{"type":"tableCell","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Ocean surface currents","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"zdSOTO3Myn"}],"key":"vHj5O142Gg"}],"key":"MebQWXSKXA"},{"type":"tableRow","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"HF Radar","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"nRR6wTxaLM"}],"key":"YS3ha8vYi5"}],"key":"gCJbdqaktk"},{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"link","url":"https://hfrnet.ucsd.edu/","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"HFRNet Portal","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"ziP7MkXZqt"}],"urlSource":"https://hfrnet.ucsd.edu/","key":"ym4idO8xRG"}],"key":"ijYgHjTdCk"},{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Ocean surface currents","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"EsS7lkuCb0"}],"key":"uPKoieKek0"}],"key":"xlAWjiMO8G"},{"type":"tableRow","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"ADCP","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"YltPXPAnTp"}],"key":"aOT9hsOZac"}],"key":"AhP2i0M0E1"},{"type":"tableCell","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"link","url":"https://www.aoml.noaa.gov/phod/goos/adcp/index.php","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"NOAA ADCP Program","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"LPGnyZpMgm"}],"urlSource":"https://www.aoml.noaa.gov/phod/goos/adcp/index.php","key":"dssDSUn0oK"}],"key":"Wp0OZPDfPQ"},{"type":"tableCell","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Water column currents","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"RBfkpiiNRH"}],"key":"mGAlc3C9wx"}],"key":"BqzSB1vBUW"}],"key":"GKCe627Dsg"}],"class":"toggle","key":"kPwp9JkOp1"}],"key":"bgvmD1dNkQ"},{"type":"block","kind":"notebook-content","children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"⛅️ Atmosphere","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cUkZTkQXnI"}],"key":"RfZKUqukX5"},{"type":"table","position":{"start":{"line":4,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Dataset","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"nYvOKfzsYH"}],"key":"fWjJNM7tHo"}],"key":"dh3HgOmHMJ"},{"type":"tableCell","header":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Access","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"TNThJFfSwJ"}],"key":"g8PFMZD8p2"}],"key":"RKY91ItDZu"},{"type":"tableCell","header":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Variables","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"jDm1YoXM7l"}],"key":"HR4prYSChf"}],"key":"oYeQDsmuue"}],"key":"TGCCd0nfCO"},{"type":"tableRow","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"AERONET","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"CdaUJ1LPgs"}],"key":"d1N0AlzPgV"}],"key":"COSoaVO5nL"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"link","url":"https://aeronet.gsfc.nasa.gov/","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"aeronet​.gsfc​.nasa​.gov","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"hdZTddKnyz"}],"urlSource":"https://aeronet.gsfc.nasa.gov/","key":"qEWgqryOqo"},{"type":"text","value":" ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"o6IQ0dKmKQ"},{"type":"break","key":"JYucIC6OLE"},{"type":"text","value":" ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"KZBwzJ5jnl"},{"type":"link","url":"https://www.re3data.org/repository/r3d100011742","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"re3data entry","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"AMonCpujAS"}],"urlSource":"https://www.re3data.org/repository/r3d100011742","key":"kr3w2chgkR"}],"key":"rD5OLtEkNZ"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Aerosol optical depth (AOD), aerosol type","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"UFjc8OvPNF"}],"key":"hOw5npX6ca"}],"key":"GjZIdGn7io"},{"type":"tableRow","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"IGRA","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"UnNcVk6m9l"}],"key":"a46on1lAYL"}],"key":"oPLV0xkrAe"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"link","url":"https://www.ncei.noaa.gov/products/integrated-global-radiosonde-archive","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"IGRA at NOAA","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"xF4Uu2yy7J"}],"urlSource":"https://www.ncei.noaa.gov/products/integrated-global-radiosonde-archive","key":"BxId51b5GO"}],"key":"j8PvBCxZHw"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Atmospheric temperature, pressure","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"X0rTPBkxdR"}],"key":"hsfqYtU7ls"}],"key":"DybXhXOQ8p"},{"type":"tableRow","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"GRUAN","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"wFhrQMjtBz"}],"key":"AM2VD7iSiy"}],"key":"Wv8HD0MMlq"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"link","url":"https://www.gruan.org/","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"GRUAN","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"kkKedmiEMZ"}],"urlSource":"https://www.gruan.org/","key":"S5owFDwVJy"}],"key":"NinMjqYbpp"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Temperature, humidity, pressure","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"ihS5ZwSi91"}],"key":"fVUZg33Dh5"}],"key":"qmeVGEg30r"},{"type":"tableRow","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"METAR/ASOS","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"EvAmjUChqz"}],"key":"jQLYzmd3yt"}],"key":"z9ZB04O53I"},{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"link","url":"https://mesonet.agron.iastate.edu/request/download.phtml","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Iowa State Mesonet","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"fsFOGbjUSL"}],"urlSource":"https://mesonet.agron.iastate.edu/request/download.phtml","key":"MRXwlgYxlX"}],"key":"YXURJyviAK"},{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Surface temperature, pressure","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"c22H5eA1by"}],"key":"j0oTfszL9K"}],"key":"iXljFydj8q"},{"type":"tableRow","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"GPM-GV","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"XEmVezkqFB"}],"key":"hdnwQAfuz8"}],"key":"ZypfAMDi27"},{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"link","url":"https://gpm.nasa.gov/resources/ground-validation","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"NASA GPM Ground Validation","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"et2UumUUsq"}],"urlSource":"https://gpm.nasa.gov/resources/ground-validation","key":"mpYvPVcjrl"}],"key":"NwOgxGj7Id"},{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Precipitation","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"DwOYenmRcs"}],"key":"ScKna03Psb"}],"key":"GKSxJzMIWy"},{"type":"tableRow","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"GPCC","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"YIcVltLSdk"}],"key":"eVy0RSN9cR"}],"key":"IJ9LnxJveG"},{"type":"tableCell","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"link","url":"https://opendata.dwd.de/climate_environment/GPCC/","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"GPCC at DWD","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"jUXIxD0aGS"}],"urlSource":"https://opendata.dwd.de/climate_environment/GPCC/","key":"b69ZvbPgHs"}],"key":"f7nXHM9k7u"},{"type":"tableCell","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Precipitation","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"FwNWgcwxRF"}],"key":"JksHmEuenS"}],"key":"XKiENe0QdW"},{"type":"tableRow","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"SKYNET","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"HXsRRLSd3t"}],"key":"zdxe1nP2Kv"}],"key":"I3SXnwKXiu"},{"type":"tableCell","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"link","url":"http://atmos.cr.chiba-u.ac.jp/skynet/","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Chiba University SKYNET","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"afsalVqsFa"}],"urlSource":"http://atmos.cr.chiba-u.ac.jp/skynet/","key":"MZXIH2BegD"}],"key":"onhz3VRmpV"},{"type":"tableCell","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Aerosols, AOD","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"DzJfJjzWeZ"}],"key":"KpMm7pHP3Q"}],"key":"LwHEmiw1FU"},{"type":"tableRow","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"MPLNET","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"QuzT7hmsRC"}],"key":"AGPZyqAnl6"}],"key":"NBbnwyuxWy"},{"type":"tableCell","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"link","url":"https://mplnet.gsfc.nasa.gov/","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"MPLNET at NASA","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"RvAUtGq06V"}],"urlSource":"https://mplnet.gsfc.nasa.gov/","key":"MZWwJWJkO5"}],"key":"BRTbETTRMx"},{"type":"tableCell","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Aerosols, clouds","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"HwebbzqUQ0"}],"key":"XVxS9tb9bv"}],"key":"Q5EGpTu1Ac"},{"type":"tableRow","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"TCCON","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"vLcR0FdzPy"}],"key":"S6kHrxNXyM"}],"key":"QyfYwmbCS9"},{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"link","url":"https://tccondata.org/","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"TCCON Data Portal","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"TkmFfAjAeE"}],"urlSource":"https://tccondata.org/","key":"O9e1PtGPTZ"}],"key":"lZrvugLn0c"},{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"CO₂, CH₄, other trace gases","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"m95ApoEJBp"}],"key":"gFKtoUc1Nx"}],"key":"zzHeb4AKXV"},{"type":"tableRow","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Pandora","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"sBCIpDBtTA"}],"key":"AQKfnls5L5"}],"key":"FmdqkXkT4l"},{"type":"tableCell","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"link","url":"https://pandora.gsfc.nasa.gov/","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Pandora Project","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"VQWiUTx9v5"}],"urlSource":"https://pandora.gsfc.nasa.gov/","key":"qTnOEZkhwH"}],"key":"hciNEhUFpL"},{"type":"tableCell","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"NO₂, O₃, trace gases","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"ZuLb7qo343"}],"key":"vJxobghdDk"}],"key":"pkWmsYoxjb"},{"type":"tableRow","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"strong","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"MAX-DOAS","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"WzL8uDMOpe"}],"key":"FEBsAX6qMv"}],"key":"mcJ3arnuiy"},{"type":"tableCell","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"link","url":"https://uv-vis.aeronomie.be/maxdoas/","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"MAX-DOAS Network","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"BBEhGqVHZy"}],"urlSource":"https://uv-vis.aeronomie.be/maxdoas/","key":"R2REqGQw9p"}],"key":"yxz8VPi0jG"},{"type":"tableCell","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"NO₂, SO₂, HCHO","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"CNfa8Qk2kZ"}],"key":"fvDz4iCxvg"}],"key":"RoB95AUCDb"}],"key":"AhsUXnREkV"}],"class":"toggle","key":"n7z3BgQsCg"}],"key":"BQS1PTXjDU"},{"type":"block","kind":"notebook-content","data":{"jp-MarkdownHeadingCollapsed":true},"children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"🌳 Land","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OzM9optrK1"}],"key":"QNfJgyWO77"},{"type":"table","position":{"start":{"line":4,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Dataset","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"WBZ2YEzoSw"}],"key":"dlV5dlIjHH"}],"key":"BlxmH2fTbG"},{"type":"tableCell","header":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Access","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"uTS0QwdC3e"}],"key":"Wci1QtYt7C"}],"key":"rfdYH53zN4"},{"type":"tableCell","header":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Variables","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"uWOXEkfQie"}],"key":"n9aLoTLwqW"}],"key":"Nqf0zYkFK6"}],"key":"gBLlL4yKz3"},{"type":"tableRow","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"SURFRAD","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Lip9OJK6Sx"}],"key":"H8FDg95MZA"}],"key":"lNWIvSCB9E"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"link","url":"https://www.esrl.noaa.gov/gmd/grad/surfrad/","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"NOAA SURFRAD","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"psKjucYPuU"}],"urlSource":"https://www.esrl.noaa.gov/gmd/grad/surfrad/","key":"gSi0O6AzXt"}],"key":"IaHTFKGxhL"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Land surface temperature, radiation","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Mxhp2Imocy"}],"key":"sFJ7lPUq8r"}],"key":"rZ3G8llRi5"},{"type":"tableRow","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"BSRN","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"nMbVHT2Xpx"}],"key":"S7WSt9LQWq"}],"key":"VfR3bc4hzQ"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"link","url":"https://bsrn.awi.de/","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"BSRN","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"uaETngCuqB"}],"urlSource":"https://bsrn.awi.de/","key":"CBZyVRPlQ7"}],"key":"jIPN2LX3Z6"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Solar radiation, surface energy fluxes","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"cJcg5xlWkL"}],"key":"MpPn5Yg73y"}],"key":"mOp97uDFxH"},{"type":"tableRow","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"FLUXNET","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"L0po4kuaz0"}],"key":"UeXzlBBEPd"}],"key":"qY5H8FozXl"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"link","url":"https://fluxnet.org/","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"fluxnet.org","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"RvhVi1xfhc"}],"urlSource":"https://fluxnet.org/","key":"Dp3dRSqmnz"}],"key":"D4WtEV2W6g"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"LST, vegetation indices, fluxes","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"D34LE0MOdO"}],"key":"AW4uwOR0BN"}],"key":"gBBeVxDym5"},{"type":"tableRow","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"SCAN","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"LvmMQViVJH"}],"key":"TpeFzDtTmz"}],"key":"BhNot34wbu"},{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"link","url":"https://www.wcc.nrcs.usda.gov/scan/","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"USDA SCAN","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"x2Z9KAz95j"}],"urlSource":"https://www.wcc.nrcs.usda.gov/scan/","key":"DyIUdPfMTi"}],"key":"d9QguvowWm"},{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Soil moisture","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"W5dImeGgSG"}],"key":"e2TFhqzHpx"}],"key":"zLR27nkXat"},{"type":"tableRow","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"ISMN","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"QdebXFON9K"}],"key":"MCFtwnm4MQ"}],"key":"NF1q2HGyrV"},{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"link","url":"https://ismn.earth/","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"International Soil Moisture Network","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"T8m5jLSxkW"}],"urlSource":"https://ismn.earth/","key":"AUUdpatXUH"}],"key":"ekj5j9D2A7"},{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Soil moisture","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"ejNqsSdP0Y"}],"key":"IWwIivvi7w"}],"key":"ZF7StNAhhW"},{"type":"tableRow","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Phenocam","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"kOam9PKa2K"}],"key":"RTj0OaJ0Uo"}],"key":"eCyfwQKm93"},{"type":"tableCell","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"link","url":"https://phenocam.sr.unh.edu/","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Phenocam Network","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"NN7BnAHalb"}],"urlSource":"https://phenocam.sr.unh.edu/","key":"v7YwYpUVZj"}],"key":"kLGtBSqRCe"},{"type":"tableCell","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Vegetation phenology (NDVI proxy)","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Mw08iV2ftJ"}],"key":"fKj9osnWLx"}],"key":"ntghz4gvlS"},{"type":"tableRow","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"NEON","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"kWKetwIwcr"}],"key":"HZ3ImP6UZS"}],"key":"SqD334CJcO"},{"type":"tableCell","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"link","url":"https://www.neonscience.org/","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"NEON Data Portal","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"RvYswTgijq"}],"urlSource":"https://www.neonscience.org/","key":"aDQOJq9JST"}],"key":"YQnpaQAPvW"},{"type":"tableCell","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Vegetation indices, climate variables","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"HOZT8asCjP"}],"key":"bAJkiVcjwU"}],"key":"goLXaDD4Qi"},{"type":"tableRow","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"BELMANIP","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"gIH70N4sru"}],"key":"CBuaZRR8cX"}],"key":"zqqJgqQAlT"},{"type":"tableCell","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"link","url":"https://land.copernicus.eu/global/sites","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Copernicus Land Service","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"F6FQWWJGSM"}],"urlSource":"https://land.copernicus.eu/global/sites","key":"aZ3jsZH71r"}],"key":"Sq4GOLRETg"},{"type":"tableCell","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Leaf area index (LAI)","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Onaa454o8o"}],"key":"oCY9oDtNwj"}],"key":"wdole1gljg"},{"type":"tableRow","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"VALERI","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"aBvP9uA5cl"}],"key":"XrinRZYy2Q"}],"key":"cFKx1pg3kW"},{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"link","url":"https://w3.avignon.inrae.fr/valeri/","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"VALERI Project","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"qz8VknlTuE"}],"urlSource":"https://w3.avignon.inrae.fr/valeri/","key":"Q21JpyZhXY"}],"key":"IaX893n0w8"},{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"LAI, fAPAR","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"O9lF7ki1gf"}],"key":"YETrO2OvGj"}],"key":"jPCWJZu1QK"},{"type":"tableRow","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"strong","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"DIRECT","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"DOzzkfvzwK"}],"key":"WMOYgvKArl"}],"key":"zpFcaOZ97h"},{"type":"tableCell","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"link","url":"https://www.avignon.inrae.fr/valeri/?q=node/13","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"VALERI/DIRECT Info","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"GqFMm2lFMQ"}],"urlSource":"https://www.avignon.inrae.fr/valeri/?q=node/13","key":"bVPKiodeYl"}],"key":"ZL3UozNncM"},{"type":"tableCell","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"LAI","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"tL0qJPKgKg"}],"key":"xq3CYAlKSA"}],"key":"D4E0S3Jgyu"}],"key":"XCXTMtzCHF"}],"class":"toggle","key":"nXcBwtsAtt"}],"key":"qbODjb9M1z"},{"type":"block","kind":"notebook-content","children":[{"type":"admonition","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"❄️ Cryosphere","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wImr2XxyZo"}],"key":"FQgR9cTU5y"},{"type":"table","position":{"start":{"line":4,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"tableRow","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"tableCell","header":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Dataset","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"zB6JGwNqUm"}],"key":"dbfr9ePc4C"}],"key":"eNDdhYa2cK"},{"type":"tableCell","header":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Access","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"sMZ27Y0AGn"}],"key":"UHxyW8k54B"}],"key":"QIr1KeU5LJ"},{"type":"tableCell","header":true,"position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"strong","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Variables","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"i5RaraCQf6"}],"key":"QPe1x5mujG"}],"key":"xxrwFQCdih"}],"key":"edgxnB1qHX"},{"type":"tableRow","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"strong","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"SnowEx","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"XHoh1BRLuG"}],"key":"vqklchpcm9"}],"key":"yOOtE5H4tm"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"link","url":"https://snow.nasa.gov/campaigns/snowex","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"NASA SnowEx","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"sS2eo1mE3P"}],"urlSource":"https://snow.nasa.gov/campaigns/snowex","key":"WTbnVf2Qyf"}],"key":"GaHSlVZOal"},{"type":"tableCell","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Snow depth, snow cover, SWE","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"tplxgaE7sD"}],"key":"yE7aJruPQE"}],"key":"H5QqkMyPu8"},{"type":"tableRow","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"strong","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"CALVAL (NSIDC)","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"XN73NncSCA"}],"key":"slvoQ8MGiN"}],"key":"qcHTrtQRv1"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"link","url":"https://nsidc.org/data/calval","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"NSIDC Cal/Val","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"gbzOvVDrvd"}],"urlSource":"https://nsidc.org/data/calval","key":"tM4t2qTmvE"}],"key":"PT0WrfadMr"},{"type":"tableCell","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Snow, cryosphere","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"oZgfFxmi3D"}],"key":"uqxSETSwc6"}],"key":"jRlrQsDEz5"},{"type":"tableRow","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"strong","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"GSNOW","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"NQaHdQXqZZ"}],"key":"dpICCF5Wu7"}],"key":"ut029qcTcV"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"link","url":"https://www.ncei.noaa.gov/products/snow-cover","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"NOAA GSNOW","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"v5bnJN2LML"}],"urlSource":"https://www.ncei.noaa.gov/products/snow-cover","key":"xIKhS78WRz"}],"key":"MGtL04gN0T"},{"type":"tableCell","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Snow cover","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"Y46e9IFGqK"}],"key":"dsNPoTNzMY"}],"key":"hnVMwsOtJW"},{"type":"tableRow","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"strong","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"NSIDC","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"aIneObU3y5"}],"key":"ZgMeiDA5eB"}],"key":"BWqrX5fZYO"},{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"link","url":"https://nsidc.org/","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"NSIDC","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"ZuOBSW2S75"}],"urlSource":"https://nsidc.org/","key":"lOzeR7m2e0"}],"key":"gxB0H0orCh"},{"type":"tableCell","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Sea ice, snow cover","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"ny5D0cV4jM"}],"key":"GFcCcNnT6w"}],"key":"QChA78bPQI"},{"type":"tableRow","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"strong","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"IABP (Ice Buoys)","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"KY8TiWiq1K"}],"key":"VNDvrQDQom"}],"key":"nzWoNsTgpk"},{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"link","url":"https://iabp.apl.uw.edu/","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"International Arctic Buoy Program","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"MCbw3cbSPM"}],"urlSource":"https://iabp.apl.uw.edu/","key":"ywHOW3mnUH"}],"key":"cqPFXDsKDC"},{"type":"tableCell","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Sea ice concentration, drift","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"lUfKFsWrxF"}],"key":"LmjZ1zVrYs"}],"key":"xOw4dbaLBO"},{"type":"tableRow","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"IceBridge","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"gMiyYRUSEd"}],"key":"YEjxG5jfNi"}],"key":"sEDHQnp14q"},{"type":"tableCell","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"link","url":"https://nsidc.org/data/icebridge","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"NASA IceBridge","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"h6myVI7mP0"}],"urlSource":"https://nsidc.org/data/icebridge","key":"XUi6koAW6q"}],"key":"VJMFiZ92DC"},{"type":"tableCell","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Ice sheet elevation, thickness","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"wE8AcHY2DW"}],"key":"LWybxp7tQg"}],"key":"veWTeFTtEB"},{"type":"tableRow","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"strong","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"ATM","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"FeKDaMcOvN"}],"key":"vm74z14VtV"}],"key":"nvZ0W0xjXf"},{"type":"tableCell","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"link","url":"https://nsidc.org/data/ILATM2","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Airborne Topographic Mapper (ATM)","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"PFjgyFOovS"}],"urlSource":"https://nsidc.org/data/ILATM2","key":"LiElbNCubD"}],"key":"TOzd0zGPrB"},{"type":"tableCell","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Ice elevation profiles","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"ROvjjWSdaG"}],"key":"YAKSIYmA8C"}],"key":"lCyd0caRpY"},{"type":"tableRow","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"strong","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"NOHRSC","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"c8qwmSSJ4a"}],"key":"DarILjg3XI"}],"key":"W4N98WZUJv"},{"type":"tableCell","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"link","url":"https://www.nohrsc.noaa.gov/","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"NOAA NOHRSC","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"jRZvez3N1c"}],"urlSource":"https://www.nohrsc.noaa.gov/","key":"YGA8BFJ3rX"}],"key":"JWk1nXJMVX"},{"type":"tableCell","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Snow depth and snow water equivalent","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"jyxWVDnZVG"}],"key":"FQAohUYwWb"}],"key":"Aofzvv1AxG"},{"type":"tableRow","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"strong","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"CCSN (Canada)","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"hBc3Ye5I0o"}],"key":"qsyHZduPlQ"}],"key":"djDk4N7z23"},{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"link","url":"https://open.canada.ca/data/en/dataset/5ff9d50e-591f-4e06-9b8f-0a707e8a1a74","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Canadian Cryospheric Snow Network","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"JDebWZw5d4"}],"urlSource":"https://open.canada.ca/data/en/dataset/5ff9d50e-591f-4e06-9b8f-0a707e8a1a74","key":"JdLPa2m5J8"}],"key":"JEYuXRvIL3"},{"type":"tableCell","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Snow depth, SWE","position":{"start":{"line":14,"column":1},"end":{"line":14,"column":1}},"key":"hfxvQzFVQ4"}],"key":"Ua0Fjb2B8p"}],"key":"RScso9ojjB"}],"key":"wcPJsXeGa7"}],"class":"toggle","key":"KRlnDkPpHb"}],"key":"qScdq0sHd4"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Example: GHRSST iQUAM data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mybtnscLNQ"}],"identifier":"example-ghrsst-iquam-data","label":"Example: GHRSST iQUAM data","html_id":"example-ghrsst-iquam-data","implicit":true,"key":"xv1X5dyW5j"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"For our new SST product, we’ll use the GHRSST iQUAM dataset for validation. GHRSST is the Group for High Resolution Sea Surface Temperature – an international collaboration supporting high-quality SST products for research and operational use – and iQuam is a system developed by NOAA to collect, quality-control (QC), and distribute in situ SST observations in near real-time and delayed mode. This dataset aggregates SST measurements from a variety of in situ platforms, such as drifting buoys, moored buoys, shipboard sensors, and Argo floats.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"QBnI0aMNYK"}],"key":"gdWRclJyiQ"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"link","url":"https://www.star.nesdis.noaa.gov/socd/sst/iquam/?tab=0\u0026dateinput_year=2023\u0026dateinput_month=02\u0026dayofmoninput_day=26\u0026dateinput_hour=00\u0026dayofmon=monthly\u0026qcrefsst=_qcrey\u0026qcrefsst=_qccmc\u0026outlier=qced#qmap","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"https://​www​.star​.nesdis​.noaa​.gov​/socd​/sst​/iquam​/​?tab​=​0​\u0026​dateinput​_year​=​2023​\u0026​dateinput​_month​=​02​\u0026​dayofmoninput​_day​=​26​\u0026​dateinput​_hour​=​00​\u0026​dayofmon​=​monthly​\u0026​qcrefsst​=​​_qcrey​\u0026​qcrefsst​=​​_qccmc​\u0026​outlier​=​qced​#qmap","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"eKwWgIPsRy"}],"urlSource":"https://www.star.nesdis.noaa.gov/socd/sst/iquam/?tab=0\u0026dateinput_year=2023\u0026dateinput_month=02\u0026dayofmoninput_day=26\u0026dateinput_hour=00\u0026dayofmon=monthly\u0026qcrefsst=_qcrey\u0026qcrefsst=_qccmc\u0026outlier=qced#qmap","key":"e9jyAL51UD"}],"key":"fuzK4WoNS7"}],"key":"qDott7stbQ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":3,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Finding data matchups","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kpoQtA2lJ3"}],"identifier":"finding-data-matchups","label":"Finding data matchups","html_id":"finding-data-matchups","implicit":true,"key":"NLeZeHtFrD"}],"key":"AjGcMyQuq7"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here are some important considerations we need to make when finding matchups between the satellite product and in situ datasets:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"S1F4PusVr5"}],"key":"YWdFBgq6y5"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"🔹 ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"g04kffAGMB"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"1. Spatial Collocation","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"EjeQBW4Rni"}],"key":"OXc1yfRNi8"}],"key":"xBSJeXYOIl"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":4,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Footprint Differences: Satellite pixels often represent an area (e.g., 1 km² or more), while in situ data may be point measurements.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Prehqa5y8W"}],"key":"wO7hHE4xv0"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Solution: Use in situ data averaged over the satellite footprint or compare satellite data averaged over multiple pixels surrounding the in situ point.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"IVVfdaHfs9"}],"key":"Z9OYoWA0FT"}],"key":"pHUcTEvI5u"}],"key":"pd4WLs07TN"},{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Geolocation Accuracy: Both satellite and in situ positions should be accurately known, especially in dynamic environments (e.g., drifting buoys).","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"qkFfmG1lbo"}],"key":"rb1maflMZW"}],"key":"JJiew69mGr"},{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Environmental Variability: Spatial gradients (e.g., near coastlines or fronts) can lead to mismatches even with close locations.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"jzUsIRuvVV"}],"key":"Ck8mb6cHuc"}],"key":"bCidoW9Ik2"}],"key":"XdYAODAe3H"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"🔹 ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"jgovfsYUtQ"},{"type":"strong","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"2. Temporal Matching","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"jWtlmPj84A"}],"key":"PbeBLwOlYL"}],"key":"tJtMaaHvLq"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Temporal Resolution: Satellites provide snapshots (sometimes daily, sometimes instantaneous), while in situ data may be continuous or periodic.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"rrAHFJzE7E"}],"key":"n4xf75mFel"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"text","value":"Solution: Match satellite observation time as closely as possible to in situ sampling time (e.g., within ±1 hour).","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"EMbfm2zr44"}],"key":"qjYRFBwuac"}],"key":"kzAG8kaeBs"}],"key":"x4JWUstYCX"},{"type":"listItem","spread":true,"position":{"start":{"line":15,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Diurnal Effects: Some variables (e.g., SST, radiative fluxes) vary significantly throughout the day.","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"USSeY67a4b"}],"key":"syrOPmr2ct"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":16,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":16,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"text","value":"Solution: Use diurnal correction or only match at known overpass times (e.g., MODIS ~1:30 pm local time).","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"PMsBq7rLjR"}],"key":"wvfyYIdSAP"}],"key":"voc9HXezRQ"}],"key":"GmR43Met7a"}],"key":"FYZy7sFmZS"},{"type":"paragraph","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"🔹 ","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"rcU8uPP4F9"},{"type":"strong","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"text","value":"3. Variable Definitions and Depths","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"oxdzD99ZvH"}],"key":"gsKpQ64wRM"}],"key":"WmhgwGnIA6"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":19,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Depth Differences: For example, satellite SST represents skin temperature (top ~10–20 μm), whereas in situ sensors often measure at ~1 m.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"h6GQ5Sdr3x"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"text","value":"Solution: Apply a skin-to-bulk correction or compare to “foundation temperature” from models.","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"mXLjbsfeqw"}],"key":"G4fWVP6Zgw"}],"key":"HL6hAqK08W"}],"key":"A5k5nVlVj0"},{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"text","value":"Variable Representation: Ensure the in situ measurement is of the same quantity the satellite estimates (e.g., top-of-canopy reflectance vs. leaf-level LAI).","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"luAKOPIXbe"}],"key":"XdFuX1Qbl6"}],"key":"PGzFnKXQsU"},{"type":"paragraph","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"🔹 ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"FserJzSenz"},{"type":"strong","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"4. Quality Control","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"GzCCMQGp90"}],"key":"jqiImwVG8x"}],"key":"VyJPj8f1vU"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":24,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Flagging: Use only high-quality satellite and in situ data (e.g., use quality flags to exclude cloud-contaminated pixels or questionable sensor readings).","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"PzvFZLVZef"}],"key":"Hiyw5ftIv1"},{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Consistency in Units and Calibration: Verify that data are in the same units and reference systems (e.g., radiance vs. reflectance, SI units).","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"xTFesTHoOG"}],"key":"B1iJTuVJkI"},{"type":"listItem","spread":true,"position":{"start":{"line":26,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Error Estimates: Consider measurement uncertainty and noise in both datasets.","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"AEj778PfJT"}],"key":"uDvm9LqZR2"}],"key":"oLswBn4wiK"},{"type":"paragraph","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"🔹 ","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"ndToczDux6"},{"type":"strong","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"5. Statistical Considerations","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"A3DcQdJDLx"}],"key":"YAmkmyRJ9v"}],"key":"FCpQaLtoYj"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":29,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"Matchup Volume: A large number of matchup pairs increases robustness.","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"CdCPd7Sh8X"}],"key":"jEOww3Gk2Q"},{"type":"listItem","spread":true,"position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"text","value":"Bias and RMSE Analysis: Use metrics like bias, RMSE, and correlation to assess agreement.","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"SfqyIshIse"}],"key":"cF5FUfOsiF"},{"type":"listItem","spread":true,"position":{"start":{"line":31,"column":1},"end":{"line":32,"column":1}},"children":[{"type":"text","value":"Outlier Handling: Identify and analyze outliers to understand limitations or failure modes.","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"ZHXEM5JOAP"}],"key":"yfLrWdQ3JU"}],"key":"vVy8jwH0e6"},{"type":"paragraph","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"🔹 ","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"wkCQusBl5V"},{"type":"strong","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"text","value":"6. Sensor Calibration","position":{"start":{"line":33,"column":1},"end":{"line":33,"column":1}},"key":"mCihaP0fDx"}],"key":"DLEDpc8uBw"}],"key":"zCg8qs8ic4"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":34,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":34,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"Ensure both satellite and in situ instruments are properly calibrated and traceable to standards.","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"JiXvEC3Jdj"}],"key":"pbEuWIb8cI"}],"key":"bdW92bf0Y2"},{"type":"paragraph","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"🔹 ","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"GY2OFq6KPt"},{"type":"strong","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"7. Geophysical Context","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"boaN7Um6LY"}],"key":"HYrjcfYZTL"}],"key":"wy4cDiv2Lb"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"Geographical Diversity: Validation should include diverse regions (e.g., open ocean, coastal, tropical, polar) to capture algorithm performance globally. In our example, we are only validating our product near Antarctica, so we should only use this product in that region.","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"yZHZnx4KJy"}],"key":"ilMsQXXo0e"}],"key":"uXyR3cuYiE"}],"key":"bJNhEkb7OM"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In order to maximize the number of data matchups while still making a fair comparison, we need to determine an appropriate window in space and time. In our example, we set our spatial window to 1 km and our temporal window to half of a day:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OwIA7IU6iu"}],"key":"UgmoLg2W82"},{"type":"code","lang":"","value":"dist = 1.0\ntime_add = 0.5","position":{"start":{"line":2,"column":1},"end":{"line":5,"column":1}},"key":"RuiEL16kem"}],"key":"xF3s8ylgzk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Landsat STAC catalog location\nurl = 'https://landsatlook.usgs.gov/stac-server'\n\n# Add Jetstream2 access\njetstream_url = 'https://js2.jetstream-cloud.org:8001/'\ns3 = s3fs.S3FileSystem(anon=True, client_kwargs=dict(endpoint_url=jetstream_url))\niQfiles=s3.ls('pythia/landsat8/iQuam') \nprint(iQfiles)\n\n# Paths\nbasepath = Path('/home/jovyan/landsatproduct-cookbook')\nlsatpath = basepath / 'Data'\natmpath = lsatpath / 'AtmCorrection'\nmodout_path = lsatpath / 'MOD07_L2'\nSSTpath = lsatpath / 'SST/Validation/iQuamIntercomp/'\n#iQpath = lsatpath / 'iQuam'\n\nWV = 'Water_Vapor'\n\n# For geopandas and tile plots\nsatellite = 'Landsat8'\ncollection = 'landsat-c2l1' # Landsat Collection 2, Level 1\ncolnm = ['landsat:wrs_path','landsat:wrs_row']\ngjson_outfile = lsatpath / f'{satellite}_iQuam.geojson'\n\n# Buffer around iquam point used to create a bounding box for Landsat sample\ndist = 1.0 # km\n\n# Temporal search range (days) before/after iquam measurement for finding Landsat image\ntime_add = 0.5\n\nlthresh = -1.9\n\ninterp = 1","key":"UwsSuvMTjm"},{"type":"output","id":"UOQ5iSCOkdaeiZf1QpG_S","data":[],"key":"RLF7qsWxyx"}],"key":"EF1vrXr5RX"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Year and months desired (multiple years)\nstart_yr = 2013\nend_yr = 2023\n\n# Note these will get months from the later part of the year to early next\nstart_mo = '09'\nend_mo = '03'\n\n# Headers for the saved outputs\nheaders = ['DateTime','L8_filename','L8_SST','L8_std','center','N','S','E','W','NE','SE','NW','SW','L8_SST_max','L8_SST_min','Argo_id','Argo_SST','A_lat','A_lon']\n\n# Desired projection transformation\nsource_crs = 'epsg:4326' \ntarget_crs = 'epsg:3031' # Coordinate system of the Landsat file","key":"tUmd0b00KV"},{"type":"output","id":"QzYVtvPcs9hgP1MqgmxAB","data":[],"key":"lL19jeLj1A"}],"key":"Gz3mJ9AQOs"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Now we’re ready to find our matchups!","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Z38RNnFzOz"}],"key":"QO4TUlyOqp"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We’re repeating the retrieval step for the locations where we have data matchups.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VOFeq7gOrb"}],"key":"ZI8bOcJK5I"}],"key":"HuFaDgmL8Q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"%%time\n\n# Multiple years\n\n# Set up projections\ntransformer = Transformer.from_crs(source_crs, target_crs, always_xy=True)\n\n# Get iQuam file paths in directory between desired dates and find and produce matching Landsat SSTs \nfor year in range(start_yr, end_yr):  \n    yrmo = []\n    start_yrmo = f\"{year}{start_mo}\"  # Start from September of the current year\n    end_yrmo = f\"{year+1}{end_mo}\"  # End in March of the next year\n\n    m0 = start_yrmo\n    \n    # Make a list of months between start and end\n    while int(m0) \u003c= int(end_yrmo):\n        calc_dt = datetime.strptime(f'{m0[:4]}-{m0[4:]}', '%Y-%m')\n        yrmo.append(calc_dt.strftime(\"%Y%m\"))\n        m0 = (calc_dt + relativedelta(months=1)).strftime(\"%Y%m\")\n    \n    # Get file names and select only those matching dates from yrmo  \n    #iQfiles = os.listdir(iQpath)\n    s3path = 's3://pythia/landsat8/iQuam/*.nc'\n    iQfiles = s3.glob(s3path)\n    #s3.invalidate_cache()\n\n    #iQfiles = [x for x in iQfiles if x[:6] in yrmo]\n    iQfiles = [x for x in iQfiles if x[22:22+6] in yrmo]\n    iQfiles.sort(reverse=True)\n    print (f'{year}: {len(iQfiles)}')\n    \n    #os.chdir(iQpath)\n\n    # For each iquam file, pair West Antarctic Argo buoy data with Landsat data and create calibrated SSTs\n    valid = []\n    \n    for iquam_file in iQfiles:\n        print(iquam_file)\n        print('s3://'+iquam_file)\n        # Open Argos data from iQuam file\n        \n        df = xr.open_dataset('s3://'+iquam_file)\n        iquam = df.to_dataframe()\n        \n        # Subset to Antarctica\n        ant = iquam[(iquam.lat\u003c-65)\u0026(iquam.lon\u003e-142)\u0026(iquam.lon\u003c-72)\u0026(iquam.platform_type==5.0)\u0026(iquam.quality_level==5.0)]  # Entire West Antarctica (later)\n        # ant = iquam[(iquam.lat\u003c-69)\u0026(iquam.lon\u003e-125)\u0026(iquam.lon\u003c-98)\u0026(iquam.platform_type==5.0)\u0026(iquam.quality_level==5.0)] # Amundsen Sea\n        \n        # To remove a landsat day that is coming up with a 403 error\n        if ant['year'].iloc[0] == 2020 and ant['month'].iloc[0] == 12:\n            ant = ant[ant.day != 9.0] # for 202012 because otherwise will fail\n        \n        print('')\n        print(f'{iquam_file[:6]}: {ant.shape[0]} measurements')\n    \n        for idx in tqdm(range(ant.shape[0]), desc=\"Processing\"):\n    \n            # Create search area\n            ilat = ant['lat'].iloc[idx]\n            ilon = ant['lon'].iloc[idx]\n    \n            lat_add = sut.km_to_decimal_degrees(dist, ilat, direction='latitude')\n            lon_add = sut.km_to_decimal_degrees(dist, ilat, direction='longitude')\n            bboxV = (ilon-lon_add,ilat-lat_add,ilon+lon_add,ilat+lat_add)\n    \n            # Create Landsat temporal search range in correct format\n            ihr = int(ant.hour.iloc[idx])\n            iyr = int(ant.year.iloc[idx])\n            imo = int(ant.month.iloc[idx])\n    \n            calc_dt = datetime.strptime(f'{iyr}-{imo}-{int(ant.day.iloc[idx])} {ihr}', '%Y-%m-%d %H')\n            start_dt = (calc_dt + timedelta(days=-time_add)).strftime('%Y-%m-%dT%H:%M:%SZ')\n            end_dt = (calc_dt + timedelta(days=time_add)).strftime('%Y-%m-%dT%H:%M:%SZ')\n    \n            timeRangeV = f'{start_dt}/{end_dt}'\n    \n            # Search for desired Landsat scenes\n            items = sut.search_stac(url,collection,gjson_outfile=gjson_outfile,bbox=bboxV,timeRange=timeRangeV)\n    \n            # Load the geojson file and open stac catalog\n            catalog = intake.open_stac_item_collection(items)\n            gf = gpd.read_file(gjson_outfile)\n    \n            # Exclude Landsat 9\n            catalog_list = [x for x in items if x.id[3]=='8']\n            num_scene = len(catalog_list)\n            # print(f'{num_scene} Landsat 8 items')\n    \n            # If any matching landsat scenes are found create calibrated SSTs for them\n            if num_scene\u003e0:\n    \n                # Reproject to determine bounding box in espg 3031\n                sbox,checkbox = sut.lsat_reproj(source_crs,target_crs,(bboxV[0],bboxV[1],bboxV[2],bboxV[3]))\n    \n                # Create polygon for later cropping\n                polygon = Polygon([(sbox[0][0],sbox[0][1]),(sbox[3][0],sbox[3][1]),(sbox[2][0],sbox[2][1]),(sbox[1][0],sbox[1][1])])\n                \n                # Create min/max boundaries for trimming image before crop_xarray to cut down on processing times\n                minx, miny, maxx, maxy = polygon.bounds\n                polarx = [minx, maxx]\n                polary = [miny, maxy]\n    \n                # Create calibrated SSTs for each matching landsat scene\n                for sceneid in catalog_list:\n                    print(sceneid.id)\n    \n                    scene = catalog[sceneid.id]\n                    timestr = scene.metadata['datetime'].strftime('%H%M%S')\n    \n                    outFile = f'{SSTpath}/{sceneid.id}_{timestr}_Cel.tif'\n    \n                    if os.path.isfile(outFile):\n                        print (f'{sceneid.id} - atm corr exists')\n                        ls_scene = xr.open_dataset(outFile,chunks=dict(x=512, y=512),engine='rasterio')\n                        ls_scene = ls_scene.rio.write_crs(\"epsg:3031\", inplace=True)\n    \n                        # Subset all scenes and check for right dimensions because y order changes sometimes\n                        ls_sub = sut.subset_img(ls_scene['band_data'].sel(band=1),polarx,polary) # subset so easier to work with\n    \n                    else:\n                        # try:\n                        # Open all desired bands for one scene\n                        ls_scene = sut.landsat_to_xarray(sceneid,catalog)\n                        ls_scene = ls_scene.rio.write_crs(\"epsg:3031\", inplace=True)\n        \n                        # Create classification mask\n                        ls_scene = sut.create_masks(ls_scene, cloud_mask=True, ice_mask=True, ocean_mask=True)\n\n                        # Check for any open ocean pixels - go to next image if none - ??? s\n                        mask = np.ones(ls_scene.shape[1:])\n                        mask[ls_scene.mask!=3] = np.nan\n                        ls_thermal = ls_scene.sel(band='lwir11').compute()\n\n                        # Check in bounding box or for entire Landsat image depending on whether doing calibration runs or not\n                        ls_box = sut.subset_img(ls_thermal*mask,polarx,polary)\n\n                        if ((ls_box).notnull()).sum().values==0:\n                            print (f'{sceneid.id} has no SSTs')\n                            try:\n                                del ls_scene, scene, mask, ls_thermal, ls_box\n                            except:\n                                pass\n                            gc.collect()\n                            continue\n\n                        # Use band ratios for RF cloud pixel classification\n                        ####\n\n                        # Atmospheric correction using MODIS\n                        # Acquire and align MODIS water vapor (MOD/MYD07) to Landsat\n                        mod07,modfilenm = sut.open_MODIS(ls_scene,scene,modout_path)\n                        print(\"1\")\n\n                        # Create water vapor files aligned and subsampled to Landsat\n                        spacing = [300,-300] # 300m sampling of MODIS data so that upsampling is easy and because 30m takes far too long\n                        WV_xr = sut.get_wv(ls_scene,mod07,spacing,WV,scene,interp=interp)\n                        print(\"2\")\n                        # Create SST by masking and using water vapor to apply atmospheric correction\n                        SST = sut.apply_retrieval(ls_thermal,scene,mask,WV_xr,atmcor,simT_transformer,simTOA_transformer,simWV_transformer)\n\n                        # Record MODIS water vapor image used in atmospheric correction, will find this info save under band_data in\n                        # data variables in COG (click on white paper info button in xarray readout)\n                        SST.attrs['MODIS_WV'] = modfilenm\n\n                        # Save to a cloud-optimized Geotiff\n                        SST.rio.to_raster(raster_path=outFile, driver=\"COG\")\n                        print (f'Mean SST: {np.nanmean(SST)}')\n\n                        # Subset all scenes and check for right dimensions because y order changes sometimes\n                        ls_sub = sut.subset_img(SST,polarx,polary) # subset so easier to work with \n\n                        try:\n                            del mask, ls_thermal, mod07, WV_xr, SST\n                        except:\n                            pass\n    \n                        # except Exception as e:\n                        #     print (sceneid.id, e)\n                        #     lsat = np.nan\n                        #     lstd = np.nan\n    \n                    # Crop data to exact bounding box\n                    ls_sub = sut.crop_xarray_dataarray_with_polygon(ls_sub, polygon) \n    \n                    # Calibrate using MODIS\n                    ls_sub = ls_sub * calib_m + calib_b\n    \n                    # Remove all pixels that are too cold\n                    ls_sub = ls_sub.where(ls_sub\u003e=lthresh,np.nan)\n    \n                    lsat = np.around(np.nanmean(ls_sub),2)\n                    lstd = np.around(np.nanstd(ls_sub),2)\n    \n                    # Convert Argo lat/lon to Landsat's EPSG:3031\n                    argo_px, argo_py = transformer.transform(ilon, ilat)\n    \n                    # 1) Find the nearest center pixel\n                    center_val = ls_sub.sel(x=argo_px, y=argo_py, method=\"nearest\")\n                    \n                    # Extract the x/y coordinate values as plain floats\n                    center_x = center_val.x.item()\n                    center_y = center_val.y.item()\n                    \n                    # 2) Get integer indices from the coordinate indexes\n                    #    This uses ls_sub.get_index('dim_name') -\u003e pandas.Index -\u003e get_indexer(...)\n                    center_x_idx = ls_sub.get_index(\"x\").get_indexer([center_x])[0]\n                    center_y_idx = ls_sub.get_index(\"y\").get_indexer([center_y])[0]\n                    \n                    # 3) Gather offsets for the 3x3 neighborhood\n                    offsets = [\n                        ( 0,  0, \"center\"),\n                        ( 0,  1, \"N\"),\n                        ( 0, -1, \"S\"),\n                        ( 1,  0, \"E\"),\n                        (-1,  0, \"W\"),\n                        ( 1,  1, \"NE\"),\n                        ( 1, -1, \"SE\"),\n                        (-1,  1, \"NW\"),\n                        (-1, -1, \"SW\"),\n                    ]\n                    \n                    neighbors = {}\n                    for dx, dy, name in offsets:\n                        nx = center_x_idx + dx\n                        ny = center_y_idx + dy\n                        # Ensure we're within the array bounds\n                        if (0 \u003c= nx \u003c ls_sub.sizes['x']) and (0 \u003c= ny \u003c ls_sub.sizes['y']):\n                            # xarray dimension order is typically (y, x), so use isel(y=ny, x=nx):\n                            neighbors[name] = ls_sub.isel(y=ny, x=nx).values.item()\n                        else:\n                            neighbors[name] = np.nan\n                    \n                    # 4) Record coincident data from Landsat and Argo float\n                    argo_temp = np.around((ant.sst.iloc[idx] - 273.15),2)  # convert to Celsius\n                    times = pd.to_datetime(calc_dt, format='%Y%m%d%H')  # standardize time\n                    \n                    valid.append([\n                        times,\n                        sceneid.id,\n                        lsat,\n                        lstd,\n                        neighbors['center'],\n                        neighbors['N'],\n                        neighbors['S'],\n                        neighbors['E'],\n                        neighbors['W'],\n                        neighbors['NE'],\n                        neighbors['SE'],\n                        neighbors['NW'],\n                        neighbors['SW'],\n                        ls_sub.max().values.item(),\n                        ls_sub.min().values.item(),\n                        ant.iloc[idx].name,  # Argo ID or whichever label you prefer\n                        argo_temp,\n                        ilat,\n                        ilon\n                    ])\n                    print (f'Argo temp: {argo_temp}, Landsat 8 mean: {lsat}+/-{lstd}')\n    \n                    try:\n                        del ls_scene, scene, ls_thermal, ls_box, mod07, WV_xr, SST, ls_sub, neighbors\n                    except:\n                        pass\n    \n                    gc.collect()\n\n    # Put data into DataFrame and save    \n    lsat_mod_df = pd.DataFrame(valid,columns=headers)\n    out_df = lsatpath / f'Landsat_validation_{start_yrmo}_{end_yrmo}_{dist}.csv'\n    #lsat_mod_df.to_csv(out_df)","key":"SHR24rqfaZ"},{"type":"output","id":"VXSqw4Z30MkWsCaBEGb2S","data":[],"key":"Mjj42a4eAT"}],"key":"yEij9U1mEb"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"\n\n\n\ndf = xr.open_dataset('s3://'+iquam_file)\niquam = df.to_dataframe()","key":"ZQQocw5DUz"},{"type":"output","id":"ESNLICkG-KaWyJZxHM-Zh","data":[],"key":"m5uEbzkJWj"}],"key":"yapeAcO4cP"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# test cell for S3 access, delete once working\n\n#import xarray as xr\n#import s3fs\n\njetstream_url = 'https://js2.jetstream-cloud.org:8001/'\n\ns3 = s3fs.S3FileSystem(anon=True, client_kwargs=dict(endpoint_url=jetstream_url))\n\ns3path = 's3://pythia/landsat8/iQuam/202302-STAR-L2i_GHRSST-SST-iQuam-V2.10-v01.0-fv02.0.nc'\n\n# Open all files from folder\ns3file = s3.open(s3path)\n\n# Open with xarray\nds = xr.open_dataset(s3file)\n\nds\n","key":"SHYyKFjO1H"},{"type":"output","id":"Pm5p3FMS5EJI1GDNAEtp0","data":[],"key":"drj2lSQ5K3"}],"key":"XGZkKEggXh"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Landsat-iQUAM validation assessment","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qcVT7pnNt6"}],"identifier":"landsat-iquam-validation-assessment","label":"Landsat-iQUAM validation assessment","html_id":"landsat-iquam-validation-assessment","implicit":true,"key":"w7KxJdI0JE"}],"key":"yaP8iuVfIQ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Read in processed matchups\n\n# 20250107 is threshold=-1.9, 20250114 is thresh=-1.94, 20250205 is thresh=-1.9\nout_df = lsatpath / 'Landsat_validation_202009_202103_1.0.csv'\nvalids = pd.read_csv(out_df)\n\nvalids = valids.set_index('DateTime')\nvalids = valids.sort_index()\nvalids['Argo_id'] = valids['Argo_id'].astype(int)\n\n# Remove the non-numeric column for calculating daily means\nnumeric_valids = valids.select_dtypes(include=[np.number])\nvalidmn = numeric_valids.groupby(numeric_valids['Argo_id']).mean()\nvalids = valids.reset_index()\n\n# Group by the date component of the datetime and calculate the difference\nvalids['temp_dif'] = valids.groupby(valids['Argo_id'])[f'L8_SST'].diff()\nvalidmn['temp_dif'] = valids.groupby(valids['Argo_id'])['temp_dif'].first()\nvalids = valids.set_index('DateTime')\n\nvalidmn['std'] = valids.groupby([valids['Argo_id']])[f'L8_SST'].std()\nvalidmn['xaxis'] = pd.to_datetime(validmn.index).dayofyear\nvalidmn['xaxis'][validmn['xaxis']\u003c(365/2)] = validmn['xaxis'] + 365\n\nvalids['xaxis'] = pd.to_datetime(valids.index).dayofyear\nvalids['xaxis'][valids['xaxis']\u003c(365/2)] = valids['xaxis'] + 365\n\nvalidmn = validmn.dropna(subset=['L8_SST'])\n\nvalids","key":"JAdenPzRbt"},{"type":"output","id":"EWaftd2ZiyLU9G-MMEM5F","data":[],"key":"a9tztHRRkz"}],"key":"qoc7vCrN0E"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":4,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Visualize all validation matchups for manual QC","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jHxLSyYFNK"}],"identifier":"visualize-all-validation-matchups-for-manual-qc","label":"Visualize all validation matchups for manual QC","html_id":"visualize-all-validation-matchups-for-manual-qc","implicit":true,"key":"TvXEktLDT8"}],"key":"UP0oJxCeSv"},{"type":"block","kind":"notebook-code","data":{"scrolled":true},"children":[{"type":"code","lang":"python","executable":true,"value":"# Setup and authenticate \nfrom dask.distributed import Client\nimport logging\nclient = Client(processes=True, n_workers=4, \n                threads_per_worker=1,\n                silence_logs=logging.ERROR)\nclient.run(lambda: os.environ[\"AWS_REQUEST_PAYER\"] == \"requester\" )\nclient","key":"pvZ66vGMZC"},{"type":"output","id":"-hlRU8C5UICz55sDj0WIz","data":[],"key":"kSlKXP0n38"}],"key":"sqM4cWFO1L"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"pwd","key":"C42IRhxq2s"},{"type":"output","id":"3ZnnWs06djgB-GJbhOllv","data":[],"key":"MQOzOgT7ez"}],"key":"v76vxDNEDC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"os.chdir(lsatpath)\nlsatfiles = os.listdir(lsatpath)\nlsatfiles = [i for i in lsatfiles if i[0]=='L']\n\n# Remove all files from the list with repeats and Landsat mean = nan\nremove = [\n'LC08_L1GT_029109_20160922_20200906_02_T2', \n'LC08_L1GT_022110_20181029_20201016_02_T2', \n'LC08_L1GT_005110_20181209_20201016_02_T2',\n'LC08_L1GT_228108_20200123_20201016_02_T2',\n'LC08_L1GT_001108_20200929_20201006_02_T2',\n'LC08_L1GT_002109_20201022_20201105_02_T2',\n'LC08_L1GT_233108_20201109_20210317_02_T2',\n'LC08_L1GT_233109_20201109_20210317_02_T2',\n'LC08_L1GT_001109_20201202_20210312_02_T2',\n'LC08_L1GT_027112_20220128_20220204_02_T2',\n'LC08_L1GT_002109_20210331_20210408_02_T2'\n]\n\nlsatfiles = [i for i in lsatfiles if i[:-15] not in remove]\nif len(lsatfiles)!=12:\n    print('Wrong number of Landsat scenes!!!')","key":"UgfZ5L5Ipj"},{"type":"output","id":"n6OV_h8Bw-DUCTset--7O","data":[],"key":"jump2DBkL1"}],"key":"m3HO0zxCkV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Number of columns/rows for subplots\nn_cols = 3\nn_rows = 4\n\n# Create one figure and a 4x7 grid of subplots\n# The figsize is 10 across; adjust height as needed for clarity\nfig, axes = plt.subplots(\n    nrows=n_rows,\n    ncols=n_cols,\n    figsize=(11, 8.5),   \n    subplot_kw={'projection': ccrs.PlateCarree()}\n)\n\n# Optional: if you want them *really* close, you can fine-tune spacing:\nplt.subplots_adjust(wspace=0.05, hspace=0.03)\n# plt.subplots_adjust(bottom=0.15)\n\n# Counter for subplot index, and a handle to store the last \"imshow\" (for colorbar)\ni = 0\nim_obj = None\n\nfor lsatfile in lsatfiles:\n    lsID = lsatfile\n    print(lsID)\n    \n    mrow = valids[valids['L8_filename'].str.contains(lsatfile[:-15])]\n    \n    for idx, row in mrow.iterrows():\n        # Check if L8_SST is NaN\n        if pd.isnull(row['L8_SST']):\n            # If it is NaN, skip this iteration and do not plot\n            continue\n        \n        # --- Prepare data and coordinates ---\n        ilat = row['A_lat']\n        ilon = row['A_lon']\n        \n        lat_add = km_to_decimal_degrees(dist, ilat, direction='latitude')\n        lon_add = km_to_decimal_degrees(dist, ilat, direction='longitude')\n        xmin, ymin, xmax, ymax = (ilon - lon_add, ilat - lat_add, \n                                  ilon + lon_add, ilat + lat_add)\n        \n        # Load the Landsat file\n        ds = xr.open_dataset(lsatfile, chunks=dict(x=512, y=512), engine='rasterio')\n        ls_scene = ds['band_data'].sel(band=1).rio.write_crs(\"epsg:3031\", inplace=True)\n        \n        # Assign time coordinate\n        times = pd.to_datetime(lsatfile[17:25] + lsatfile[41:47], format='%Y%m%d%H%M%S')\n        ls_scene = ls_scene.assign_coords(time=times, ID=lsatfile[:-8])\n        \n        # Reproject to EPSG:4326\n        ls_scene = ls_scene.rio.reproject(\"EPSG:4326\")\n\n        # Calibrate using MODIS\n        ls_scene = ls_scene * calib_m + calib_b\n\n        # Remove all pixels that are too cold\n        ls_scene = ls_scene.where(ls_scene\u003e=lthresh,np.nan)\n        \n        # Select the subplot axis\n        ax = axes[i // n_cols, i % n_cols]\n        \n        # Plot on that axis, without a colorbar\n        # Store the \"imshow\" result in im_obj so we can build one colorbar later\n        im_obj = ls_scene.plot.imshow(\n            x='x', y='y',\n            vmin=-2.0, vmax=1.5,\n            ax=ax,\n            transform=ccrs.PlateCarree(),\n            origin='upper',\n            add_colorbar=False  # \u003c- No individual colorbar\n        )\n        \n        # Remove titles completely (xarray may add one by default)\n        ax.set_title('')\n        \n        # Set extent\n        ax.set_extent([ilon - 0.4, ilon + 0.4, ilat - 0.2, ilat + 0.2], crs=ccrs.PlateCarree())\n        \n        # Argo observation\n        ax.scatter([ilon], [ilat], c='r', s=3, transform=ccrs.PlateCarree(), label='Argo location')\n        \n        # Draw bounding box\n        polygon_show = Pgon([(xmin, ymin), (xmin, ymax), \n                             (xmax, ymax), (xmax, ymin)],\n                            closed=True, edgecolor='red', facecolor='none')\n        ax.add_patch(polygon_show)\n        \n        # Text label\n        text_str = (\n            f\"Argo ID: {row['Argo_id']}\\n\"\n            f\"Argo Temp: {np.around(row['Argo_SST'], 2)}\\n\"\n            f\"Landsat SST: {np.around(row['L8_SST'], 2)}\"\n        )\n        ax.text(\n            0.02, 0.95,\n            text_str,\n            transform=ax.transAxes,\n            fontsize=10,\n            va='top',\n            ha='left'\n        )\n\n        gc.collect()\n        \n        # Move to next subplot index\n        i += 1\n        \n\n# --- Add a single colorbar for the entire figure ---\n# We use the last \"imshow\" (im_obj) and attach to all subplot axes\ncbar_ax = fig.add_axes([0.25, 0.05, 0.5, 0.03])\n\ncbar = fig.colorbar(\n    im_obj, \n    ax=axes.ravel().tolist(),  # or just ax=axes if axes is 2D\n    cax=cbar_ax,\n    orientation='horizontal',  # 'vertical' or 'horizontal'\n    fraction=0.025,            # how long the colorbar is relative to axes\n    pad=0.05                   # space between colorbar and subplots\n)\ncbar.set_label(\"Temperature [°C]\", fontsize=12)\n\n# plt.tight_layout()\nplt.show() ","key":"dN6iepZMi4"},{"type":"output","id":"e-uNBAAYHyhjDRv71MgNY","data":[],"key":"ClWcz64zzY"}],"key":"CpHMSxaAWh"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Use matchups to compare modeled and observed data","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"E2SiMI6zRm"}],"identifier":"use-matchups-to-compare-modeled-and-observed-data","label":"Use matchups to compare modeled and observed data","html_id":"use-matchups-to-compare-modeled-and-observed-data","implicit":true,"key":"mVjQNHbZGW"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Here, we are going to use a linear regression","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"O2D8NdtWFG"}],"key":"TfdjW5oywg"}],"key":"oKQk3BdssL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Remove low quality validation data from the valids data\nrm_ids = [1460597, 1614080, 2143782, 2016236, 1790883]\nrm = validmn[validmn.index.isin(rm_ids)]\nvalidmn = validmn.drop(index=rm_ids, errors='ignore')\nvalids = valids[~valids['Argo_id'].isin(rm_ids)]","key":"z9VP80w7nI"},{"type":"output","id":"x_XPLYVVokcddUiKObuk5","data":[],"key":"GAOMe6VX9U"}],"key":"V0Ydb04tht"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Orthoganal Regression \ndata = validmn\n\n# Original data\nx_original = np.array(data['Argo_SST'])\ny_original = np.array(data['L8_SST'])\n\n# Define a linear function for the model\ndef linear_model(p, x):\n    return p[0] * x + p[1]\n\n# Create a Model\nlinear = Model(linear_model)\n\n# Create a RealData object using your DataFrame\ndata = RealData(x_original, y_original)\n\n# Set up ODR with the model and data\nodr = ODR(data, linear, beta0=[1., 0.])\n\n# Run the regression\nout = odr.run()\n\n# Use the output\nbeta = out.beta\nbeta_err = out.sd_beta\n\n# Print the summary\nout.pprint()\n\n# Predicting values using the ODR model\ny_pred = linear_model(beta, x_original)\n\n# Get R2\n# Calculate Total Sum of Squares (SST)\ny_mean = np.mean(y_original)\nSST = np.sum((y_original - y_mean)**2)\n\n# Calculate Residual Sum of Squares (SSR)\nSSR = np.sum((y_original - y_pred)**2)\n\n# Compute RMSE\nrmse = np.sqrt(((y_original - y_pred) ** 2).mean())\n\n# Calculate R^2\nR2 = 1 - (SSR / SST)\nprint(\"R^2:\", np.around(R2,2))\nprint(f\"RMSE: {np.around(rmse,2)}\")","key":"l9zNT9zmKd"},{"type":"output","id":"8p_SOtCbMX12y0DtSq2NY","data":[],"key":"GRAEYPmaX7"}],"key":"UA5Wt4P1IF"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"beta_mdn = [beta[0]-beta_err[0]*1.96,beta[1]-beta_err[1]*1.96]\nbeta_mup = [beta[0]+beta_err[0]*1.96,beta[1]-beta_err[1]*1.96]\nbeta_bdn = [beta[0]-beta_err[0]*1.96,beta[1]+beta_err[1]*1.96]\nbeta_bup = [beta[0]+beta_err[0]*1.96,beta[1]+beta_err[1]*1.96]\nprint(f'At 95% confidence interval: {np.around(beta[0],2)}+/-{np.around(beta_err[0]*1.96,2)}, {np.around(beta[1],2)}+/-{np.around(beta_err[1]*1.96,2)}, n={y_pred.shape[0]}')\nxfill = np.array([-4.3,0.9])\n\n\n# Plot data points and 1:1 line\nfig, ax = plt.subplots(figsize=(5, 4))\nax.tick_params(labelsize=14)\n\nxi = np.arange(-7.0,5.0,1.0)\n\n# lower_err = abs(data['L8_SST'] - data['L8_SST_min'])  # distance to lower bound\n# upper_err = abs(data['L8_SST_max'] - data['L8_SST'])  # distance to upper bound\n\nax.scatter(x_original,y_original,color='k',linewidth=0,s=35,label='High quality')\nax.errorbar(x_original,y_original,yerr=validmn['std'],color='k',fmt='o',ecolor='k',elinewidth=1,capthick=1,marker='o',ms=3,capsize=5,label='_no legend_')\n# ax.errorbar(data['Argo_SST'],data['L8_SST'],yerr=[lower_err,upper_err],color='k',fmt='o',ecolor='k',elinewidth=1,capthick=1,marker='o',ms=3,capsize=5,label='_no legend_')\n# ax.scatter(data['Argo_SST'],data['center'],color='r',linewidth=0,s=25,label='_no label_')\nax.scatter(rm['Argo_SST'],rm['L8_SST'],color='0.7', s=35, label='Removed',zorder=2)\nax.plot(xi,xi,color='k',linewidth=2, label='1:1')\nax.plot(x_original, y_pred, color='k', ls=':', label='Validation ODR')\nax.fill_between(xfill, linear_model(beta_bdn, xfill), linear_model(beta_mup, xfill),alpha=0.1, facecolor='0.3')\n# a1.plot(xi,xi*lreg.coef_[0]+lreg.intercept_[0],color='r',linewidth=2,label='RANSAC regression')\n# a1.scatter(xC,yLC,color='r',linewidth=0,s=35,label='_no label_')\n# a1.plot(xi,xi*resultC.params.L8_SST+resultC.params.Intercept,color='k',linewidth=2,label='OLS regression')\n# a1.text(-2.1,-2.85,f'y={np.around(resultC.params.L8_SST,2)}x+{np.around(resultC.params.Intercept,2)}   p={p_val}',fontsize=12)\nax.text(-1.1,-1.5,f'y={np.around(beta[0],2)}x+{np.around(beta[1],2)}   $r^2$={np.around(R2,2)}',fontsize=14)\nax.spines['top'].set_visible(False)\nax.spines['right'].set_visible(False)\nax.set_ylim([-1.95,1.5])\nax.set_xlim([-1.95,1.5])\nax.set_xlabel('Argo Temperature [°C]',fontsize=16)\nax.set_ylabel('Landsat SST [°C]',fontsize=16)\nax.legend(markerscale=1,fontsize=12,loc='upper left')\n\nplt.tight_layout()\n# plt.savefig('/Users/tsnow03/GoogleDrive/User/Docs/PhD_Project/Manuscripts/AmundsenCC_Manuscript/Figures/LMCalibration.jpg', format='jpg', dpi=1000)\nplt.show()","visibility":"show","key":"ArqkRQFAkn"},{"type":"output","id":"s9y05XR4IvbqMCHAtqETi","data":[],"visibility":"show","key":"x0PvgOB5xQ"}],"visibility":"show","key":"txE2Caal1V"}],"key":"OSPPBN0lTG"},"references":{"cite":{"order":["https://doi.org/10.17882/42182","https://doi.org/10.25921/q97e-d719","https://doi.org/10.5281/zenodo.7589540"],"data":{"https://doi.org/10.17882/42182":{"label":"https://doi.org/10.17882/42182","enumerator":"1","doi":"10.17882/42182","html":"Argo. (2025). \u003ci\u003eArgo float data and metadata from Global Data Assembly Centre (Argo GDAC)\u003c/i\u003e. SEANOE. \u003ca target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.17882/42182\"\u003e10.17882/42182\u003c/a\u003e","url":"https://doi.org/10.17882/42182"},"https://doi.org/10.25921/q97e-d719":{"label":"https://doi.org/10.25921/q97e-d719","enumerator":"2","doi":"10.25921/Q97E-D719","html":"International Argo Program. (2003). \u003ci\u003eTemperature, salinity, pressure, and biogeochemical profile data from globally distributed Argo profiling floats, by month since April 2003 for the Global Argo Data Repository, containing data from 1995-09-07 to present\u003c/i\u003e. NOAA National Centers for Environmental Information. \u003ca target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.25921/Q97E-D719\"\u003e10.25921/Q97E-D719\u003c/a\u003e","url":"https://doi.org/10.25921/Q97E-D719"},"https://doi.org/10.5281/zenodo.7589540":{"label":"https://doi.org/10.5281/zenodo.7589540","enumerator":"3","doi":"10.5281/ZENODO.7589540","html":"GHRSST Project Office, Beggs, H., Karagali, I., \u0026 Castro, S. (2023). \u003ci\u003eSea surface temperature: An introduction to users on the set of GHRSST formatted products\u003c/i\u003e. \u003ca target=\"_blank\" rel=\"noreferrer\" href=\"https://doi.org/10.5281/ZENODO.7589540\"\u003e10.5281/ZENODO.7589540\u003c/a\u003e","url":"https://doi.org/10.5281/ZENODO.7589540"}}}},"footer":{"navigation":{"prev":{"title":"Calibration","url":"/notebooks/calibration","group":"Preamble"},"next":{"title":"Validation","url":"/notebooks/validation-p2","group":"Preamble"}}},"domain":"http://localhost:3000"},"project":{"open_access":true,"license":{"content":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true}},"title":"Raw Pixels to Products","authors":[{"nameParsed":{"literal":"Tasha Snow","given":"Tasha","family":"Snow"},"name":"Tasha Snow","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Kathryn Moore","given":"Kathryn","family":"Moore"},"name":"Kathryn Moore","id":"contributors-myst-generated-uid-1"},{"nameParsed":{"literal":"Genevieve Clow","given":"Genevieve","family":"Clow"},"name":"Genevieve Clow","id":"contributors-myst-generated-uid-2"},{"nameParsed":{"literal":"Jianwen Du","given":"Jianwen","family":"Du"},"name":"Jianwen Du","id":"contributors-myst-generated-uid-3"},{"nameParsed":{"literal":"Arman Oliazneeh","given":"Arman","family":"Oliazneeh"},"name":"Arman Oliazneeh","id":"contributors-myst-generated-uid-4"}],"contributors":[{"id":"brian-rose","nameParsed":{"literal":"Brian E. J. Rose","given":"Brian E. J.","family":"Rose"},"name":"Brian E. J. Rose","orcid":"0000-0002-9961-3821","email":"brose@albany.edu","affiliations":["UAlbany"],"url":"https://brian-rose.github.io","github":"brian-rose","bluesky":"@brianejrose.bsky.social","linkedin":"https://www.linkedin.com/in/brian-rose-37bb55106/"},{"id":"clyne","nameParsed":{"literal":"John Clyne","given":"John","family":"Clyne"},"name":"John Clyne","orcid":"0000-0003-2788-9017","affiliations":["CISL"],"github":"clyne"},{"id":"jukent","nameParsed":{"literal":"Julia Kent","given":"Julia","family":"Kent"},"name":"Julia Kent","orcid":"0000-0002-5611-8986","affiliations":["CISL"],"github":"jukent"},{"id":"ktyle","nameParsed":{"literal":"Kevin Tyle","given":"Kevin","family":"Tyle"},"name":"Kevin Tyle","orcid":"0000-0001-5249-9665","affiliations":["UAlbany"],"github":"ktyle"},{"id":"andersy005","nameParsed":{"literal":"Anderson Banihirwe","given":"Anderson","family":"Banihirwe"},"name":"Anderson Banihirwe","orcid":"0000-0001-6583-571X","affiliations":["CarbonPlan"],"github":"andersy005"},{"id":"dcamron","nameParsed":{"literal":"Drew Camron","given":"Drew","family":"Camron"},"name":"Drew Camron","orcid":"0000-0001-7246-6502","affiliations":["Unidata"],"github":"dcamron"},{"id":"dopplershift","nameParsed":{"literal":"Ryan May","given":"Ryan","family":"May"},"name":"Ryan May","orcid":"0000-0003-2907-038X","affiliations":["Unidata"],"github":"dopplershift"},{"id":"mgrover1","nameParsed":{"literal":"Maxwell Grover","given":"Maxwell","family":"Grover"},"name":"Maxwell Grover","orcid":"0000-0002-0370-8974","affiliations":["Argonne"],"github":"mgrover1"},{"id":"r-ford","nameParsed":{"literal":"Robert R. Ford","given":"Robert R.","family":"Ford"},"name":"Robert R. Ford","orcid":"0000-0001-5483-4965","affiliations":["UAlbany"],"github":"r-ford"},{"id":"kmpaul","nameParsed":{"literal":"Kevin Paul","given":"Kevin","family":"Paul"},"name":"Kevin Paul","orcid":"0000-0001-8155-8038","affiliations":["NVIDIA"],"github":"kmpaul"},{"id":"jnmorley","nameParsed":{"literal":"James Morley","given":"James","family":"Morley"},"name":"James Morley","orcid":"0009-0005-5193-7981","github":"jnmorley"},{"id":"erogluorhan","nameParsed":{"literal":"Orhan Eroglu","given":"Orhan","family":"Eroglu"},"name":"Orhan Eroglu","orcid":"0000-0003-3099-8775","affiliations":["CISL"],"github":"erogluorhan"},{"id":"lkailynncar","nameParsed":{"literal":"Lily Kailyn","given":"Lily","family":"Kailyn"},"name":"Lily Kailyn","orcid":"0009-0002-0125-5091","affiliations":["CISL"],"github":"lkailynncar"},{"id":"anissa111","nameParsed":{"literal":"Anissa Zacharias","given":"Anissa","family":"Zacharias"},"name":"Anissa Zacharias","orcid":"0000-0002-2666-8493","affiliations":["CISL"],"github":"anissa111"},{"id":"kafitzgerald","nameParsed":{"literal":"Katelyn FitzGerald","given":"Katelyn","family":"FitzGerald"},"name":"Katelyn FitzGerald","orcid":"0000-0003-4184-1917","affiliations":["CISL"],"github":"kafitzgerald"}],"github":"https://github.com/projectpythia/landsatproduct-cookbook","affiliations":[{"id":"UAlbany","name":"University at Albany (SUNY)","department":"Atmospheric and Environmental Sciences","url":"https://www.albany.edu/daes"},{"id":"CISL","name":"NSF National Center for Atmospheric Research","department":"Computational and Information Systems Lab","url":"https://www.cisl.ucar.edu"},{"id":"Unidata","name":"NSF Unidata","url":"https://www.unidata.ucar.edu"},{"id":"Argonne","name":"Argonne National Laboratory","department":"Environmental Science Division","url":"https://www.anl.gov/evs"},{"id":"CarbonPlan","name":"CarbonPlan","url":"https://carbonplan.org"},{"id":"NVIDIA","name":"NVIDIA Corporation","url":"https://www.nvidia.com/"}],"copyright":"2025","references":{"foundations":{"url":"https://foundations.projectpythia.org"},"xarray":{"url":"https://docs.xarray.dev/en/stable"},"matplotlib":{"url":"https://matplotlib.org/stable"}},"thebe":{"binder":{"url":"https://mybinder.org/","provider":"github","repo":"projectpythia/cookbook-template","ref":"HEAD"}},"toc":[{"file":"README.md"},{"children":[{"file":"notebooks/how-to-cite.md"}],"title":"Preamble"},{"file":"notebooks/preprocessing.ipynb"},{"file":"notebooks/calibration.ipynb"},{"file":"notebooks/validation_step1.ipynb"},{"file":"notebooks/validation_p2.ipynb"}],"thumbnail":"/landsatproduct-cookbook/build/cookbook_schem_genev-ef1ec07afdd1ca226f8ed87944bfef8a.png","exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"Preamble"},{"slug":"notebooks.how-to-cite","title":"How to Cite This Cookbook","description":"","date":"","thumbnail":"/landsatproduct-cookbook/build/72a08caa5cbe5f9cce5999dbd1a81dfd.svg","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"notebooks.preprocessing","title":"Preprocessing data","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"notebooks.calibration","title":"Calibration","description":"","date":"2025-08-08","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"notebooks.validation-step1","title":"Validating your data product","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1},{"slug":"notebooks.validation-p2","title":"Validation","description":"","date":"","thumbnail":"/landsatproduct-cookbook/build/7f5ce2075ca8bde52118602eb0344051.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":1}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/landsatproduct-cookbook/build/manifest-B2B2E6A5.js";
import * as route0 from "/landsatproduct-cookbook/build/root-IB5726YR.js";
import * as route1 from "/landsatproduct-cookbook/build/routes/$-LXLHKVOR.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/landsatproduct-cookbook/build/entry.client-UNPC4GT3.js");</script></body></html>